{
  "paragraphs": [
    {
      "text": "%spark.pyspark\nimport sys\nfrom operator import add\nfrom pyspark import SparkContext\nfrom csv import reader",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:00-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1638926085674_1895252581",
      "id": "paragraph_1638926085674_1895252581",
      "dateCreated": "2021-12-07T20:14:45-0500",
      "dateStarted": "2021-12-11T23:11:00-0500",
      "dateFinished": "2021-12-11T23:11:00-0500",
      "status": "FINISHED",
      "focus": true,
      "$$hashKey": "object:251"
    },
    {
      "text": "%spark.pyspark\ndataset1 = sc.textFile(\"hdfs:/user/CS-GY-6513/project_data/data-cityofnewyork-us.ye3c-m4ga.csv\").mapPartitions(lambda x: reader(x))\ndataset2 = sc.textFile(\"hdfs:/user/CS-GY-6513/project_data/data-cityofnewyork-us.423i-ukqr.csv\").mapPartitions(lambda x: reader(x))\ndataset3 = sc.textFile(\"hdfs:/user/CS-GY-6513/project_data/data-cityofnewyork-us.gzfs-3h4m.csv\").mapPartitions(lambda x: reader(x))\ndataset4 = sc.textFile(\"hdfs:/user/CS-GY-6513/project_data/data-cityofnewyork-us.mdcw-n682.csv\").mapPartitions(lambda x: reader(x))\ndataset5 = sc.textFile(\"hdfs:/user/CS-GY-6513/project_data/data-cityofnewyork-us.k397-673e.csv\").mapPartitions(lambda x: reader(x))\ndataset6 = sc.textFile(\"hdfs:/user/CS-GY-6513/project_data/data-cityofnewyork-us.mwzb-yiwb.csv\").mapPartitions(lambda x: reader(x))\ndataset7 = sc.textFile(\"hdfs:/user/CS-GY-6513/project_data/data-cityofnewyork-us.a9md-ynri.csv\").mapPartitions(lambda x: reader(x))\ndataset8 = sc.textFile(\"hdfs:/user/CS-GY-6513/project_data/data-cityofnewyork-us.vx8i-nprf.csv\").mapPartitions(lambda x: reader(x))\ndataset9 = sc.textFile(\"hdfs:/user/CS-GY-6513/project_data/data-cityofnewyork-us.xrwg-eczf.csv\").mapPartitions(lambda x: reader(x))\ndataset10 = sc.textFile(\"hdfs:/user/CS-GY-6513/project_data/data-cityofnewyork-us.qbjq-atxv.csv\").mapPartitions(lambda x: reader(x))",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:00-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1638926087313_204475474",
      "id": "paragraph_1638926087313_204475474",
      "dateCreated": "2021-12-07T20:14:47-0500",
      "dateStarted": "2021-12-11T23:11:00-0500",
      "dateFinished": "2021-12-11T23:11:00-0500",
      "status": "FINISHED",
      "$$hashKey": "object:252"
    },
    {
      "text": "%spark.pyspark\nprint(dataset1.first())\nprint(dataset2.first())\nprint(dataset3.first())\nprint(dataset4.first())\nprint(dataset5.first())\nprint(dataset6.first())\nprint(dataset7.first())\nprint(dataset8.first())\nprint(dataset9.first())\nprint(dataset10.first())",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:00-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "['CALENDAR YEAR', 'AGENCY CODE', 'EMPLOYEE NAME   ', 'AGENCY NAME', 'TITLE CODE', 'PAY CLASS', 'SALARY RATE']\n['Record ID', 'Data Year', 'Agency Name', 'EEO-4 Job Category', 'Pay Band', 'Lower Pay Band Bound', 'Upper Pay Band Bound', 'Employee Status', 'Race', 'Ethnicity', 'Gender', 'Number of Employees']\n['PUBLICATION DATE', 'AGENCY CODE', 'AGENCY NAME', 'BUDGET FUNCTION', 'BUDGET FUNCTION DESCRIPTION', 'ROW ID', 'SPENDING TYPE', 'SPENDING TYPE DESCRIPTION', 'FIRST ACTUAL FISCAL YEAR  ', 'YEAR 1 ACTUAL', 'YEAR 2 ACTUAL', 'YEAR 3 ACTUAL', 'FIRST PLAN FISCAL YEAR  ', 'PLAN AMOUNT YEAR 1', 'PLAN AMOUNT YEAR 2']\n['Agency Name', 'Agency Acronym', 'Agency Website', 'First Name', 'Last Name', 'Middle Initial', 'Name Suffix', 'Office Title', 'Division Name', 'Parent Division', 'Grand Parent Division', 'Great Grand Parent Division', 'Address', 'City', 'State', 'Zip Code', 'Phone 1', 'Phone 2', 'Fax 1', 'Fax 2', 'Agency Primary Phone', 'Division Primary Phone', 'Section']\n['Fiscal Year', 'Payroll Number', 'Agency Name', 'Last Name', 'First Name', 'Mid Init', 'Agency Start Date', 'Work Location Borough', 'Title Description', 'Leave Status as of June 30', 'Base Salary', 'Pay Basis', 'Regular Hours', 'Regular Gross Paid', 'OT Hours', 'Total OT Paid', 'Total Other Pay']\n['Publication Date', 'Fiscal Year', 'Agency Number', 'Agency Name', 'Unit Appropriation Number', 'Unit Appropriation Name', 'Budget Code Number', 'Budget Code Name', 'Object Class Number', 'Object Class Name', 'Object Code', 'Object Code Name', 'Intra-City Purchase Code', 'Responsibility Center Code', 'Responsibility Center Name', 'Personal Service/Other Than Personal Service Indicator', 'Financial Plan Savings Flag', 'Adopted Budget Amount', 'Current Modified Budget Amount', 'Financial Plan Amount', 'Adopted Budget Position', 'Current Modified Budget Position', 'Financial Plan Position', 'Adopted Budget - Number of Contracts', 'Current Modified Budget - Number of Contracts', 'Financial Plan - Number of Contracts']\n['Exam No', 'List No', 'First Name', 'MI', 'Last Name', 'List Agency Code', 'List Agency Desc', 'List Title Desc', 'Cert Seq No', 'Request Date', 'Salary', 'Cert Issue No', 'Cert Date', 'Reissue Date', 'Cert Expiration Date', 'No Certified', 'No Requested', 'Provisional Replacement', 'No Vacancies', 'List Title Code', 'Sel Cert Description']\n['Exam No', 'List No', 'First Name', 'MI', 'Last Name', 'Adj. FA', 'List Title Code', 'List Title Desc', 'Group No', 'List Agency Code', 'List Agency Desc', 'List Div Code', 'Published Date', 'Established Date', 'Anniversary Date', 'Extension Date', 'Veteran Credit', 'Parent Lgy Credit', 'Sibling Lgy Credit', 'Residency Credit']\n['Year', 'Agency', 'Agency Name', 'Facility Center Name', 'Service Category', 'Borough', 'Address', 'Postcode', 'Facility - Cleaning & Maintenance Score', 'Facility - Operations Score', 'Facility - Overall Score', 'Latitude', 'Longitude', 'Community Board', 'Council District', 'Census Tract', 'BIN', 'BBL', 'NTA']\n['Agency Code', 'Agency', 'Agency Name', 'Unit of Appropriation', 'Unit of Appropriation Name', 'PS_OTPS_Ind', 'Expenditures FY17($000,000)', 'February 2018 Financial Plan FY18 ($000,000)', 'Applicable PMMR Goals', 'Notes']\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=92",
              "$$hashKey": "object:2370"
            },
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=93",
              "$$hashKey": "object:2371"
            },
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=94",
              "$$hashKey": "object:2372"
            },
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=95",
              "$$hashKey": "object:2373"
            },
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=96",
              "$$hashKey": "object:2374"
            },
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=97",
              "$$hashKey": "object:2375"
            },
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=98",
              "$$hashKey": "object:2376"
            },
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=99",
              "$$hashKey": "object:2377"
            },
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=100",
              "$$hashKey": "object:2378"
            },
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=101",
              "$$hashKey": "object:2379"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1638926244906_1963860432",
      "id": "paragraph_1638926244906_1963860432",
      "dateCreated": "2021-12-07T20:17:24-0500",
      "dateStarted": "2021-12-11T23:11:00-0500",
      "dateFinished": "2021-12-11T23:11:01-0500",
      "status": "FINISHED",
      "$$hashKey": "object:253"
    },
    {
      "text": "%spark.pyspark\ndef toUpperCase(x):\n    if x != '':\n        return x.upper();\n    else:\n        return \" \"",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:01-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1638936089033_408043599",
      "id": "paragraph_1638936089033_408043599",
      "dateCreated": "2021-12-07T23:01:29-0500",
      "dateStarted": "2021-12-11T23:11:01-0500",
      "dateFinished": "2021-12-11T23:11:01-0500",
      "status": "FINISHED",
      "$$hashKey": "object:254"
    },
    {
      "text": "%spark.pyspark\ndef elimateBlank(x):\n    x = x.strip()\n    return x;",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:01-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1638936113320_1317236413",
      "id": "paragraph_1638936113320_1317236413",
      "dateCreated": "2021-12-07T23:01:53-0500",
      "dateStarted": "2021-12-11T23:11:01-0500",
      "dateFinished": "2021-12-11T23:11:01-0500",
      "status": "FINISHED",
      "$$hashKey": "object:255"
    },
    {
      "text": "%spark.pyspark\ndef identical(x):\n    if len(x.split(' ')) == 3 and x.split(' ')[0] == 'COMMUNITY' and x.split(' ')[1] == 'BOARD':\n        number = x.split('.')[1].split('-')[0]\n        reg = x.split('-')[1]\n        print(len(reg))\n        reg = reg[0:4]\n        print(reg)\n        if reg == 'QUEE':\n            c_reg = 'QUEENS'\n            x = c_reg + ' ' + 'COMMUNITY BOARD #' + number\n        if reg == 'BROO':\n            c_reg = 'BROOKLYN'\n            x = c_reg + ' ' + 'COMMUNITY BOARD #' + number\n        if reg == 'BRON':\n            c_reg = 'BRONX'\n            x = c_reg + ' ' + 'COMMUNITY BOARD #' + number\n        if reg == 'MANH':\n            c_reg = 'MANHATTAN'\n            x = c_reg + ' ' + 'COMMUNITY BOARD #' + number\n        if reg == 'RICH':\n            c_reg = 'RICHMOND'\n            x = c_reg + ' ' + 'COMMUNITY BOARD #' + number\n    return x\n\ntest = identical(\"COMMUNITY BOARD NO.8-MANHA\")\nprint(test)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:01-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "5\nMANH\nMANHATTAN COMMUNITY BOARD #8\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639104972800_1605905853",
      "id": "paragraph_1639104972800_1605905853",
      "dateCreated": "2021-12-09T21:56:12-0500",
      "dateStarted": "2021-12-11T23:11:01-0500",
      "dateFinished": "2021-12-11T23:11:01-0500",
      "status": "FINISHED",
      "$$hashKey": "object:256"
    },
    {
      "text": "%spark.pyspark\ndef completeTheDatas(x):\n    if x == 'DEPARTMENT OF CITYWIDE ADM':\n        x = 'DEPARTMENT OF CITYWIDE ADMINISTRATIVE SERVICES'\n    if x == 'HRA/DEPARTMENT OF SOCIAL S':\n        x = 'HRA/DEPARTMENT OF SOCIAL SERVICES'\n    if x == 'CUNY QUEENSBOROUGH COMMUNI':\n        x = 'CUNY QUEENSBOROUGH COMMUNITY'\n    if x == 'DEPARTMENT OF ENVIRONMENTA':\n        x = 'DEPARTMENT OF ENVIRONMENTAL'\n    if x == 'CUNY KINGSBOROUGH COMMMUNI':\n        x = 'CUNY KINGSBOROUGH COMMUNITY'\n    if x == 'DEPARTMENT OF TRANSPORTATI':\n        x = 'DEPARTMENT OF TRANSPORTATION'\n    if x == 'OFFICE OF MANAGEMENT AND B':\n        x = 'OFFICE OF MANAGEMENT AND BUDGET'\n    if x == 'DEPARTMENT OF HOMELESS SER':\n        x = 'DEPARTMENT OF HOMELESS SERVICES'\n    if x == 'CUNY BRONX COMMUNITY COLLE':\n        x = 'CUNY BRONX COMMUNITY COLLEGE'\n    if x == 'DISTRICT ATTORNEY-QUEENS C':\n        x = 'DISTRICT ATTORNEY-QUEENS COUNTY'\n    if x == 'DEPARTMENT OF PARKS & RECR':\n        x = 'DEPARTMENT OF PARKS & RECREATION'\n    if x == 'DISTRICT ATTORNEY-RICHMOND':\n        x = 'DISTRICT ATTORNEY-RICHMOND COUNTY'\n    if x == 'DISTRICT ATTORNEY-KINGS CO':\n        x = \"DISTRICT ATTORNEY-KINGS COUNTY\"\n    if x == 'HOUSING PRESERVATION & DEV':\n        x = 'HOUSING PRESERVATION & DEVELOPMENT'\n    if x == 'TRIBOROUGH BRIDGE AND TUNN':\n        x = 'TRIBOROUGH BRIDGE AND TUNNEL'\n    if x == 'FINANCIAL INFORMATION SERV':\n        x = 'FINANCIAL INFORMATION SERVIVES'\n    if x == 'ADMINISTRATION FOR CHILDRE':\n        x = \"ADMINISTRATION FOR CHILDREN'S SERVIVES\"\n    if x == 'DEPARTMENT OF YOUTH AND CO':\n        x = 'DEPARTMENT OF YOUTH AND COMUNITY SERVICES'\n    if x == 'TAXI AND LIMOUSINE COMMISS':\n        x = 'TAXI AND LIMOUSINE COMMISSION'\n    if x == 'DEPARTMENT OF CONSUMER AFF':\n        x = 'DEPARTMENT OF CONSUMER AFFAIRS'\n    if x == 'DEPARTMENT OF CITY PLANNIN':\n        x = 'DEPARTMENT OF CITY PLANNING'\n    if x == 'CUNY HUNTER COLLEGE HIGH S':\n        x = 'CUNY HUNTER COLLEGE HIGH SCHOOL'\n    if x == 'DISTRICT ATTORNEY-BRONX CO':\n        x = 'DISTRICT ATTORNEY-BRONX COUNTY'\n    if x == 'DISTRICT ATTORNEY - SPECIA':\n        x = 'DISTRICT ATTORNEY - SPECIAL AGENT'\n    if x == 'CIVILIAN COMPLAINT REVIEW':\n        x = 'CIVILIAN COMPLAINT REVIEW BOARD'\n    if x == \"TEACHERS' RETIREMENT SYSTE\":\n        x = \"TEACHERS' RETIREMENT SYSTEM\"\n    if x == 'OFFICE OF EMERGENCY MANAGE':\n        x = \"OFFICE OF EMERGENCY MANAGEMENT\"\n    if x == 'DEPARTMENT OF BUSINESS SER':\n        x = \"DEPARTMENT OF BUSINESS SERVICES\"\n    if x == 'OFFICE OF PAYROLL ADMINIST':\n        x = 'OFFICE OF PAYROLL ADMINISTRATION'\n    if x == 'CUNY COLLEGE OF STATEN ISL':\n        x = 'CUNY COLLEGE OF STATEN ISLAND'\n    if x == 'DEPT. OF RECORDS AND INFOR':\n        x = 'DEPT. OF RECORDS AND INFORMATION SERVICES'\n    if x == 'DEPARTMENT OF CULTURAL AFF':\n        x = 'DEPARTMENT OF CULTURAL AFFAIRS'\n    if x == 'BUSINESS INTEGRITY COMMISS':\n        x = 'BUSINESS INTEGRITY COMMISSION'\n    if x == 'LANDMARKS PRESERVATION COM':\n        x = 'LANDMARKS PRESERVATION COMMISSON'\n    if x == 'PUBLIC ADMINISTRATOR NEW Y':\n        x = 'PUBLIC ADMINISTRATOR NEW YORK CITY'\n    if x == 'COMMUNITY BOARD NO.1 BRONX':\n        x = 'BRONX COMMUNITY BOARD #1'\n    return x",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:01-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1638937783217_1013403424",
      "id": "paragraph_1638937783217_1013403424",
      "dateCreated": "2021-12-07T23:29:43-0500",
      "dateStarted": "2021-12-11T23:11:01-0500",
      "dateFinished": "2021-12-11T23:11:01-0500",
      "status": "FINISHED",
      "$$hashKey": "object:257"
    },
    {
      "text": "%spark.pyspark\ndef clean(x):\n    x = toUpperCase(x)\n    return x",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:01-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639108410554_1606101793",
      "id": "paragraph_1639108410554_1606101793",
      "dateCreated": "2021-12-09T22:53:30-0500",
      "dateStarted": "2021-12-11T23:11:01-0500",
      "dateFinished": "2021-12-11T23:11:01-0500",
      "status": "FINISHED",
      "$$hashKey": "object:258"
    },
    {
      "text": "%spark.pyspark\ndef clean_new(x):\n    x = toUpperCase(x)\n    x = elimateBlank(x)\n    x = identical(x)\n    return x",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:02-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639105699126_1065318933",
      "id": "paragraph_1639105699126_1065318933",
      "dateCreated": "2021-12-09T22:08:19-0500",
      "dateStarted": "2021-12-11T23:11:02-0500",
      "dateFinished": "2021-12-11T23:11:02-0500",
      "status": "FINISHED",
      "$$hashKey": "object:259"
    },
    {
      "text": "%spark.pyspark\n####dataset1 test for Name Agency",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:02-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639108684508_194349766",
      "id": "paragraph_1639108684508_194349766",
      "dateCreated": "2021-12-09T22:58:04-0500",
      "dateStarted": "2021-12-11T23:11:02-0500",
      "dateFinished": "2021-12-11T23:11:02-0500",
      "status": "FINISHED",
      "$$hashKey": "object:260"
    },
    {
      "text": "%spark.pyspark\ndef clean_for_dataset1(x):\n    x = toUpperCase(x)\n    x = elimateBlank(x)\n    x = identical(x)\n    x = completeTheDatas(x)\n    return x",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:02-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1638937115344_184967242",
      "id": "paragraph_1638937115344_184967242",
      "dateCreated": "2021-12-07T23:18:35-0500",
      "dateStarted": "2021-12-11T23:11:02-0500",
      "dateFinished": "2021-12-11T23:11:02-0500",
      "status": "FINISHED",
      "$$hashKey": "object:261"
    },
    {
      "text": "%spark.pyspark\nagency_name1 = dataset1.map(lambda x: (x[3], 1)).countByKey()\nfor key, value in agency_name1.items():\n    print(key, value)\n",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:02-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "AGENCY NAME 1\nDEPARTMENT OF CITYWIDE ADM 92519\nHRA/DEPARTMENT OF SOCIAL S 82952\nPOLICE DEPARTMENT 277204\nCUNY QUEENSBOROUGH COMMUNI 15781\nN.Y.C. TRANSIT AUTHORITY 276525\nDEPARTMENT OF ENVIRONMENTA 37571\nDEPARTMENT OF SANITATION 57197\nN.Y.C. HOUSING AUTHORITY 60159\nDEPARTMENT FOR THE AGING 5483\nCUNY KINGSBOROUGH COMMMUNI 22059\nDEPARTMENT OF HEALTH AND M 42140\nDEPARTMENT OF CORRECTION 60135\nOFFICE OF ADMINISTRATIVE T 4149\nFIRE DEPARTMENT 86885\nCUNY LAGUARDIA COMMUNITY C 25515\nOFFICE OF THE COMPTROLLER 4137\nDEPARTMENT OF EDUCATION 66449\nDEPARTMENT OF FINANCE 10684\nDISTRICT ATTORNEY-NEW YORK 9958\nLAW DEPARTMENT 9326\nDEPARTMENT OF TRANSPORTATI 33846\nOFFICE OF MANAGEMENT AND B 2531\nDEPARTMENT OF HOMELESS SER 14744\nDEPARTMENT OF INFORMATION 7676\nCUNY BRONX COMMUNITY COLLE 14403\nNYC EMPLOYEES' RETIREMENT 2299\nDISTRICT ATTORNEY-QUEENS C 4302\nDEPARTMENT OF PARKS & RECR 72746\nDEPARTMENT OF BUILDINGS 7756\nDISTRICT ATTORNEY-RICHMOND 911\nDISTRICT ATTORNEY-KINGS CO 7151\nCUNY HOSTOS COMMUNITY COLL 10994\nCUNY MANHATTAN COMMUNITY C 27473\nDEPARTMENT OF DESIGN AND C 8614\nHOUSING PRESERVATION & DEV 14378\nTRIBOROUGH BRIDGE AND TUNN 11613\nFINANCIAL INFORMATION SERV 2675\nADMINISTRATION FOR CHILDRE 41682\nDEPARTMENT OF PROBATION 5598\nDEPARTMENT OF YOUTH AND CO 3384\nTAXI AND LIMOUSINE COMMISS 4115\nDEPARTMENT OF CONSUMER AFF 2475\nCITY COUNCIL 4299\nOFFICE OF THE MAYOR 3009\nDEPARTMENT OF CITY PLANNIN 2069\nOFFICE OF LABOR RELATIONS 679\nCUNY HUNTER COLLEGE HIGH S 1976\nDISTRICT ATTORNEY-BRONX CO 6442\nNYC POLICE PENSION FUND 800\nDISTRICT ATTORNEY - SPECIA 1408\nCIVILIAN COMPLAINT REVIEW 1023\nBOARD OF ELECTIONS 4293\nTEACHERS' RETIREMENT SYSTE 2350\nOFFICE OF EMERGENCY MANAGE 1085\nCOMMUNITY BOARD NO.1-MANHA 20\nCITY CLERK 383\nPUBLIC ADVOCATE 314\nCOMMUNITY BOARD NO.8-QUEEN 25\nBOROUGH PRESIDENT-BROOKLYN 426\nDEPARTMENT OF BUSINESS SER 1993\nOFFICE OF PAYROLL ADMINIST 962\nCUNY COLLEGE OF STATEN ISL 2874\nDEPT. OF RECORDS AND INFOR 435\nTAX COMMISSION 283\nDEPARTMENT OF CULTURAL AFF 430\nBUSINESS INTEGRITY COMMISS 526\nDEPARTMENT OF INVESTIGATIO 2085\nLANDMARKS PRESERVATION COM 485\nBOROUGH PRESIDENT-RICHMOND 282\nBOROUGH PRESIDENT-MANHATTA 342\nBOROUGH PRESIDENT-BRONX 297\nINDEPENDENT BUDGET OFFICE 193\nCOMMUNITY BOARD NO.10-MANH 22\nBOROUGH PRESIDENT-QUEENS 306\nCOMMUNITY BOARD NO.2-MANHA 23\nCAMPAIGN FINANCE BOARD 576\nBOARD OF CORRECTIONS 122\nCOMMISSION ON HUMAN RIGHTS 746\nCOMMUNITY BOARD NO.2-BRONX 19\nCOMMUNITY BOARD NO.7-BRONX 17\nOFFICE OF COLLECTIVE BARGA 109\nMUNICIPAL WATER FINANCE AU 79\nPUBLIC ADMINISTRATOR QUEEN 49\nCOMMUNITY BOARD NO.4-MANHA 19\nCOMMUNITY BOARD NO.9-QUEEN 22\nCOMMUNITY BOARD NO.17-BROO 24\nCOMMUNITY BOARD NO.8-BRONX 21\nCOMMUNITY BOARD NO.5-MANHA 19\nCOMMUNITY BOARD NO.10-BROO 23\nPUBLIC ADMINISTRATOR NEW Y 64\nCONFLICTS OF INTEREST BOAR 151\nCOMMUNITY BOARD NO.11-QUEE 19\nCOMMUNITY BOARD NO.2-QUEEN 24\nOFFICE OF THE ACTUARY 198\nCOMMUNITY BOARD NO.7-QUEEN 25\nCOMMUNITY BOARD NO.12-MANH 19\nPUBLIC ADMINISTRATOR RICHM 32\nCOMMUNITY BOARD NO.4-BROOK 17\nCOMMUNITY BOARD NO.6-BROOK 18\nCOMMUNITY BOARD NO.13-QUEE 19\nCOMMUNITY BOARD NO.16-BROO 17\nCOMMUNITY BOARD NO.11-MANH 21\nCOMMUNITY BOARD NO.13-BROO 21\nCOMMUNITY BOARD NO.6-QUEEN 26\nCOMMUNITY BOARD NO.3-BROOK 17\nCOMMUNITY BOARD NO.14-BROO 18\nCOMMUNITY BOARD NO.5-BROOK 23\nCOMMUNITY BOARD NO.1-RICHM 18\nCOMMUNITY BOARD NO.10-BRON 32\nCOMMUNITY BOARD NO.1-BROOK 18\nCOMMUNITY BOARD NO.4-QUEEN 18\nCUNY MEDGAR EVERS COLLEGE 6\nCIVIL SERVICE COMMISSION 56\nCOMMUNITY BOARD NO.3-MANHA 25\nCOMMUNITY BOARD NO.2-BROOK 19\nCOMMUNITY BOARD NO.10-QUEE 24\nCOMMUNITY BOARD NO.7-BROOK 18\nCOMMUNITY BOARD NO.5-BRONX 15\nPUBLIC ADMINISTRATOR KINGS 78\nCOMMUNITY BOARD NO.2-RICHM 23\nCOMMUNITY BOARD NO.3-BRONX 12\nCOMMUNITY BOARD NO.14-QUEE 18\nCOMMUNITY BOARD NO.11-BROO 19\nPUBLIC ADMINISTRATOR BRONX 49\nCOMMUNITY BOARD NO.11-BRON 29\nCOMMUNITY BOARD NO.6-BRONX 18\nCOMMUNITY BOARD NO.8-MANHA 27\nCOMMUNITY BOARD NO.8-BROOK 18\nCOMMUNITY BOARD NO.5-QUEEN 24\nCOMMUNITY BOARD NO.4 BRONX 18\nCOMMUNITY BOARD NO.9-BRONX 26\nCOMMUNITY BOARD NO.12-BRON 15\nCOMMUNITY BOARD NO.1-QUEEN 26\nEQUAL EMPLOYMENT PRACTICES 66\nCOMMUNITY BOARD NO.12-BROO 20\nCOMMUNITY BOARD NO.3-QUEEN 26\nCOMMUNITY BOARD NO.1 BRONX 7\nCOMMUNITY BOARD NO.7-MANHA 18\nCOMMUNITY BOARD N0.9-MANHA 18\nCOMMUNITY BOARD NO.9-BROOK 13\nCOMMUNITY BOARD NO.6-MANHA 17\nCOMMUNITY BOARD NO.15-BROO 18\nCOMMUNITY BOARD NO.18-BROO 18\nCOMMUNITY BOARD NO.12-QUEE 20\nCOMMUNITY BOARD NO.3-RICHM 19\nCUNY CENTRAL OFFICE 228\nDEPARTMENT OF SANITATION   12627\nPOLICE DEPARTMENT          57759\nN.Y.C. TRANSIT AUTHORITY   55587\nCITY COUNCIL               857\nDEPARTMENT OF EDUCATION    13970\nN.Y.C. HOUSING AUTHORITY   12336\nDEPARTMENT OF CORRECTION   13424\nDEPARTMENT FOR THE AGING   1246\nDEPARTMENT OF FINANCE      2170\nFIRE DEPARTMENT            18081\nDEPARTMENT OF PROBATION    1138\nOFFICE OF LABOR RELATIONS  142\nNYC EMPLOYEES' RETIREMENT  466\nLAW DEPARTMENT             1990\nDEPARTMENT OF INFORMATION  1688\nOFFICE OF THE MAYOR        548\nNYC POLICE PENSION FUND    176\nOFFICE OF THE COMPTROLLER  889\nBOARD OF ELECTIONS         951\nDEPARTMENT OF BUILDINGS    1798\nCAMPAIGN FINANCE BOARD     134\nMAYOR'S OFFICE OF CONTRACT 613\nBOARD OF CORRECTIONS       32\nINDEPENDENT BUDGET OFFICE  38\nCITY CLERK                 78\nCIVILIAN COMPLAINT REVIEW  203\nDEPARTMENT OF VETERANS' SE 155\nBOROUGH PRESIDENT-QUEENS   61\nPUBLIC ADVOCATE            72\nOFFICE OF THE ACTUARY      41\nTAX COMMISSION             59\nBOROUGH PRESIDENT-BRONX    57\nNEW YORK CITY FIRE PENSION 98\nCIVIL SERVICE COMMISSION   13\nCUNY CENTRAL OFFICE        33\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=102",
              "$$hashKey": "object:2781"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1638926271669_781209094",
      "id": "paragraph_1638926271669_781209094",
      "dateCreated": "2021-12-07T20:17:51-0500",
      "dateStarted": "2021-12-11T23:11:02-0500",
      "dateFinished": "2021-12-11T23:11:04-0500",
      "status": "FINISHED",
      "$$hashKey": "object:262"
    },
    {
      "text": "%spark.pyspark\nagency_name_old1 = dataset1.map(lambda x: (clean(x[3]),1)).countByKey()\nfor key, value in agency_name1.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:04-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "AGENCY NAME 1\nDEPARTMENT OF CITYWIDE ADM 92519\nHRA/DEPARTMENT OF SOCIAL S 82952\nPOLICE DEPARTMENT 277204\nCUNY QUEENSBOROUGH COMMUNI 15781\nN.Y.C. TRANSIT AUTHORITY 276525\nDEPARTMENT OF ENVIRONMENTA 37571\nDEPARTMENT OF SANITATION 57197\nN.Y.C. HOUSING AUTHORITY 60159\nDEPARTMENT FOR THE AGING 5483\nCUNY KINGSBOROUGH COMMMUNI 22059\nDEPARTMENT OF HEALTH AND M 42140\nDEPARTMENT OF CORRECTION 60135\nOFFICE OF ADMINISTRATIVE T 4149\nFIRE DEPARTMENT 86885\nCUNY LAGUARDIA COMMUNITY C 25515\nOFFICE OF THE COMPTROLLER 4137\nDEPARTMENT OF EDUCATION 66449\nDEPARTMENT OF FINANCE 10684\nDISTRICT ATTORNEY-NEW YORK 9958\nLAW DEPARTMENT 9326\nDEPARTMENT OF TRANSPORTATI 33846\nOFFICE OF MANAGEMENT AND B 2531\nDEPARTMENT OF HOMELESS SER 14744\nDEPARTMENT OF INFORMATION 7676\nCUNY BRONX COMMUNITY COLLE 14403\nNYC EMPLOYEES' RETIREMENT 2299\nDISTRICT ATTORNEY-QUEENS C 4302\nDEPARTMENT OF PARKS & RECR 72746\nDEPARTMENT OF BUILDINGS 7756\nDISTRICT ATTORNEY-RICHMOND 911\nDISTRICT ATTORNEY-KINGS CO 7151\nCUNY HOSTOS COMMUNITY COLL 10994\nCUNY MANHATTAN COMMUNITY C 27473\nDEPARTMENT OF DESIGN AND C 8614\nHOUSING PRESERVATION & DEV 14378\nTRIBOROUGH BRIDGE AND TUNN 11613\nFINANCIAL INFORMATION SERV 2675\nADMINISTRATION FOR CHILDRE 41682\nDEPARTMENT OF PROBATION 5598\nDEPARTMENT OF YOUTH AND CO 3384\nTAXI AND LIMOUSINE COMMISS 4115\nDEPARTMENT OF CONSUMER AFF 2475\nCITY COUNCIL 4299\nOFFICE OF THE MAYOR 3009\nDEPARTMENT OF CITY PLANNIN 2069\nOFFICE OF LABOR RELATIONS 679\nCUNY HUNTER COLLEGE HIGH S 1976\nDISTRICT ATTORNEY-BRONX CO 6442\nNYC POLICE PENSION FUND 800\nDISTRICT ATTORNEY - SPECIA 1408\nCIVILIAN COMPLAINT REVIEW 1023\nBOARD OF ELECTIONS 4293\nTEACHERS' RETIREMENT SYSTE 2350\nOFFICE OF EMERGENCY MANAGE 1085\nCOMMUNITY BOARD NO.1-MANHA 20\nCITY CLERK 383\nPUBLIC ADVOCATE 314\nCOMMUNITY BOARD NO.8-QUEEN 25\nBOROUGH PRESIDENT-BROOKLYN 426\nDEPARTMENT OF BUSINESS SER 1993\nOFFICE OF PAYROLL ADMINIST 962\nCUNY COLLEGE OF STATEN ISL 2874\nDEPT. OF RECORDS AND INFOR 435\nTAX COMMISSION 283\nDEPARTMENT OF CULTURAL AFF 430\nBUSINESS INTEGRITY COMMISS 526\nDEPARTMENT OF INVESTIGATIO 2085\nLANDMARKS PRESERVATION COM 485\nBOROUGH PRESIDENT-RICHMOND 282\nBOROUGH PRESIDENT-MANHATTA 342\nBOROUGH PRESIDENT-BRONX 297\nINDEPENDENT BUDGET OFFICE 193\nCOMMUNITY BOARD NO.10-MANH 22\nBOROUGH PRESIDENT-QUEENS 306\nCOMMUNITY BOARD NO.2-MANHA 23\nCAMPAIGN FINANCE BOARD 576\nBOARD OF CORRECTIONS 122\nCOMMISSION ON HUMAN RIGHTS 746\nCOMMUNITY BOARD NO.2-BRONX 19\nCOMMUNITY BOARD NO.7-BRONX 17\nOFFICE OF COLLECTIVE BARGA 109\nMUNICIPAL WATER FINANCE AU 79\nPUBLIC ADMINISTRATOR QUEEN 49\nCOMMUNITY BOARD NO.4-MANHA 19\nCOMMUNITY BOARD NO.9-QUEEN 22\nCOMMUNITY BOARD NO.17-BROO 24\nCOMMUNITY BOARD NO.8-BRONX 21\nCOMMUNITY BOARD NO.5-MANHA 19\nCOMMUNITY BOARD NO.10-BROO 23\nPUBLIC ADMINISTRATOR NEW Y 64\nCONFLICTS OF INTEREST BOAR 151\nCOMMUNITY BOARD NO.11-QUEE 19\nCOMMUNITY BOARD NO.2-QUEEN 24\nOFFICE OF THE ACTUARY 198\nCOMMUNITY BOARD NO.7-QUEEN 25\nCOMMUNITY BOARD NO.12-MANH 19\nPUBLIC ADMINISTRATOR RICHM 32\nCOMMUNITY BOARD NO.4-BROOK 17\nCOMMUNITY BOARD NO.6-BROOK 18\nCOMMUNITY BOARD NO.13-QUEE 19\nCOMMUNITY BOARD NO.16-BROO 17\nCOMMUNITY BOARD NO.11-MANH 21\nCOMMUNITY BOARD NO.13-BROO 21\nCOMMUNITY BOARD NO.6-QUEEN 26\nCOMMUNITY BOARD NO.3-BROOK 17\nCOMMUNITY BOARD NO.14-BROO 18\nCOMMUNITY BOARD NO.5-BROOK 23\nCOMMUNITY BOARD NO.1-RICHM 18\nCOMMUNITY BOARD NO.10-BRON 32\nCOMMUNITY BOARD NO.1-BROOK 18\nCOMMUNITY BOARD NO.4-QUEEN 18\nCUNY MEDGAR EVERS COLLEGE 6\nCIVIL SERVICE COMMISSION 56\nCOMMUNITY BOARD NO.3-MANHA 25\nCOMMUNITY BOARD NO.2-BROOK 19\nCOMMUNITY BOARD NO.10-QUEE 24\nCOMMUNITY BOARD NO.7-BROOK 18\nCOMMUNITY BOARD NO.5-BRONX 15\nPUBLIC ADMINISTRATOR KINGS 78\nCOMMUNITY BOARD NO.2-RICHM 23\nCOMMUNITY BOARD NO.3-BRONX 12\nCOMMUNITY BOARD NO.14-QUEE 18\nCOMMUNITY BOARD NO.11-BROO 19\nPUBLIC ADMINISTRATOR BRONX 49\nCOMMUNITY BOARD NO.11-BRON 29\nCOMMUNITY BOARD NO.6-BRONX 18\nCOMMUNITY BOARD NO.8-MANHA 27\nCOMMUNITY BOARD NO.8-BROOK 18\nCOMMUNITY BOARD NO.5-QUEEN 24\nCOMMUNITY BOARD NO.4 BRONX 18\nCOMMUNITY BOARD NO.9-BRONX 26\nCOMMUNITY BOARD NO.12-BRON 15\nCOMMUNITY BOARD NO.1-QUEEN 26\nEQUAL EMPLOYMENT PRACTICES 66\nCOMMUNITY BOARD NO.12-BROO 20\nCOMMUNITY BOARD NO.3-QUEEN 26\nCOMMUNITY BOARD NO.1 BRONX 7\nCOMMUNITY BOARD NO.7-MANHA 18\nCOMMUNITY BOARD N0.9-MANHA 18\nCOMMUNITY BOARD NO.9-BROOK 13\nCOMMUNITY BOARD NO.6-MANHA 17\nCOMMUNITY BOARD NO.15-BROO 18\nCOMMUNITY BOARD NO.18-BROO 18\nCOMMUNITY BOARD NO.12-QUEE 20\nCOMMUNITY BOARD NO.3-RICHM 19\nCUNY CENTRAL OFFICE 228\nDEPARTMENT OF SANITATION   12627\nPOLICE DEPARTMENT          57759\nN.Y.C. TRANSIT AUTHORITY   55587\nCITY COUNCIL               857\nDEPARTMENT OF EDUCATION    13970\nN.Y.C. HOUSING AUTHORITY   12336\nDEPARTMENT OF CORRECTION   13424\nDEPARTMENT FOR THE AGING   1246\nDEPARTMENT OF FINANCE      2170\nFIRE DEPARTMENT            18081\nDEPARTMENT OF PROBATION    1138\nOFFICE OF LABOR RELATIONS  142\nNYC EMPLOYEES' RETIREMENT  466\nLAW DEPARTMENT             1990\nDEPARTMENT OF INFORMATION  1688\nOFFICE OF THE MAYOR        548\nNYC POLICE PENSION FUND    176\nOFFICE OF THE COMPTROLLER  889\nBOARD OF ELECTIONS         951\nDEPARTMENT OF BUILDINGS    1798\nCAMPAIGN FINANCE BOARD     134\nMAYOR'S OFFICE OF CONTRACT 613\nBOARD OF CORRECTIONS       32\nINDEPENDENT BUDGET OFFICE  38\nCITY CLERK                 78\nCIVILIAN COMPLAINT REVIEW  203\nDEPARTMENT OF VETERANS' SE 155\nBOROUGH PRESIDENT-QUEENS   61\nPUBLIC ADVOCATE            72\nOFFICE OF THE ACTUARY      41\nTAX COMMISSION             59\nBOROUGH PRESIDENT-BRONX    57\nNEW YORK CITY FIRE PENSION 98\nCIVIL SERVICE COMMISSION   13\nCUNY CENTRAL OFFICE        33\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=103",
              "$$hashKey": "object:2827"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639108601043_1846306862",
      "id": "paragraph_1639108601043_1846306862",
      "dateCreated": "2021-12-09T22:56:41-0500",
      "dateStarted": "2021-12-11T23:11:04-0500",
      "dateFinished": "2021-12-11T23:11:07-0500",
      "status": "FINISHED",
      "$$hashKey": "object:263"
    },
    {
      "text": "%spark.pyspark\nagency_name_new1 = dataset1.map(lambda x: (clean_new(x[3]),1)).countByKey()\nfor key, value in agency_name_new.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:07-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "ERROR",
        "msg": [
          {
            "type": "TEXT",
            "data": "Fail to execute line 3: for key, value in agency_name_new.items():\nTraceback (most recent call last):\n  File \"/data5/yarn/nm/usercache/yp2212/appcache/application_1622566668497_44294/container_1622566668497_44294_01_000001/tmp/1639243493376-0/zeppelin_python.py\", line 158, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 3, in <module>\nNameError: name 'agency_name_new' is not defined\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=104",
              "$$hashKey": "object:2873"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1638937318757_1581699105",
      "id": "paragraph_1638937318757_1581699105",
      "dateCreated": "2021-12-07T23:21:58-0500",
      "dateStarted": "2021-12-11T23:11:07-0500",
      "dateFinished": "2021-12-11T23:11:11-0500",
      "status": "ERROR",
      "$$hashKey": "object:264"
    },
    {
      "text": "%spark.pyspark\nagency_name_d1 = dataset1.map(lambda x: (clean_for_dataset1(x[3]),1)).countByKey()\nfor key, value in agency_name_d1.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T14:01:41-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "AGENCY NAME 1\nDEPARTMENT OF CITYWIDE ADMINISTRATIVE SERVICES 92519\nHRA/DEPARTMENT OF SOCIAL SERVICES 82952\nPOLICE DEPARTMENT 334963\nCUNY QUEENSBOROUGH COMMUNITY 15781\nN.Y.C. TRANSIT AUTHORITY 332112\nDEPARTMENT OF ENVIRONMENTAL 37571\nDEPARTMENT OF SANITATION 69824\nN.Y.C. HOUSING AUTHORITY 72495\nDEPARTMENT FOR THE AGING 6729\nCUNY KINGSBOROUGH COMMUNITY 22059\nDEPARTMENT OF HEALTH AND M 42140\nDEPARTMENT OF CORRECTION 73559\nOFFICE OF ADMINISTRATIVE T 4149\nFIRE DEPARTMENT 104966\nCUNY LAGUARDIA COMMUNITY C 25515\nOFFICE OF THE COMPTROLLER 5026\nDEPARTMENT OF EDUCATION 80419\nDEPARTMENT OF FINANCE 12854\nDISTRICT ATTORNEY-NEW YORK 9958\nLAW DEPARTMENT 11316\nDEPARTMENT OF TRANSPORTATION 33846\nOFFICE OF MANAGEMENT AND BUDGET 2531\nDEPARTMENT OF HOMELESS SERVICES 14744\nDEPARTMENT OF INFORMATION 9364\nCUNY BRONX COMMUNITY COLLEGE 14403\nNYC EMPLOYEES' RETIREMENT 2765\nDISTRICT ATTORNEY-QUEENS COUNTY 4302\nDEPARTMENT OF PARKS & RECREATION 72746\nDEPARTMENT OF BUILDINGS 9554\nDISTRICT ATTORNEY-RICHMOND COUNTY 911\nDISTRICT ATTORNEY-KINGS COUNTY 7151\nCUNY HOSTOS COMMUNITY COLL 10994\nCUNY MANHATTAN COMMUNITY C 27473\nDEPARTMENT OF DESIGN AND C 8614\nHOUSING PRESERVATION & DEVELOPMENT 14378\nTRIBOROUGH BRIDGE AND TUNNEL 11613\nFINANCIAL INFORMATION SERVIVES 2675\nADMINISTRATION FOR CHILDREN'S SERVIVES 41682\nDEPARTMENT OF PROBATION 6736\nDEPARTMENT OF YOUTH AND COMUNITY SERVICES 3384\nTAXI AND LIMOUSINE COMMISSION 4115\nDEPARTMENT OF CONSUMER AFFAIRS 2475\nCITY COUNCIL 5156\nOFFICE OF THE MAYOR 3557\nDEPARTMENT OF CITY PLANNING 2069\nOFFICE OF LABOR RELATIONS 821\nCUNY HUNTER COLLEGE HIGH SCHOOL 1976\nDISTRICT ATTORNEY-BRONX COUNTY 6442\nNYC POLICE PENSION FUND 976\nDISTRICT ATTORNEY - SPECIAL AGENT 1408\nCIVILIAN COMPLAINT REVIEW BOARD 1226\nBOARD OF ELECTIONS 5244\nTEACHERS' RETIREMENT SYSTEM 2350\nOFFICE OF EMERGENCY MANAGEMENT 1085\nMANHATTAN COMMUNITY BOARD #1 20\nCITY CLERK 461\nPUBLIC ADVOCATE 386\nQUEENS COMMUNITY BOARD #8 25\nBOROUGH PRESIDENT-BROOKLYN 426\nDEPARTMENT OF BUSINESS SERVICES 1993\nOFFICE OF PAYROLL ADMINISTRATION 962\nCUNY COLLEGE OF STATEN ISLAND 2874\nDEPT. OF RECORDS AND INFORMATION SERVICES 435\nTAX COMMISSION 342\nDEPARTMENT OF CULTURAL AFFAIRS 430\nBUSINESS INTEGRITY COMMISSION 526\nDEPARTMENT OF INVESTIGATIO 2085\nLANDMARKS PRESERVATION COMMISSON 485\nBOROUGH PRESIDENT-RICHMOND 282\nBOROUGH PRESIDENT-MANHATTA 342\nBOROUGH PRESIDENT-BRONX 354\nINDEPENDENT BUDGET OFFICE 231\nMANHATTAN COMMUNITY BOARD #10 22\nBOROUGH PRESIDENT-QUEENS 367\nMANHATTAN COMMUNITY BOARD #2 23\nCAMPAIGN FINANCE BOARD 710\nBOARD OF CORRECTIONS 154\nCOMMISSION ON HUMAN RIGHTS 746\nBRONX COMMUNITY BOARD #2 19\nBRONX COMMUNITY BOARD #7 17\nOFFICE OF COLLECTIVE BARGA 109\nMUNICIPAL WATER FINANCE AU 79\nPUBLIC ADMINISTRATOR QUEEN 49\nMANHATTAN COMMUNITY BOARD #4 19\nQUEENS COMMUNITY BOARD #9 22\nBROOKLYN COMMUNITY BOARD #17 24\nBRONX COMMUNITY BOARD #8 21\nMANHATTAN COMMUNITY BOARD #5 19\nBROOKLYN COMMUNITY BOARD #10 23\nPUBLIC ADMINISTRATOR NEW YORK CITY 64\nCONFLICTS OF INTEREST BOAR 151\nQUEENS COMMUNITY BOARD #11 19\nQUEENS COMMUNITY BOARD #2 24\nOFFICE OF THE ACTUARY 239\nQUEENS COMMUNITY BOARD #7 25\nMANHATTAN COMMUNITY BOARD #12 19\nPUBLIC ADMINISTRATOR RICHM 32\nBROOKLYN COMMUNITY BOARD #4 17\nBROOKLYN COMMUNITY BOARD #6 18\nQUEENS COMMUNITY BOARD #13 19\nBROOKLYN COMMUNITY BOARD #16 17\nMANHATTAN COMMUNITY BOARD #11 21\nBROOKLYN COMMUNITY BOARD #13 21\nQUEENS COMMUNITY BOARD #6 26\nBROOKLYN COMMUNITY BOARD #3 17\nBROOKLYN COMMUNITY BOARD #14 18\nBROOKLYN COMMUNITY BOARD #5 23\nRICHMOND COMMUNITY BOARD #1 18\nBRONX COMMUNITY BOARD #10 32\nBROOKLYN COMMUNITY BOARD #1 18\nQUEENS COMMUNITY BOARD #4 18\nCUNY MEDGAR EVERS COLLEGE 6\nCIVIL SERVICE COMMISSION 69\nMANHATTAN COMMUNITY BOARD #3 25\nBROOKLYN COMMUNITY BOARD #2 19\nQUEENS COMMUNITY BOARD #10 24\nBROOKLYN COMMUNITY BOARD #7 18\nBRONX COMMUNITY BOARD #5 15\nPUBLIC ADMINISTRATOR KINGS 78\nRICHMOND COMMUNITY BOARD #2 23\nBRONX COMMUNITY BOARD #3 12\nQUEENS COMMUNITY BOARD #14 18\nBROOKLYN COMMUNITY BOARD #11 19\nPUBLIC ADMINISTRATOR BRONX 49\nBRONX COMMUNITY BOARD #11 29\nBRONX COMMUNITY BOARD #6 18\nMANHATTAN COMMUNITY BOARD #8 27\nBROOKLYN COMMUNITY BOARD #8 18\nQUEENS COMMUNITY BOARD #5 24\nCOMMUNITY BOARD NO.4 BRONX 18\nBRONX COMMUNITY BOARD #9 26\nBRONX COMMUNITY BOARD #12 15\nQUEENS COMMUNITY BOARD #1 26\nEQUAL EMPLOYMENT PRACTICES 66\nBROOKLYN COMMUNITY BOARD #12 20\nQUEENS COMMUNITY BOARD #3 26\nBRONX COMMUNITY BOARD #1 7\nMANHATTAN COMMUNITY BOARD #7 18\nMANHATTAN COMMUNITY BOARD #9 18\nBROOKLYN COMMUNITY BOARD #9 13\nMANHATTAN COMMUNITY BOARD #6 17\nBROOKLYN COMMUNITY BOARD #15 18\nBROOKLYN COMMUNITY BOARD #18 18\nQUEENS COMMUNITY BOARD #12 20\nRICHMOND COMMUNITY BOARD #3 19\nCUNY CENTRAL OFFICE 261\nMAYOR'S OFFICE OF CONTRACT 613\nDEPARTMENT OF VETERANS' SE 155\nNEW YORK CITY FIRE PENSION 98\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=13",
              "$$hashKey": "object:2919"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639108436736_1632706518",
      "id": "paragraph_1639108436736_1632706518",
      "dateCreated": "2021-12-09T22:53:56-0500",
      "dateStarted": "2021-12-11T12:25:06-0500",
      "dateFinished": "2021-12-11T12:25:14-0500",
      "status": "FINISHED",
      "$$hashKey": "object:265"
    },
    {
      "text": "%spark.pyspark\n#count the precision for original clean and clean_new\n#we use the recall to check the percentage of the darty data and the numbers of the data we clean\narr_origin = []\narr_old = []\narr_new = []\narr_pres = []\nfor key, value in agency_name1.items():\n    arr_origin.append(key)\nfor key, value in agency_name_old1.items():\n    arr_old.append(key)\nfor key, value in agency_name_new1.items():\n    arr_new.append(key)\nfor key, value in agency_name_d1.items():\n    arr_pres.append(key)\n    \nclean_recall = len(set(arr_old).difference(set(arr_origin))) / (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres))))\nclean_new_recall =  len(set(arr_new).difference(set(arr_origin))) / (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres))))\n\nprint(\"clean_recall:\")\nprint(clean_recall)\nprint(\"clean_new_recall:\")\nprint(clean_new_recall)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T14:01:41-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "clean_recall:\n0.0\nclean_new_recall:\n0.6129032258064516\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639114375551_68373360",
      "id": "paragraph_1639114375551_68373360",
      "dateCreated": "2021-12-10T00:32:55-0500",
      "dateStarted": "2021-12-11T12:25:10-0500",
      "dateFinished": "2021-12-11T12:25:14-0500",
      "status": "FINISHED",
      "$$hashKey": "object:266"
    },
    {
      "text": "%spark.pyspark\n###dataset2 test for Agency Name",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T14:01:41-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639108629032_1598184983",
      "id": "paragraph_1639108629032_1598184983",
      "dateCreated": "2021-12-09T22:57:09-0500",
      "dateStarted": "2021-12-11T12:25:14-0500",
      "dateFinished": "2021-12-11T12:25:14-0500",
      "status": "FINISHED",
      "$$hashKey": "object:267"
    },
    {
      "text": "%spark.pyspark\nagency_name2 = dataset2.map(lambda x: (x[2], 1)).countByKey()\nfor key, value in agency_name2.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T14:01:41-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Agency Name 1\nADMINISTRATION FOR CHILDREN'S SERVICES 1550\nBUSINESS INTEGRITY COMMISSION 135\nDEPARTMENT FOR THE AGING 463\nDEPARTMENT OF BUILDINGS 896\nDEPARTMENT OF CITY PLANNING 360\nDEPARTMENT OF CITYWIDE ADMINISTRATIVE SERVICES 1574\nDEPARTMENT OF CONSUMER AFFAIRS 468\nDEPARTMENT OF CORRECTION 1705\nDEPARTMENT OF CULTURAL AFFAIRS 117\nDEPARTMENT OF DESIGN AND CONSTRUCTION 903\nDEPARTMENT OF EDUCATION (NON-PEDAGOGICAL) 2633\nDEPARTMENT OF ENVIRONMENTAL PROTECTION 2084\nDEPARTMENT OF FINANCE 1100\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE 2502\nDEPARTMENT OF HOMELESS SERVICES 1086\nDEPARTMENT OF INFORMATION TECHNOLOGY AND TELECOMMUNICATIONS 1059\nDEPARTMENT OF INVESTIGATION 428\nDEPARTMENT OF PARKS AND RECREATION 2280\nDEPARTMENT OF PROBATION 567\nDEPARTMENT OF RECORDS AND INFORMATION SERVICES 131\nDEPARTMENT OF SANITATION 1527\nDEPARTMENT OF SMALL BUSINESS SERVICES 385\nDEPARTMENT OF TRANSPORTATION 1842\nDEPARTMENT OF VETERANS' SERVICES 66\nDEPARTMENT OF YOUTH AND COMMUNITY DEVELOPMENT 605\nFIRE DEPARTMENT 1771\nHOUSING PRESERVATION AND DEVELOPMENT 1181\nHUMAN RESOURCES ADMINISTRATION/DEPARTMENT OF SOCIAL SERVICES 1997\nLAW DEPARTMENT 979\nMAYORS OFFICE OF CONTRACT SERVICES 254\nOFFICE OF ADMINISTRATIVE TRIALS AND HEARINGS 520\nOFFICE OF EMERGENCY MANAGEMENT 224\nOFFICE OF LABOR RELATIONS 212\nOFFICE OF MANAGEMENT AND BUDGET 352\nOFFICE OF THE MAYOR 588\nPOLICE DEPARTMENT 2808\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=14",
              "$$hashKey": "object:3045"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639108724062_777244908",
      "id": "paragraph_1639108724062_777244908",
      "dateCreated": "2021-12-09T22:58:44-0500",
      "dateStarted": "2021-12-11T12:25:14-0500",
      "dateFinished": "2021-12-11T12:25:14-0500",
      "status": "FINISHED",
      "$$hashKey": "object:268"
    },
    {
      "text": "%spark.pyspark\nagency_name_old2 = dataset2.map(lambda x: (clean(x[2]),1)).countByKey()\nfor key, value in agency_name_old2.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:27-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "AGENCY NAME 1\nADMINISTRATION FOR CHILDREN'S SERVICES 1550\nBUSINESS INTEGRITY COMMISSION 135\nDEPARTMENT FOR THE AGING 463\nDEPARTMENT OF BUILDINGS 896\nDEPARTMENT OF CITY PLANNING 360\nDEPARTMENT OF CITYWIDE ADMINISTRATIVE SERVICES 1574\nDEPARTMENT OF CONSUMER AFFAIRS 468\nDEPARTMENT OF CORRECTION 1705\nDEPARTMENT OF CULTURAL AFFAIRS 117\nDEPARTMENT OF DESIGN AND CONSTRUCTION 903\nDEPARTMENT OF EDUCATION (NON-PEDAGOGICAL) 2633\nDEPARTMENT OF ENVIRONMENTAL PROTECTION 2084\nDEPARTMENT OF FINANCE 1100\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE 2502\nDEPARTMENT OF HOMELESS SERVICES 1086\nDEPARTMENT OF INFORMATION TECHNOLOGY AND TELECOMMUNICATIONS 1059\nDEPARTMENT OF INVESTIGATION 428\nDEPARTMENT OF PARKS AND RECREATION 2280\nDEPARTMENT OF PROBATION 567\nDEPARTMENT OF RECORDS AND INFORMATION SERVICES 131\nDEPARTMENT OF SANITATION 1527\nDEPARTMENT OF SMALL BUSINESS SERVICES 385\nDEPARTMENT OF TRANSPORTATION 1842\nDEPARTMENT OF VETERANS' SERVICES 66\nDEPARTMENT OF YOUTH AND COMMUNITY DEVELOPMENT 605\nFIRE DEPARTMENT 1771\nHOUSING PRESERVATION AND DEVELOPMENT 1181\nHUMAN RESOURCES ADMINISTRATION/DEPARTMENT OF SOCIAL SERVICES 1997\nLAW DEPARTMENT 979\nMAYORS OFFICE OF CONTRACT SERVICES 254\nOFFICE OF ADMINISTRATIVE TRIALS AND HEARINGS 520\nOFFICE OF EMERGENCY MANAGEMENT 224\nOFFICE OF LABOR RELATIONS 212\nOFFICE OF MANAGEMENT AND BUDGET 352\nOFFICE OF THE MAYOR 588\nPOLICE DEPARTMENT 2808\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=105",
              "$$hashKey": "object:3091"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639118185318_312942985",
      "id": "paragraph_1639118185318_312942985",
      "dateCreated": "2021-12-10T01:36:25-0500",
      "dateStarted": "2021-12-11T23:11:27-0500",
      "dateFinished": "2021-12-11T23:11:27-0500",
      "status": "FINISHED",
      "$$hashKey": "object:269"
    },
    {
      "text": "%spark.pyspark\nagency_name_d2 = dataset2.map(lambda x: (clean_new(x[2]),1)).countByKey()\nfor key, value in agency_name_d2.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:30-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "AGENCY NAME 1\nADMINISTRATION FOR CHILDREN'S SERVICES 1550\nBUSINESS INTEGRITY COMMISSION 135\nDEPARTMENT FOR THE AGING 463\nDEPARTMENT OF BUILDINGS 896\nDEPARTMENT OF CITY PLANNING 360\nDEPARTMENT OF CITYWIDE ADMINISTRATIVE SERVICES 1574\nDEPARTMENT OF CONSUMER AFFAIRS 468\nDEPARTMENT OF CORRECTION 1705\nDEPARTMENT OF CULTURAL AFFAIRS 117\nDEPARTMENT OF DESIGN AND CONSTRUCTION 903\nDEPARTMENT OF EDUCATION (NON-PEDAGOGICAL) 2633\nDEPARTMENT OF ENVIRONMENTAL PROTECTION 2084\nDEPARTMENT OF FINANCE 1100\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE 2502\nDEPARTMENT OF HOMELESS SERVICES 1086\nDEPARTMENT OF INFORMATION TECHNOLOGY AND TELECOMMUNICATIONS 1059\nDEPARTMENT OF INVESTIGATION 428\nDEPARTMENT OF PARKS AND RECREATION 2280\nDEPARTMENT OF PROBATION 567\nDEPARTMENT OF RECORDS AND INFORMATION SERVICES 131\nDEPARTMENT OF SANITATION 1527\nDEPARTMENT OF SMALL BUSINESS SERVICES 385\nDEPARTMENT OF TRANSPORTATION 1842\nDEPARTMENT OF VETERANS' SERVICES 66\nDEPARTMENT OF YOUTH AND COMMUNITY DEVELOPMENT 605\nFIRE DEPARTMENT 1771\nHOUSING PRESERVATION AND DEVELOPMENT 1181\nHUMAN RESOURCES ADMINISTRATION/DEPARTMENT OF SOCIAL SERVICES 1997\nLAW DEPARTMENT 979\nMAYORS OFFICE OF CONTRACT SERVICES 254\nOFFICE OF ADMINISTRATIVE TRIALS AND HEARINGS 520\nOFFICE OF EMERGENCY MANAGEMENT 224\nOFFICE OF LABOR RELATIONS 212\nOFFICE OF MANAGEMENT AND BUDGET 352\nOFFICE OF THE MAYOR 588\nPOLICE DEPARTMENT 2808\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=106",
              "$$hashKey": "object:3137"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639111259766_176997802",
      "id": "paragraph_1639111259766_176997802",
      "dateCreated": "2021-12-09T23:40:59-0500",
      "dateStarted": "2021-12-11T23:11:30-0500",
      "dateFinished": "2021-12-11T23:11:30-0500",
      "status": "FINISHED",
      "$$hashKey": "object:270"
    },
    {
      "text": "%spark.pyspark\n#count the precision for original clean and clean_new\n#we use the recall to check the percentage of the darty data and the numbers of the data we clean\n#in this case arr_new is just the same as arr_pres\narr_origin = []\narr_old = []\narr_new = []\narr_pres = []\nfor key, value in agency_name2.items():\n    arr_origin.append(key)\nfor key, value in agency_name_old2.items():\n    arr_old.append(key)\nfor key, value in agency_name_d2.items():\n    arr_new.append(key)\nfor key, value in agency_name_d2.items():\n    arr_pres.append(key)\n    \nclean_recall = len(set(arr_old).difference(set(arr_origin))) / (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres))))\nclean_new_recall =  len(set(arr_new).difference(set(arr_origin))) / (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres))))\n\nprint(\"clean_recall:\")\nprint(clean_recall)\nprint(\"clean_new_recall:\")\nprint(clean_new_recall)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:32-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "clean_recall:\n1.0\nclean_new_recall:\n1.0\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639117336852_1119918677",
      "id": "paragraph_1639117336852_1119918677",
      "dateCreated": "2021-12-10T01:22:16-0500",
      "dateStarted": "2021-12-11T23:11:32-0500",
      "dateFinished": "2021-12-11T23:11:32-0500",
      "status": "FINISHED",
      "$$hashKey": "object:271"
    },
    {
      "text": "%spark.pyspark\n###dataset3 test for Agency Name",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:36-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639111353488_143510267",
      "id": "paragraph_1639111353488_143510267",
      "dateCreated": "2021-12-09T23:42:33-0500",
      "dateStarted": "2021-12-11T23:11:36-0500",
      "dateFinished": "2021-12-11T23:11:36-0500",
      "status": "FINISHED",
      "$$hashKey": "object:272"
    },
    {
      "text": "%spark.pyspark\nagency_name3 = dataset3.map(lambda x: (x[2],1)).countByKey()\nfor key, value in agency_name3.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:37-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "AGENCY NAME 1\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE 7658\nPOLICE DEPARTMENT 3325\nDEPARTMENT OF SMALL BUSINESS SERVICES 1531\nDEPARTMENT OF YOUTH & COMMUNITY DEV 1640\nHOUSING PRESERVATION AND DEVELOPMENT 2110\nDEPARTMENT OF TRANSPORTATION 2590\nDEPARTMENT OF SOCIAL SERVICES 5014\nDEPARTMENT OF SANITATION 2746\nDEPARTMENT FOR THE AGING 1199\nDEPARTMENT OF PARKS AND RECREATION 4037\nDEPARTMENT OF CORRECTION 1129\nDEPARTMENT OF HOMELESS SERVICES 1432\nADMIN FOR CHILDREN'S SERVICES 3509\nDEPARTMENT OF ENVIRONMENTAL PROTECT. 1500\nDEPARTMENT OF FINANCE 1642\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=107",
              "$$hashKey": "object:3263"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639111380465_62243353",
      "id": "paragraph_1639111380465_62243353",
      "dateCreated": "2021-12-09T23:43:00-0500",
      "dateStarted": "2021-12-11T23:11:37-0500",
      "dateFinished": "2021-12-11T23:11:37-0500",
      "status": "FINISHED",
      "$$hashKey": "object:273"
    },
    {
      "text": "%spark.pyspark\nagency_name_old3 = dataset3.map(lambda x: (clean(x[2]),1)).countByKey()\nfor key, value in agency_name_old3.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:45-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "AGENCY NAME 1\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE 7658\nPOLICE DEPARTMENT 3325\nDEPARTMENT OF SMALL BUSINESS SERVICES 1531\nDEPARTMENT OF YOUTH & COMMUNITY DEV 1640\nHOUSING PRESERVATION AND DEVELOPMENT 2110\nDEPARTMENT OF TRANSPORTATION 2590\nDEPARTMENT OF SOCIAL SERVICES 5014\nDEPARTMENT OF SANITATION 2746\nDEPARTMENT FOR THE AGING 1199\nDEPARTMENT OF PARKS AND RECREATION 4037\nDEPARTMENT OF CORRECTION 1129\nDEPARTMENT OF HOMELESS SERVICES 1432\nADMIN FOR CHILDREN'S SERVICES 3509\nDEPARTMENT OF ENVIRONMENTAL PROTECT. 1500\nDEPARTMENT OF FINANCE 1642\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=109",
              "$$hashKey": "object:3309"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639118219138_1581103860",
      "id": "paragraph_1639118219138_1581103860",
      "dateCreated": "2021-12-10T01:36:59-0500",
      "dateStarted": "2021-12-11T23:11:45-0500",
      "dateFinished": "2021-12-11T23:11:46-0500",
      "status": "FINISHED",
      "$$hashKey": "object:274"
    },
    {
      "text": "%spark.pyspark\nagency_name_d3 = dataset3.map(lambda x: (clean_new(x[2]),1)).countByKey()\nfor key, value in agency_name_d3.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:52-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "AGENCY NAME 1\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE 7658\nPOLICE DEPARTMENT 3325\nDEPARTMENT OF SMALL BUSINESS SERVICES 1531\nDEPARTMENT OF YOUTH & COMMUNITY DEV 1640\nHOUSING PRESERVATION AND DEVELOPMENT 2110\nDEPARTMENT OF TRANSPORTATION 2590\nDEPARTMENT OF SOCIAL SERVICES 5014\nDEPARTMENT OF SANITATION 2746\nDEPARTMENT FOR THE AGING 1199\nDEPARTMENT OF PARKS AND RECREATION 4037\nDEPARTMENT OF CORRECTION 1129\nDEPARTMENT OF HOMELESS SERVICES 1432\nADMIN FOR CHILDREN'S SERVICES 3509\nDEPARTMENT OF ENVIRONMENTAL PROTECT. 1500\nDEPARTMENT OF FINANCE 1642\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=111",
              "$$hashKey": "object:3355"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639111435352_2017109123",
      "id": "paragraph_1639111435352_2017109123",
      "dateCreated": "2021-12-09T23:43:55-0500",
      "dateStarted": "2021-12-11T23:11:52-0500",
      "dateFinished": "2021-12-11T23:11:52-0500",
      "status": "FINISHED",
      "$$hashKey": "object:275"
    },
    {
      "text": "%spark.pyspark\n#count the precision for original clean and clean_new\n#we use the recall to check the percentage of the darty data and the numbers of the data we clean\n#in this case arr_new is just the same as arr_pres\narr_origin = []\narr_old = []\narr_new = []\narr_pres = []\nfor key, value in agency_name3.items():\n    arr_origin.append(key)\nfor key, value in agency_name_old3.items():\n    arr_old.append(key)\nfor key, value in agency_name_d3.items():\n    arr_new.append(key)\nfor key, value in agency_name_d3.items():\n    arr_pres.append(key)\n\nif (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres)))) == 0:\n    clean_recall = 1\n    celan_new_recall = 1\nelse:\n    clean_recall = len(set(arr_old).difference(set(arr_origin))) / (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres))))\n    clean_new_recall =  len(set(arr_new).difference(set(arr_origin))) / (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres))))\n\nprint(\"clean_recall:\")\nprint(clean_recall)\nprint(\"clean_new_recall:\")\nprint(clean_new_recall)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:55-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "clean_recall:\n1\nclean_new_recall:\n1.0\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639117491220_1519555461",
      "id": "paragraph_1639117491220_1519555461",
      "dateCreated": "2021-12-10T01:24:51-0500",
      "dateStarted": "2021-12-11T23:11:55-0500",
      "dateFinished": "2021-12-11T23:11:55-0500",
      "status": "FINISHED",
      "$$hashKey": "object:276"
    },
    {
      "text": "%spark.pyspark\n###dataset4 test for Agency Name",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:57-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639111449239_1941020212",
      "id": "paragraph_1639111449239_1941020212",
      "dateCreated": "2021-12-09T23:44:09-0500",
      "dateStarted": "2021-12-11T23:11:57-0500",
      "dateFinished": "2021-12-11T23:11:57-0500",
      "status": "FINISHED",
      "$$hashKey": "object:277"
    },
    {
      "text": "%spark.pyspark\nagency_name4 = dataset4.map(lambda x: (x[0],1)).countByKey()\nfor key, value in agency_name4.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:11:58-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Agency Name 1\nActuary, Office of 6\nAddiction Services & Supports, Office Of 14\nAdministrative Trials And Hearings, Office of 23\nAging 21\nAging, NYS Office for the 1\nAgriculture & Markets, Department of 8\nAlcoholic Beverage Control, Division of (State Liquor Authority) 4\nArts, Council on the 3\nAttorney General, Office of 8\nBattery Park City Authority 11\nBorough Historians 5\nBorough Historical Societies 10\nBorough President - Bronx 23\nBorough President - Brooklyn 16\nBorough President - Manhattan 9\nBorough President - Queens 25\nBorough President - Staten Island 12\nBrooklyn Bridge Park Corporation 6\nBrooklyn Navy Yard Development Corporation 12\nBrooklyn Public Library 4\nBudget, Division of the 4\nBuildings 37\nBusiness Integrity Commission 7\nCampaign Finance Board 18\nChildren & Family Services, NYS Office of 19\nChildren's Services, Administration for 143\nCity Clerk & Clerk of the Council 21\nCity Council 73\nCity Planning 29\nCity Planning Commission 1\nCity University Construction Fund 4\nCity University of New York 264\nCity University of New York - Board of Trustees 2\nCitywide Administrative Services 75\nCivil Service Commission, City 2\nCivil Service, Department of 16\nCivilian Complaint Review Board 7\nCollective Bargaining, Office of 3\nCommunity Boards 118\nComptroller 124\nComptroller, State, Office of the 23\nConflicts of Interest Board 10\nConsumer Affairs 3\nContract Services, Mayor's Office of 1\nCorrection, Board of 1\nCorrection, Commission of 1\nCorrection, Department of 59\nCorrections & Community Supervision, Department of 13\nCounty Clerk 34\nCriminal Justice Services, Division of 12\nCultural Affairs 56\nCyber Command, NYC 1\nDeputy Chief Administrative Judge for the New York City Courts 2\nDesign and Construction 76\nDisabilities, Office for People With Developmental 4\nDistrict Attorney 72\nDormitory Authority State of NY 7\nEconomic Development Corporation, NYC 11\nEducation 108\nEducation Department, NYS 41\nEducation Retirement System, Board of 1\nEducational Construction Fund 3\nElections, Board of 28\nElections, Board of, NYS 2\nEmergency Management, NYC 29\nEmpire State Development 12\nEmployee Relations, Governor's Office of 3\nEmployees Retirement System Board of Trustees, NYC 5\nEnvironmental Commission, Interstate 1\nEnvironmental Conservation, Department of 15\nEnvironmental Protection 150\nEqual Employment Practices Commission 3\nFamily Court of the State of New York - City of New York 14\nFinance 39\nFinancial Control Board, NYS 1\nFinancial Information Services Agency 7\nFinancial Services, Department of 1\nFire Department 64\nFire Museum, NYC 1\nGaming Commission, NYS 5\nGeneral Services, Office of 1\nGovernor's Office 33\nGovernor, Lieutenant 9\nGovernors Island, Trust for 5\nGrowNYC 2\nHealth & Mental Hygiene, Department of 350\nHealth + Hospitals / Board of Directors, NYC 2\nHealth + Hospitals NYC, (NYC H+H) 43\nHealth, Department of 3\nHigher Education Services Corporation, NYS 9\nHomeland Security & Emergency Services, Division Of 1\nHomeless Services 72\nHomes & Community Renewal, NYS 11\nHousing Authority, NYC 131\nHousing Development Corporation, NYC 16\nHousing Preservation & Development 67\nHuman Resources Administration (HRA) Department of Social Services (DSS) 180\nHuman Rights, Commission on 16\nHuman Rights, NYS Division of 9\nIndependent Budget Office, NYC 6\nInformation Technology and Telecommunications 25\nInspector General, Office of the NYS 1\nInvestigation 48\nInvestigation for the NYC School District, Special Commissioner of 9\nJavits Center/NY Convention Center Operating Corporation 14\nJoint Commission on Public Ethics, NYS 8\nJudicial Conduct, NYS Commission on 3\nJudicial Conference of the United States 4\nJustice Center for the Protection of People with Special Needs, NYS 2\nLabor Relations, Office of 4\nLabor, Department of 20\nLandmarks Preservation Commission 15\nLaw Department, Office of the Corporation Counsel 111\nLaw Examiners, NYS Board of 2\nLegislative Bill Drafting Commission 1\nLegislature of the State of NY 98\nLiquidation Bureau, New York 2\nLower Manhattan Development Corporation 2\nManagement & Budget, Office of 13\nMayor, Office of the 68\nMedia Entertainment, Mayor's Office of 4\nMedical Examiner, Office of Chief, Institute of Forensic Sciences 16\nMental Health, Office of 1\nMetropolitan Transportation Authority (MTA) 96\nMetropolitan Transportation Authority, Inspector General, Office of the 1\nMilitary & Naval Affairs, NYS Division of 12\nMotor Vehicles, Department of 9\nMunicipal Credit Union 1\nNew York City Courts 23\nNew York Metropolitan Transportation Council 7\nNew York Public Library 21\nNew York State Court of Appeals 2\nNew York State Supreme Court - Eleventh Judicial District (Queens County) 6\nNew York State Supreme Court - First Judicial District (New York County) 9\nNew York State Supreme Court - Second Judicial District (Kings County) 4\nNew York State Supreme Court - Thirteenth Judicial District (Richmond County) 3\nNew York State Supreme Court - Twelfth Judicial District (Bronx County) 5\nNew York State Supreme Court Appellate Division - First Department (New York and Bronx County) 12\nNew York State Supreme Court Appellate Division - Second Department (includes Kings, Queens and Richmond Counties ) 14\nNew York State Supreme Court Libraries (New York City) 3\nNew York State Surrogate's Court - Bronx County 2\nNew York State Surrogate's Court - Kings County 6\nNew York State Surrogate's Court - New York County 4\nNew York State Surrogate's Court - Queens County 4\nNew York State Surrogate's Court - Richmond County 5\nNYC & Company 6\nNYC Fire Pension Fund 2\nNYS Court of Claims 1\nNYS Unified Court System Office of Court Administration 7\nOffice Of Special Narcotics 6\nParks, NYC 246\nParks, Recreation & Historic Preservation, Office of 4\nPayroll Administration, Office of 8\nPolice Corruption, Commission To Combat 1\nPolice Department 57\nPolice Pension Fund 8\nPort Authority of New York & New Jersey 33\nPower Authority, New York 1\nProbation 33\nPublic Administrator 19\nPublic Advocate for the City of New York 7\nPublic Employment Relations Board 2\nQueens Public Library 1\nRecords & Information Services 10\nRent Guidelines Board 1\nRoosevelt Island Operating Corp. of the State of NY 1\nSanitation 119\nSchool Construction Authority, NYC 15\nSmall Business Services 48\nStandards And Appeals, Board of 4\nState Police, Division of 6\nState University Construction Fund 1\nState University of New York, (SUNY) 27\nState, Department of 18\nSupreme Court of the United States 4\nTax Appeals Tribunal, NYS 2\nTax Appeals, Office Of Administrative 8\nTaxation & Finance, NYS Department of 9\nTaxi & Limousine Commission 32\nTeachers' Retirement System 14\nTeachers' Retirement System, NYS 1\nTemporary & Disability Assistance Office of 11\nThruway Authority, NYS 1\nTransitional Finance Authority, NYC 9\nTransportation 320\nTransportation, Department of 25\nU.S. Court of Appeals for the 2nd Circuit 2\nU.S. Court of Appeals for the Federal Circuit 1\nU.S. Court of International Trade 2\nU.S. District Court - Eastern District of New York 4\nU.S. District Court - Southern District of New York 5\nUniform State Laws, Commission on 5\nUnited Nations Development Corporation 3\nVeterans' Services, Department of 6\nVeterans' Services, NYS Division of 2\nVictim Services, Office of 1\nWater Finance Authority, NYC Municipal 9\nWaterfront Commission of NY Harbor 2\nYouth and Community Development 29\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=112",
              "$$hashKey": "object:3481"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639111484450_1926764914",
      "id": "paragraph_1639111484450_1926764914",
      "dateCreated": "2021-12-09T23:44:44-0500",
      "dateStarted": "2021-12-11T23:11:58-0500",
      "dateFinished": "2021-12-11T23:11:58-0500",
      "status": "FINISHED",
      "$$hashKey": "object:278"
    },
    {
      "text": "%spark.pyspark\nagency_name_old4 = dataset4.map(lambda x:  (clean(x[0]),1)).countByKey()\nfor key, value in agency_name_old4.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:12:01-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "AGENCY NAME 1\nACTUARY, OFFICE OF 6\nADDICTION SERVICES & SUPPORTS, OFFICE OF 14\nADMINISTRATIVE TRIALS AND HEARINGS, OFFICE OF 23\nAGING 21\nAGING, NYS OFFICE FOR THE 1\nAGRICULTURE & MARKETS, DEPARTMENT OF 8\nALCOHOLIC BEVERAGE CONTROL, DIVISION OF (STATE LIQUOR AUTHORITY) 4\nARTS, COUNCIL ON THE 3\nATTORNEY GENERAL, OFFICE OF 8\nBATTERY PARK CITY AUTHORITY 11\nBOROUGH HISTORIANS 5\nBOROUGH HISTORICAL SOCIETIES 10\nBOROUGH PRESIDENT - BRONX 23\nBOROUGH PRESIDENT - BROOKLYN 16\nBOROUGH PRESIDENT - MANHATTAN 9\nBOROUGH PRESIDENT - QUEENS 25\nBOROUGH PRESIDENT - STATEN ISLAND 12\nBROOKLYN BRIDGE PARK CORPORATION 6\nBROOKLYN NAVY YARD DEVELOPMENT CORPORATION 12\nBROOKLYN PUBLIC LIBRARY 4\nBUDGET, DIVISION OF THE 4\nBUILDINGS 37\nBUSINESS INTEGRITY COMMISSION 7\nCAMPAIGN FINANCE BOARD 18\nCHILDREN & FAMILY SERVICES, NYS OFFICE OF 19\nCHILDREN'S SERVICES, ADMINISTRATION FOR 143\nCITY CLERK & CLERK OF THE COUNCIL 21\nCITY COUNCIL 73\nCITY PLANNING 29\nCITY PLANNING COMMISSION 1\nCITY UNIVERSITY CONSTRUCTION FUND 4\nCITY UNIVERSITY OF NEW YORK 264\nCITY UNIVERSITY OF NEW YORK - BOARD OF TRUSTEES 2\nCITYWIDE ADMINISTRATIVE SERVICES 75\nCIVIL SERVICE COMMISSION, CITY 2\nCIVIL SERVICE, DEPARTMENT OF 16\nCIVILIAN COMPLAINT REVIEW BOARD 7\nCOLLECTIVE BARGAINING, OFFICE OF 3\nCOMMUNITY BOARDS 118\nCOMPTROLLER 124\nCOMPTROLLER, STATE, OFFICE OF THE 23\nCONFLICTS OF INTEREST BOARD 10\nCONSUMER AFFAIRS 3\nCONTRACT SERVICES, MAYOR'S OFFICE OF 1\nCORRECTION, BOARD OF 1\nCORRECTION, COMMISSION OF 1\nCORRECTION, DEPARTMENT OF 59\nCORRECTIONS & COMMUNITY SUPERVISION, DEPARTMENT OF 13\nCOUNTY CLERK 34\nCRIMINAL JUSTICE SERVICES, DIVISION OF 12\nCULTURAL AFFAIRS 56\nCYBER COMMAND, NYC 1\nDEPUTY CHIEF ADMINISTRATIVE JUDGE FOR THE NEW YORK CITY COURTS 2\nDESIGN AND CONSTRUCTION 76\nDISABILITIES, OFFICE FOR PEOPLE WITH DEVELOPMENTAL 4\nDISTRICT ATTORNEY 72\nDORMITORY AUTHORITY STATE OF NY 7\nECONOMIC DEVELOPMENT CORPORATION, NYC 11\nEDUCATION 108\nEDUCATION DEPARTMENT, NYS 41\nEDUCATION RETIREMENT SYSTEM, BOARD OF 1\nEDUCATIONAL CONSTRUCTION FUND 3\nELECTIONS, BOARD OF 28\nELECTIONS, BOARD OF, NYS 2\nEMERGENCY MANAGEMENT, NYC 29\nEMPIRE STATE DEVELOPMENT 12\nEMPLOYEE RELATIONS, GOVERNOR'S OFFICE OF 3\nEMPLOYEES RETIREMENT SYSTEM BOARD OF TRUSTEES, NYC 5\nENVIRONMENTAL COMMISSION, INTERSTATE 1\nENVIRONMENTAL CONSERVATION, DEPARTMENT OF 15\nENVIRONMENTAL PROTECTION 150\nEQUAL EMPLOYMENT PRACTICES COMMISSION 3\nFAMILY COURT OF THE STATE OF NEW YORK - CITY OF NEW YORK 14\nFINANCE 39\nFINANCIAL CONTROL BOARD, NYS 1\nFINANCIAL INFORMATION SERVICES AGENCY 7\nFINANCIAL SERVICES, DEPARTMENT OF 1\nFIRE DEPARTMENT 64\nFIRE MUSEUM, NYC 1\nGAMING COMMISSION, NYS 5\nGENERAL SERVICES, OFFICE OF 1\nGOVERNOR'S OFFICE 33\nGOVERNOR, LIEUTENANT 9\nGOVERNORS ISLAND, TRUST FOR 5\nGROWNYC 2\nHEALTH & MENTAL HYGIENE, DEPARTMENT OF 350\nHEALTH + HOSPITALS / BOARD OF DIRECTORS, NYC 2\nHEALTH + HOSPITALS NYC, (NYC H+H) 43\nHEALTH, DEPARTMENT OF 3\nHIGHER EDUCATION SERVICES CORPORATION, NYS 9\nHOMELAND SECURITY & EMERGENCY SERVICES, DIVISION OF 1\nHOMELESS SERVICES 72\nHOMES & COMMUNITY RENEWAL, NYS 11\nHOUSING AUTHORITY, NYC 131\nHOUSING DEVELOPMENT CORPORATION, NYC 16\nHOUSING PRESERVATION & DEVELOPMENT 67\nHUMAN RESOURCES ADMINISTRATION (HRA) DEPARTMENT OF SOCIAL SERVICES (DSS) 180\nHUMAN RIGHTS, COMMISSION ON 16\nHUMAN RIGHTS, NYS DIVISION OF 9\nINDEPENDENT BUDGET OFFICE, NYC 6\nINFORMATION TECHNOLOGY AND TELECOMMUNICATIONS 25\nINSPECTOR GENERAL, OFFICE OF THE NYS 1\nINVESTIGATION 48\nINVESTIGATION FOR THE NYC SCHOOL DISTRICT, SPECIAL COMMISSIONER OF 9\nJAVITS CENTER/NY CONVENTION CENTER OPERATING CORPORATION 14\nJOINT COMMISSION ON PUBLIC ETHICS, NYS 8\nJUDICIAL CONDUCT, NYS COMMISSION ON 3\nJUDICIAL CONFERENCE OF THE UNITED STATES 4\nJUSTICE CENTER FOR THE PROTECTION OF PEOPLE WITH SPECIAL NEEDS, NYS 2\nLABOR RELATIONS, OFFICE OF 4\nLABOR, DEPARTMENT OF 20\nLANDMARKS PRESERVATION COMMISSION 15\nLAW DEPARTMENT, OFFICE OF THE CORPORATION COUNSEL 111\nLAW EXAMINERS, NYS BOARD OF 2\nLEGISLATIVE BILL DRAFTING COMMISSION 1\nLEGISLATURE OF THE STATE OF NY 98\nLIQUIDATION BUREAU, NEW YORK 2\nLOWER MANHATTAN DEVELOPMENT CORPORATION 2\nMANAGEMENT & BUDGET, OFFICE OF 13\nMAYOR, OFFICE OF THE 68\nMEDIA ENTERTAINMENT, MAYOR'S OFFICE OF 4\nMEDICAL EXAMINER, OFFICE OF CHIEF, INSTITUTE OF FORENSIC SCIENCES 16\nMENTAL HEALTH, OFFICE OF 1\nMETROPOLITAN TRANSPORTATION AUTHORITY (MTA) 96\nMETROPOLITAN TRANSPORTATION AUTHORITY, INSPECTOR GENERAL, OFFICE OF THE 1\nMILITARY & NAVAL AFFAIRS, NYS DIVISION OF 12\nMOTOR VEHICLES, DEPARTMENT OF 9\nMUNICIPAL CREDIT UNION 1\nNEW YORK CITY COURTS 23\nNEW YORK METROPOLITAN TRANSPORTATION COUNCIL 7\nNEW YORK PUBLIC LIBRARY 21\nNEW YORK STATE COURT OF APPEALS 2\nNEW YORK STATE SUPREME COURT - ELEVENTH JUDICIAL DISTRICT (QUEENS COUNTY) 6\nNEW YORK STATE SUPREME COURT - FIRST JUDICIAL DISTRICT (NEW YORK COUNTY) 9\nNEW YORK STATE SUPREME COURT - SECOND JUDICIAL DISTRICT (KINGS COUNTY) 4\nNEW YORK STATE SUPREME COURT - THIRTEENTH JUDICIAL DISTRICT (RICHMOND COUNTY) 3\nNEW YORK STATE SUPREME COURT - TWELFTH JUDICIAL DISTRICT (BRONX COUNTY) 5\nNEW YORK STATE SUPREME COURT APPELLATE DIVISION - FIRST DEPARTMENT (NEW YORK AND BRONX COUNTY) 12\nNEW YORK STATE SUPREME COURT APPELLATE DIVISION - SECOND DEPARTMENT (INCLUDES KINGS, QUEENS AND RICHMOND COUNTIES ) 14\nNEW YORK STATE SUPREME COURT LIBRARIES (NEW YORK CITY) 3\nNEW YORK STATE SURROGATE'S COURT - BRONX COUNTY 2\nNEW YORK STATE SURROGATE'S COURT - KINGS COUNTY 6\nNEW YORK STATE SURROGATE'S COURT - NEW YORK COUNTY 4\nNEW YORK STATE SURROGATE'S COURT - QUEENS COUNTY 4\nNEW YORK STATE SURROGATE'S COURT - RICHMOND COUNTY 5\nNYC & COMPANY 6\nNYC FIRE PENSION FUND 2\nNYS COURT OF CLAIMS 1\nNYS UNIFIED COURT SYSTEM OFFICE OF COURT ADMINISTRATION 7\nOFFICE OF SPECIAL NARCOTICS 6\nPARKS, NYC 246\nPARKS, RECREATION & HISTORIC PRESERVATION, OFFICE OF 4\nPAYROLL ADMINISTRATION, OFFICE OF 8\nPOLICE CORRUPTION, COMMISSION TO COMBAT 1\nPOLICE DEPARTMENT 57\nPOLICE PENSION FUND 8\nPORT AUTHORITY OF NEW YORK & NEW JERSEY 33\nPOWER AUTHORITY, NEW YORK 1\nPROBATION 33\nPUBLIC ADMINISTRATOR 19\nPUBLIC ADVOCATE FOR THE CITY OF NEW YORK 7\nPUBLIC EMPLOYMENT RELATIONS BOARD 2\nQUEENS PUBLIC LIBRARY 1\nRECORDS & INFORMATION SERVICES 10\nRENT GUIDELINES BOARD 1\nROOSEVELT ISLAND OPERATING CORP. OF THE STATE OF NY 1\nSANITATION 119\nSCHOOL CONSTRUCTION AUTHORITY, NYC 15\nSMALL BUSINESS SERVICES 48\nSTANDARDS AND APPEALS, BOARD OF 4\nSTATE POLICE, DIVISION OF 6\nSTATE UNIVERSITY CONSTRUCTION FUND 1\nSTATE UNIVERSITY OF NEW YORK, (SUNY) 27\nSTATE, DEPARTMENT OF 18\nSUPREME COURT OF THE UNITED STATES 4\nTAX APPEALS TRIBUNAL, NYS 2\nTAX APPEALS, OFFICE OF ADMINISTRATIVE 8\nTAXATION & FINANCE, NYS DEPARTMENT OF 9\nTAXI & LIMOUSINE COMMISSION 32\nTEACHERS' RETIREMENT SYSTEM 14\nTEACHERS' RETIREMENT SYSTEM, NYS 1\nTEMPORARY & DISABILITY ASSISTANCE OFFICE OF 11\nTHRUWAY AUTHORITY, NYS 1\nTRANSITIONAL FINANCE AUTHORITY, NYC 9\nTRANSPORTATION 320\nTRANSPORTATION, DEPARTMENT OF 25\nU.S. COURT OF APPEALS FOR THE 2ND CIRCUIT 2\nU.S. COURT OF APPEALS FOR THE FEDERAL CIRCUIT 1\nU.S. COURT OF INTERNATIONAL TRADE 2\nU.S. DISTRICT COURT - EASTERN DISTRICT OF NEW YORK 4\nU.S. DISTRICT COURT - SOUTHERN DISTRICT OF NEW YORK 5\nUNIFORM STATE LAWS, COMMISSION ON 5\nUNITED NATIONS DEVELOPMENT CORPORATION 3\nVETERANS' SERVICES, DEPARTMENT OF 6\nVETERANS' SERVICES, NYS DIVISION OF 2\nVICTIM SERVICES, OFFICE OF 1\nWATER FINANCE AUTHORITY, NYC MUNICIPAL 9\nWATERFRONT COMMISSION OF NY HARBOR 2\nYOUTH AND COMMUNITY DEVELOPMENT 29\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=113",
              "$$hashKey": "object:3527"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639117671543_80737557",
      "id": "paragraph_1639117671543_80737557",
      "dateCreated": "2021-12-10T01:27:51-0500",
      "dateStarted": "2021-12-11T23:12:01-0500",
      "dateFinished": "2021-12-11T23:12:02-0500",
      "status": "FINISHED",
      "$$hashKey": "object:279"
    },
    {
      "text": "%spark.pyspark\nagency_name_d4 = dataset4.map(lambda x:  (clean_new(x[0]),1)).countByKey()\nfor key, value in agency_name_d4.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:12:03-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "AGENCY NAME 1\nACTUARY, OFFICE OF 6\nADDICTION SERVICES & SUPPORTS, OFFICE OF 14\nADMINISTRATIVE TRIALS AND HEARINGS, OFFICE OF 23\nAGING 21\nAGING, NYS OFFICE FOR THE 1\nAGRICULTURE & MARKETS, DEPARTMENT OF 8\nALCOHOLIC BEVERAGE CONTROL, DIVISION OF (STATE LIQUOR AUTHORITY) 4\nARTS, COUNCIL ON THE 3\nATTORNEY GENERAL, OFFICE OF 8\nBATTERY PARK CITY AUTHORITY 11\nBOROUGH HISTORIANS 5\nBOROUGH HISTORICAL SOCIETIES 10\nBOROUGH PRESIDENT - BRONX 23\nBOROUGH PRESIDENT - BROOKLYN 16\nBOROUGH PRESIDENT - MANHATTAN 9\nBOROUGH PRESIDENT - QUEENS 25\nBOROUGH PRESIDENT - STATEN ISLAND 12\nBROOKLYN BRIDGE PARK CORPORATION 6\nBROOKLYN NAVY YARD DEVELOPMENT CORPORATION 12\nBROOKLYN PUBLIC LIBRARY 4\nBUDGET, DIVISION OF THE 4\nBUILDINGS 37\nBUSINESS INTEGRITY COMMISSION 7\nCAMPAIGN FINANCE BOARD 18\nCHILDREN & FAMILY SERVICES, NYS OFFICE OF 19\nCHILDREN'S SERVICES, ADMINISTRATION FOR 143\nCITY CLERK & CLERK OF THE COUNCIL 21\nCITY COUNCIL 73\nCITY PLANNING 29\nCITY PLANNING COMMISSION 1\nCITY UNIVERSITY CONSTRUCTION FUND 4\nCITY UNIVERSITY OF NEW YORK 264\nCITY UNIVERSITY OF NEW YORK - BOARD OF TRUSTEES 2\nCITYWIDE ADMINISTRATIVE SERVICES 75\nCIVIL SERVICE COMMISSION, CITY 2\nCIVIL SERVICE, DEPARTMENT OF 16\nCIVILIAN COMPLAINT REVIEW BOARD 7\nCOLLECTIVE BARGAINING, OFFICE OF 3\nCOMMUNITY BOARDS 118\nCOMPTROLLER 124\nCOMPTROLLER, STATE, OFFICE OF THE 23\nCONFLICTS OF INTEREST BOARD 10\nCONSUMER AFFAIRS 3\nCONTRACT SERVICES, MAYOR'S OFFICE OF 1\nCORRECTION, BOARD OF 1\nCORRECTION, COMMISSION OF 1\nCORRECTION, DEPARTMENT OF 59\nCORRECTIONS & COMMUNITY SUPERVISION, DEPARTMENT OF 13\nCOUNTY CLERK 34\nCRIMINAL JUSTICE SERVICES, DIVISION OF 12\nCULTURAL AFFAIRS 56\nCYBER COMMAND, NYC 1\nDEPUTY CHIEF ADMINISTRATIVE JUDGE FOR THE NEW YORK CITY COURTS 2\nDESIGN AND CONSTRUCTION 76\nDISABILITIES, OFFICE FOR PEOPLE WITH DEVELOPMENTAL 4\nDISTRICT ATTORNEY 72\nDORMITORY AUTHORITY STATE OF NY 7\nECONOMIC DEVELOPMENT CORPORATION, NYC 11\nEDUCATION 108\nEDUCATION DEPARTMENT, NYS 41\nEDUCATION RETIREMENT SYSTEM, BOARD OF 1\nEDUCATIONAL CONSTRUCTION FUND 3\nELECTIONS, BOARD OF 28\nELECTIONS, BOARD OF, NYS 2\nEMERGENCY MANAGEMENT, NYC 29\nEMPIRE STATE DEVELOPMENT 12\nEMPLOYEE RELATIONS, GOVERNOR'S OFFICE OF 3\nEMPLOYEES RETIREMENT SYSTEM BOARD OF TRUSTEES, NYC 5\nENVIRONMENTAL COMMISSION, INTERSTATE 1\nENVIRONMENTAL CONSERVATION, DEPARTMENT OF 15\nENVIRONMENTAL PROTECTION 150\nEQUAL EMPLOYMENT PRACTICES COMMISSION 3\nFAMILY COURT OF THE STATE OF NEW YORK - CITY OF NEW YORK 14\nFINANCE 39\nFINANCIAL CONTROL BOARD, NYS 1\nFINANCIAL INFORMATION SERVICES AGENCY 7\nFINANCIAL SERVICES, DEPARTMENT OF 1\nFIRE DEPARTMENT 64\nFIRE MUSEUM, NYC 1\nGAMING COMMISSION, NYS 5\nGENERAL SERVICES, OFFICE OF 1\nGOVERNOR'S OFFICE 33\nGOVERNOR, LIEUTENANT 9\nGOVERNORS ISLAND, TRUST FOR 5\nGROWNYC 2\nHEALTH & MENTAL HYGIENE, DEPARTMENT OF 350\nHEALTH + HOSPITALS / BOARD OF DIRECTORS, NYC 2\nHEALTH + HOSPITALS NYC, (NYC H+H) 43\nHEALTH, DEPARTMENT OF 3\nHIGHER EDUCATION SERVICES CORPORATION, NYS 9\nHOMELAND SECURITY & EMERGENCY SERVICES, DIVISION OF 1\nHOMELESS SERVICES 72\nHOMES & COMMUNITY RENEWAL, NYS 11\nHOUSING AUTHORITY, NYC 131\nHOUSING DEVELOPMENT CORPORATION, NYC 16\nHOUSING PRESERVATION & DEVELOPMENT 67\nHUMAN RESOURCES ADMINISTRATION (HRA) DEPARTMENT OF SOCIAL SERVICES (DSS) 180\nHUMAN RIGHTS, COMMISSION ON 16\nHUMAN RIGHTS, NYS DIVISION OF 9\nINDEPENDENT BUDGET OFFICE, NYC 6\nINFORMATION TECHNOLOGY AND TELECOMMUNICATIONS 25\nINSPECTOR GENERAL, OFFICE OF THE NYS 1\nINVESTIGATION 48\nINVESTIGATION FOR THE NYC SCHOOL DISTRICT, SPECIAL COMMISSIONER OF 9\nJAVITS CENTER/NY CONVENTION CENTER OPERATING CORPORATION 14\nJOINT COMMISSION ON PUBLIC ETHICS, NYS 8\nJUDICIAL CONDUCT, NYS COMMISSION ON 3\nJUDICIAL CONFERENCE OF THE UNITED STATES 4\nJUSTICE CENTER FOR THE PROTECTION OF PEOPLE WITH SPECIAL NEEDS, NYS 2\nLABOR RELATIONS, OFFICE OF 4\nLABOR, DEPARTMENT OF 20\nLANDMARKS PRESERVATION COMMISSION 15\nLAW DEPARTMENT, OFFICE OF THE CORPORATION COUNSEL 111\nLAW EXAMINERS, NYS BOARD OF 2\nLEGISLATIVE BILL DRAFTING COMMISSION 1\nLEGISLATURE OF THE STATE OF NY 98\nLIQUIDATION BUREAU, NEW YORK 2\nLOWER MANHATTAN DEVELOPMENT CORPORATION 2\nMANAGEMENT & BUDGET, OFFICE OF 13\nMAYOR, OFFICE OF THE 68\nMEDIA ENTERTAINMENT, MAYOR'S OFFICE OF 4\nMEDICAL EXAMINER, OFFICE OF CHIEF, INSTITUTE OF FORENSIC SCIENCES 16\nMENTAL HEALTH, OFFICE OF 1\nMETROPOLITAN TRANSPORTATION AUTHORITY (MTA) 96\nMETROPOLITAN TRANSPORTATION AUTHORITY, INSPECTOR GENERAL, OFFICE OF THE 1\nMILITARY & NAVAL AFFAIRS, NYS DIVISION OF 12\nMOTOR VEHICLES, DEPARTMENT OF 9\nMUNICIPAL CREDIT UNION 1\nNEW YORK CITY COURTS 23\nNEW YORK METROPOLITAN TRANSPORTATION COUNCIL 7\nNEW YORK PUBLIC LIBRARY 21\nNEW YORK STATE COURT OF APPEALS 2\nNEW YORK STATE SUPREME COURT - ELEVENTH JUDICIAL DISTRICT (QUEENS COUNTY) 6\nNEW YORK STATE SUPREME COURT - FIRST JUDICIAL DISTRICT (NEW YORK COUNTY) 9\nNEW YORK STATE SUPREME COURT - SECOND JUDICIAL DISTRICT (KINGS COUNTY) 4\nNEW YORK STATE SUPREME COURT - THIRTEENTH JUDICIAL DISTRICT (RICHMOND COUNTY) 3\nNEW YORK STATE SUPREME COURT - TWELFTH JUDICIAL DISTRICT (BRONX COUNTY) 5\nNEW YORK STATE SUPREME COURT APPELLATE DIVISION - FIRST DEPARTMENT (NEW YORK AND BRONX COUNTY) 12\nNEW YORK STATE SUPREME COURT APPELLATE DIVISION - SECOND DEPARTMENT (INCLUDES KINGS, QUEENS AND RICHMOND COUNTIES ) 14\nNEW YORK STATE SUPREME COURT LIBRARIES (NEW YORK CITY) 3\nNEW YORK STATE SURROGATE'S COURT - BRONX COUNTY 2\nNEW YORK STATE SURROGATE'S COURT - KINGS COUNTY 6\nNEW YORK STATE SURROGATE'S COURT - NEW YORK COUNTY 4\nNEW YORK STATE SURROGATE'S COURT - QUEENS COUNTY 4\nNEW YORK STATE SURROGATE'S COURT - RICHMOND COUNTY 5\nNYC & COMPANY 6\nNYC FIRE PENSION FUND 2\nNYS COURT OF CLAIMS 1\nNYS UNIFIED COURT SYSTEM OFFICE OF COURT ADMINISTRATION 7\nOFFICE OF SPECIAL NARCOTICS 6\nPARKS, NYC 246\nPARKS, RECREATION & HISTORIC PRESERVATION, OFFICE OF 4\nPAYROLL ADMINISTRATION, OFFICE OF 8\nPOLICE CORRUPTION, COMMISSION TO COMBAT 1\nPOLICE DEPARTMENT 57\nPOLICE PENSION FUND 8\nPORT AUTHORITY OF NEW YORK & NEW JERSEY 33\nPOWER AUTHORITY, NEW YORK 1\nPROBATION 33\nPUBLIC ADMINISTRATOR 19\nPUBLIC ADVOCATE FOR THE CITY OF NEW YORK 7\nPUBLIC EMPLOYMENT RELATIONS BOARD 2\nQUEENS PUBLIC LIBRARY 1\nRECORDS & INFORMATION SERVICES 10\nRENT GUIDELINES BOARD 1\nROOSEVELT ISLAND OPERATING CORP. OF THE STATE OF NY 1\nSANITATION 119\nSCHOOL CONSTRUCTION AUTHORITY, NYC 15\nSMALL BUSINESS SERVICES 48\nSTANDARDS AND APPEALS, BOARD OF 4\nSTATE POLICE, DIVISION OF 6\nSTATE UNIVERSITY CONSTRUCTION FUND 1\nSTATE UNIVERSITY OF NEW YORK, (SUNY) 27\nSTATE, DEPARTMENT OF 18\nSUPREME COURT OF THE UNITED STATES 4\nTAX APPEALS TRIBUNAL, NYS 2\nTAX APPEALS, OFFICE OF ADMINISTRATIVE 8\nTAXATION & FINANCE, NYS DEPARTMENT OF 9\nTAXI & LIMOUSINE COMMISSION 32\nTEACHERS' RETIREMENT SYSTEM 14\nTEACHERS' RETIREMENT SYSTEM, NYS 1\nTEMPORARY & DISABILITY ASSISTANCE OFFICE OF 11\nTHRUWAY AUTHORITY, NYS 1\nTRANSITIONAL FINANCE AUTHORITY, NYC 9\nTRANSPORTATION 320\nTRANSPORTATION, DEPARTMENT OF 25\nU.S. COURT OF APPEALS FOR THE 2ND CIRCUIT 2\nU.S. COURT OF APPEALS FOR THE FEDERAL CIRCUIT 1\nU.S. COURT OF INTERNATIONAL TRADE 2\nU.S. DISTRICT COURT - EASTERN DISTRICT OF NEW YORK 4\nU.S. DISTRICT COURT - SOUTHERN DISTRICT OF NEW YORK 5\nUNIFORM STATE LAWS, COMMISSION ON 5\nUNITED NATIONS DEVELOPMENT CORPORATION 3\nVETERANS' SERVICES, DEPARTMENT OF 6\nVETERANS' SERVICES, NYS DIVISION OF 2\nVICTIM SERVICES, OFFICE OF 1\nWATER FINANCE AUTHORITY, NYC MUNICIPAL 9\nWATERFRONT COMMISSION OF NY HARBOR 2\nYOUTH AND COMMUNITY DEVELOPMENT 29\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=114",
              "$$hashKey": "object:3573"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639111622746_804086953",
      "id": "paragraph_1639111622746_804086953",
      "dateCreated": "2021-12-09T23:47:02-0500",
      "dateStarted": "2021-12-11T23:12:03-0500",
      "dateFinished": "2021-12-11T23:12:03-0500",
      "status": "FINISHED",
      "$$hashKey": "object:280"
    },
    {
      "text": "%spark.pyspark\n#count the precision for original clean and clean_new\n#we use the recall to check the percentage of the darty data and the numbers of the data we clean\n#in this case arr_new is just the same as arr_pres\narr_origin = []\narr_old = []\narr_new = []\narr_pres = []\nfor key, value in agency_name4.items():\n    arr_origin.append(key)\nfor key, value in agency_name_old4.items():\n    arr_old.append(key)\nfor key, value in agency_name_d4.items():\n    arr_new.append(key)\nfor key, value in agency_name_d4.items():\n    arr_pres.append(key)\n    \nclean_recall = len(set(arr_old).difference(set(arr_origin))) / (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres))))\nclean_new_recall =  len(set(arr_new).difference(set(arr_origin))) / (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres))))\n\nprint(\"clean_recall:\")\nprint(clean_recall)\nprint(\"clean_new_recall:\")\nprint(clean_new_recall)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:12:05-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "clean_recall:\n1.0\nclean_new_recall:\n1.0\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639117600767_823251863",
      "id": "paragraph_1639117600767_823251863",
      "dateCreated": "2021-12-10T01:26:40-0500",
      "dateStarted": "2021-12-11T23:12:05-0500",
      "dateFinished": "2021-12-11T23:12:05-0500",
      "status": "FINISHED",
      "$$hashKey": "object:281"
    },
    {
      "text": "%spark.pyspark\n###dataset5 test for Agency Name",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:12:07-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639111701492_1454729610",
      "id": "paragraph_1639111701492_1454729610",
      "dateCreated": "2021-12-09T23:48:21-0500",
      "dateStarted": "2021-12-11T23:12:07-0500",
      "dateFinished": "2021-12-11T23:12:07-0500",
      "status": "FINISHED",
      "$$hashKey": "object:282"
    },
    {
      "text": "%spark.pyspark\nagency_name5 = dataset5.map(lambda x: (x[2],1)).countByKey()\nfor key, value in agency_name5.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:12:08-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Agency Name 1\nOFFICE OF EMERGENCY MANAGEMENT 1411\nOFFICE OF MANAGEMENT & BUDGET 3281\nPERSONNEL MONITORS 7969\nTAX COMMISSION 424\nLAW DEPARTMENT 14321\nDEPARTMENT OF CITY PLANNING 2671\nDEPARTMENT OF INVESTIGATION 2588\nTEACHERS RETIREMENT SYSTEM 2974\nCIVILIAN COMPLAINT REVIEW BD 1698\nPOLICE DEPARTMENT 367745\nBOARD OF ELECTION POLL WORKERS 235235\nFIRE DEPARTMENT 128819\nNYC DEPT OF VETERANS' SERVICES 179\nADMIN FOR CHILDREN'S SVCS 53268\nHRA/DEPT OF SOCIAL SERVICES 104331\nDEPT. OF HOMELESS SERVICES 19429\nDEPARTMENT OF CORRECTION 91843\nBOARD OF CORRECTION 171\nMAYORS OFFICE OF CONTRACT SVCS 719\nPUBLIC ADVOCATE 562\nCITY COUNCIL 7085\nCITY CLERK 611\nDEPARTMENT FOR THE AGING 8366\nCULTURAL AFFAIRS 536\nFINANCIAL INFO SVCS AGENCY 3294\nDEPARTMENT OF JUVENILE JUSTICE 88\nOFF OF PAYROLL ADMINISTRATION 1232\nINDEPENDENT BUDGET OFFICE 291\nEQUAL EMPLOY PRACTICES COMM 93\nCIVIL SERVICE COMMISSION 91\nLANDMARKS PRESERVATION COMM 617\nTAXI & LIMOUSINE COMMISSION 5435\nMUNICIPAL WATER FIN AUTHORITY 102\nDOE CUSTODIAL PAYROL 8065\nPUBLIC SERVICE CORPS 2321\nOFFICE OF LABOR RELATIONS 1020\nHUMAN RIGHTS COMMISSION 937\nNYC POLICE PENSION FUND 1240\nNYC FIRE PENSION FUND 108\nDEPT OF YOUTH & COMM DEV SRVS 4327\nOFFICE OF THE MAYOR 4981\nBOARD OF ELECTION 7364\nCAMPAIGN FINANCE BOARD 946\nOFFICE OF THE ACTUARY 302\nNYC EMPLOYEES RETIREMENT SYS 3505\nPRESIDENT BOROUGH OF MANHATTAN 511\nBOROUGH PRESIDENT-BRONX 435\nBOROUGH PRESIDENT-BROOKLYN 562\nBOROUGH PRESIDENT-QUEENS 489\nBOROUGH PRESIDENT-STATEN IS 375\nOFFICE OF THE COMPTROLLER 6681\nDEPARTMENT OF EDUCATION ADMIN 110936\nDEPT OF ED PEDAGOGICAL 758360\nCONFLICTS OF INTEREST BOARD 196\nOFFICE OF COLLECTIVE BARGAININ 133\nMANHATTAN COMMUNITY BOARD #1 30\nMANHATTAN COMMUNITY BOARD #2 32\nMANHATTAN COMMUNITY BOARD #3 31\nMANHATTAN COMMUNITY BOARD #4 24\nMANHATTAN COMMUNITY BOARD #5 28\nMANHATTAN COMMUNITY BOARD #6 27\nMANHATTAN COMMUNITY BOARD #7 21\nMANHATTAN COMMUNITY BOARD #8 38\nMANHATTAN COMMUNITY BOARD #9 21\nMANHATTAN COMMUNITY BOARD #10 28\nMANHATTAN COMMUNITY BOARD #11 25\nMANHATTAN COMMUNITY BOARD #12 23\nBRONX COMMUNITY BOARD #1 15\nBRONX COMMUNITY BOARD #2 23\nBRONX COMMUNITY BOARD #3 14\nBRONX COMMUNITY BOARD #4 22\nBRONX COMMUNITY BOARD #5 21\nBRONX COMMUNITY BOARD #6 21\nBRONX COMMUNITY BOARD #7 24\nBRONX COMMUNITY BOARD #8 26\nBRONX COMMUNITY BOARD #9 28\nBRONX COMMUNITY BOARD #10 42\nBRONX COMMUNITY BOARD #11 31\nBRONX COMMUNITY BOARD #12 20\nQUEENS COMMUNITY BOARD #1 31\nQUEENS COMMUNITY BOARD #2 28\nQUEENS COMMUNITY BOARD #3 30\nQUEENS COMMUNITY BOARD #4 22\nQUEENS COMMUNITY BOARD #5 28\nQUEENS COMMUNITY BOARD #6 29\nQUEENS COMMUNITY BOARD #7 32\nQUEENS COMMUNITY BOARD #8 36\nQUEENS COMMUNITY BOARD #9 28\nQUEENS COMMUNITY BOARD #10 29\nQUEENS COMMUNITY BOARD #11 23\nQUEENS COMMUNITY BOARD #12 28\nQUEENS COMMUNITY BOARD #13 22\nQUEENS COMMUNITY BOARD #14 25\nGUTTMAN COMMUNITY COLLEGE 4120\nCOMMUNITY COLLEGE (BRONX) 23312\nCOMMUNITY COLLEGE (QUEENSBORO) 26474\nCOMMUNITY COLLEGE (KINGSBORO) 31582\nCOMMUNITY COLLEGE (MANHATTAN) 41594\nCUNY CENTRAL OFFICE 365\nCOMMUNITY COLLEGE (HOSTOS) 15002\nCOMMUNITY COLLEGE (LAGUARDIA) 32068\nHUNTER COLLEGE HIGH SCHOOL 2617\nBROOKLYN COMMUNITY BOARD #1 22\nBROOKLYN COMMUNITY BOARD #2 27\nBROOKLYN COMMUNITY BOARD #3 21\nBROOKLYN COMMUNITY BOARD #4 24\nBROOKLYN COMMUNITY BOARD #5 30\nBROOKLYN COMMUNITY BOARD #6 24\nBROOKLYN COMMUNITY BOARD #7 22\nBROOKLYN COMMUNITY BOARD #8 22\nBROOKLYN COMMUNITY BOARD #9 20\nBROOKLYN COMMUNITY BOARD #10 30\nBROOKLYN COMMUNITY BOARD #11 24\nBROOKLYN COMMUNITY BOARD #12 23\nBROOKLYN COMMUNITY BOARD #13 28\nBROOKLYN COMMUNITY BOARD #14 21\nBROOKLYN COMMUNITY BOARD #15 24\nBROOKLYN COMMUNITY BOARD #16 22\nBROOKLYN COMMUNITY BOARD #17 28\nBROOKLYN COMMUNITY BOARD #18 22\nSTATEN ISLAND COMMUNITY BD #1 23\nSTATEN ISLAND COMMUNITY BD #2 29\nSTATEN ISLAND COMMUNITY BD #3 22\nDEPT OF ED HRLY SUPPORT STAFF 164165\nDEPT OF ED PER DIEM TEACHERS 90784\nDEPT OF ED PER SESSION TEACHER 608565\nDEPT OF ED PARA PROFESSIONALS 245259\nDEPARTMENT OF PROBATION 8385\nDEPARTMENT OF BUSINESS SERV. 2631\nHOUSING PRESERVATION & DVLPMNT 18158\nDEPARTMENT OF BUILDINGS 12031\nDEPT OF HEALTH/MENTAL HYGIENE 54291\nADMIN TRIALS AND HEARINGS 4967\nDEPT OF ENVIRONMENT PROTECTION 48751\nDEPARTMENT OF SANITATION 92755\nBUSINESS INTEGRITY COMMISSION 672\nDEPARTMENT OF FINANCE 16186\nDEPARTMENT OF TRANSPORTATION 42801\nDEPT OF PARKS & RECREATION 117212\nDEPT. OF DESIGN & CONSTRUCTION 10999\nDEPT OF INFO TECH & TELECOMM 12170\nDEPT OF RECORDS & INFO SERVICE 563\nCONSUMER AFFAIRS 3333\nDEPT OF CITYWIDE ADMIN SVCS 18885\nDISTRICT ATTORNEY-MANHATTAN 11405\nBRONX DISTRICT ATTORNEY 7237\nDISTRICT ATTORNEY KINGS COUNTY 7895\nDISTRICT ATTORNEY QNS COUNTY 4682\nDISTRICT ATTORNEY RICHMOND COU 1004\nDISTRICT ATTORNEY-SPECIAL NARC 1606\nPUBLIC ADMINISTRATOR-NEW YORK 80\nPUBLIC ADMINISTRATOR-BRONX 63\nPUBLIC ADMINISTRATOR-KINGS 105\nPUBLIC ADMINISTRATOR-QUEENS 60\nPUBLIC ADMINISTRATOR-RICHMOND 40\nNYC HOUSING AUTHORITY 95132\nBOARD OF CORRECTIONS 17\nDISTRICTING COMMISSION 3\nPolice Department 55619\nBronx DA 935\nQueens DA 660\nSpec Narcs-DA 251\nRichmond DA 112\nManhattan DA 1622\nKings DA 1278\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=115",
              "$$hashKey": "object:3699"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639111714460_753005661",
      "id": "paragraph_1639111714460_753005661",
      "dateCreated": "2021-12-09T23:48:34-0500",
      "dateStarted": "2021-12-11T23:12:08-0500",
      "dateFinished": "2021-12-11T23:12:16-0500",
      "status": "FINISHED",
      "$$hashKey": "object:283"
    },
    {
      "text": "%spark.pyspark\nagency_name_old5 = dataset5.map(lambda x:  (clean(x[2]),1)).countByKey()\nfor key, value in agency_name_d5.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:12:11-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "AGENCY NAME 1\nOFFICE OF EMERGENCY MANAGEMENT 1411\nOFFICE OF MANAGEMENT & BUDGET 3281\nPERSONNEL MONITORS 7969\nTAX COMMISSION 424\nLAW DEPARTMENT 14321\nDEPARTMENT OF CITY PLANNING 2671\nDEPARTMENT OF INVESTIGATION 2588\nTEACHERS RETIREMENT SYSTEM 2974\nCIVILIAN COMPLAINT REVIEW BD 1698\nPOLICE DEPARTMENT 423364\nBOARD OF ELECTION POLL WORKERS 235235\nFIRE DEPARTMENT 128819\nNYC DEPT OF VETERANS' SERVICES 179\nADMIN FOR CHILDREN'S SVCS 53268\nHRA/DEPT OF SOCIAL SERVICES 104331\nDEPT. OF HOMELESS SERVICES 19429\nDEPARTMENT OF CORRECTION 91843\nBOARD OF CORRECTION 171\nMAYORS OFFICE OF CONTRACT SVCS 719\nPUBLIC ADVOCATE 562\nCITY COUNCIL 7085\nCITY CLERK 611\nDEPARTMENT FOR THE AGING 8366\nCULTURAL AFFAIRS 536\nFINANCIAL INFO SVCS AGENCY 3294\nDEPARTMENT OF JUVENILE JUSTICE 88\nOFF OF PAYROLL ADMINISTRATION 1232\nINDEPENDENT BUDGET OFFICE 291\nEQUAL EMPLOY PRACTICES COMM 93\nCIVIL SERVICE COMMISSION 91\nLANDMARKS PRESERVATION COMM 617\nTAXI & LIMOUSINE COMMISSION 5435\nMUNICIPAL WATER FIN AUTHORITY 102\nDOE CUSTODIAL PAYROL 8065\nPUBLIC SERVICE CORPS 2321\nOFFICE OF LABOR RELATIONS 1020\nHUMAN RIGHTS COMMISSION 937\nNYC POLICE PENSION FUND 1240\nNYC FIRE PENSION FUND 108\nDEPT OF YOUTH & COMM DEV SRVS 4327\nOFFICE OF THE MAYOR 4981\nBOARD OF ELECTION 7364\nCAMPAIGN FINANCE BOARD 946\nOFFICE OF THE ACTUARY 302\nNYC EMPLOYEES RETIREMENT SYS 3505\nPRESIDENT BOROUGH OF MANHATTAN 511\nBOROUGH PRESIDENT-BRONX 435\nBOROUGH PRESIDENT-BROOKLYN 562\nBOROUGH PRESIDENT-QUEENS 489\nBOROUGH PRESIDENT-STATEN IS 375\nOFFICE OF THE COMPTROLLER 6681\nDEPARTMENT OF EDUCATION ADMIN 110936\nDEPT OF ED PEDAGOGICAL 758360\nCONFLICTS OF INTEREST BOARD 196\nOFFICE OF COLLECTIVE BARGAININ 133\nMANHATTAN COMMUNITY BOARD #1 30\nMANHATTAN COMMUNITY BOARD #2 32\nMANHATTAN COMMUNITY BOARD #3 31\nMANHATTAN COMMUNITY BOARD #4 24\nMANHATTAN COMMUNITY BOARD #5 28\nMANHATTAN COMMUNITY BOARD #6 27\nMANHATTAN COMMUNITY BOARD #7 21\nMANHATTAN COMMUNITY BOARD #8 38\nMANHATTAN COMMUNITY BOARD #9 21\nMANHATTAN COMMUNITY BOARD #10 28\nMANHATTAN COMMUNITY BOARD #11 25\nMANHATTAN COMMUNITY BOARD #12 23\nBRONX COMMUNITY BOARD #1 15\nBRONX COMMUNITY BOARD #2 23\nBRONX COMMUNITY BOARD #3 14\nBRONX COMMUNITY BOARD #4 22\nBRONX COMMUNITY BOARD #5 21\nBRONX COMMUNITY BOARD #6 21\nBRONX COMMUNITY BOARD #7 24\nBRONX COMMUNITY BOARD #8 26\nBRONX COMMUNITY BOARD #9 28\nBRONX COMMUNITY BOARD #10 42\nBRONX COMMUNITY BOARD #11 31\nBRONX COMMUNITY BOARD #12 20\nQUEENS COMMUNITY BOARD #1 31\nQUEENS COMMUNITY BOARD #2 28\nQUEENS COMMUNITY BOARD #3 30\nQUEENS COMMUNITY BOARD #4 22\nQUEENS COMMUNITY BOARD #5 28\nQUEENS COMMUNITY BOARD #6 29\nQUEENS COMMUNITY BOARD #7 32\nQUEENS COMMUNITY BOARD #8 36\nQUEENS COMMUNITY BOARD #9 28\nQUEENS COMMUNITY BOARD #10 29\nQUEENS COMMUNITY BOARD #11 23\nQUEENS COMMUNITY BOARD #12 28\nQUEENS COMMUNITY BOARD #13 22\nQUEENS COMMUNITY BOARD #14 25\nGUTTMAN COMMUNITY COLLEGE 4120\nCOMMUNITY COLLEGE (BRONX) 23312\nCOMMUNITY COLLEGE (QUEENSBORO) 26474\nCOMMUNITY COLLEGE (KINGSBORO) 31582\nCOMMUNITY COLLEGE (MANHATTAN) 41594\nCUNY CENTRAL OFFICE 365\nCOMMUNITY COLLEGE (HOSTOS) 15002\nCOMMUNITY COLLEGE (LAGUARDIA) 32068\nHUNTER COLLEGE HIGH SCHOOL 2617\nBROOKLYN COMMUNITY BOARD #1 22\nBROOKLYN COMMUNITY BOARD #2 27\nBROOKLYN COMMUNITY BOARD #3 21\nBROOKLYN COMMUNITY BOARD #4 24\nBROOKLYN COMMUNITY BOARD #5 30\nBROOKLYN COMMUNITY BOARD #6 24\nBROOKLYN COMMUNITY BOARD #7 22\nBROOKLYN COMMUNITY BOARD #8 22\nBROOKLYN COMMUNITY BOARD #9 20\nBROOKLYN COMMUNITY BOARD #10 30\nBROOKLYN COMMUNITY BOARD #11 24\nBROOKLYN COMMUNITY BOARD #12 23\nBROOKLYN COMMUNITY BOARD #13 28\nBROOKLYN COMMUNITY BOARD #14 21\nBROOKLYN COMMUNITY BOARD #15 24\nBROOKLYN COMMUNITY BOARD #16 22\nBROOKLYN COMMUNITY BOARD #17 28\nBROOKLYN COMMUNITY BOARD #18 22\nSTATEN ISLAND COMMUNITY BD #1 23\nSTATEN ISLAND COMMUNITY BD #2 29\nSTATEN ISLAND COMMUNITY BD #3 22\nDEPT OF ED HRLY SUPPORT STAFF 164165\nDEPT OF ED PER DIEM TEACHERS 90784\nDEPT OF ED PER SESSION TEACHER 608565\nDEPT OF ED PARA PROFESSIONALS 245259\nDEPARTMENT OF PROBATION 8385\nDEPARTMENT OF BUSINESS SERV. 2631\nHOUSING PRESERVATION & DVLPMNT 18158\nDEPARTMENT OF BUILDINGS 12031\nDEPT OF HEALTH/MENTAL HYGIENE 54291\nADMIN TRIALS AND HEARINGS 4967\nDEPT OF ENVIRONMENT PROTECTION 48751\nDEPARTMENT OF SANITATION 92755\nBUSINESS INTEGRITY COMMISSION 672\nDEPARTMENT OF FINANCE 16186\nDEPARTMENT OF TRANSPORTATION 42801\nDEPT OF PARKS & RECREATION 117212\nDEPT. OF DESIGN & CONSTRUCTION 10999\nDEPT OF INFO TECH & TELECOMM 12170\nDEPT OF RECORDS & INFO SERVICE 563\nCONSUMER AFFAIRS 3333\nDEPT OF CITYWIDE ADMIN SVCS 18885\nDISTRICT ATTORNEY-MANHATTAN 11405\nBRONX DISTRICT ATTORNEY 7237\nDISTRICT ATTORNEY KINGS COUNTY 7895\nDISTRICT ATTORNEY QNS COUNTY 4682\nDISTRICT ATTORNEY RICHMOND COU 1004\nDISTRICT ATTORNEY-SPECIAL NARC 1606\nPUBLIC ADMINISTRATOR-NEW YORK 80\nPUBLIC ADMINISTRATOR-BRONX 63\nPUBLIC ADMINISTRATOR-KINGS 105\nPUBLIC ADMINISTRATOR-QUEENS 60\nPUBLIC ADMINISTRATOR-RICHMOND 40\nNYC HOUSING AUTHORITY 95132\nBOARD OF CORRECTIONS 17\nDISTRICTING COMMISSION 3\nBRONX DA 935\nQUEENS DA 660\nSPEC NARCS-DA 251\nRICHMOND DA 112\nMANHATTAN DA 1622\nKINGS DA 1278\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=116",
              "$$hashKey": "object:3745"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639118368038_558569539",
      "id": "paragraph_1639118368038_558569539",
      "dateCreated": "2021-12-10T01:39:28-0500",
      "dateStarted": "2021-12-11T23:12:11-0500",
      "dateFinished": "2021-12-11T23:12:24-0500",
      "status": "FINISHED",
      "$$hashKey": "object:284"
    },
    {
      "text": "%spark.pyspark\nagency_name_d5 = dataset5.map(lambda x:  (clean_new(x[2]),1)).countByKey()\nfor key, value in agency_name_d5.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:12:13-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "AGENCY NAME 1\nOFFICE OF EMERGENCY MANAGEMENT 1411\nOFFICE OF MANAGEMENT & BUDGET 3281\nPERSONNEL MONITORS 7969\nTAX COMMISSION 424\nLAW DEPARTMENT 14321\nDEPARTMENT OF CITY PLANNING 2671\nDEPARTMENT OF INVESTIGATION 2588\nTEACHERS RETIREMENT SYSTEM 2974\nCIVILIAN COMPLAINT REVIEW BD 1698\nPOLICE DEPARTMENT 423364\nBOARD OF ELECTION POLL WORKERS 235235\nFIRE DEPARTMENT 128819\nNYC DEPT OF VETERANS' SERVICES 179\nADMIN FOR CHILDREN'S SVCS 53268\nHRA/DEPT OF SOCIAL SERVICES 104331\nDEPT. OF HOMELESS SERVICES 19429\nDEPARTMENT OF CORRECTION 91843\nBOARD OF CORRECTION 171\nMAYORS OFFICE OF CONTRACT SVCS 719\nPUBLIC ADVOCATE 562\nCITY COUNCIL 7085\nCITY CLERK 611\nDEPARTMENT FOR THE AGING 8366\nCULTURAL AFFAIRS 536\nFINANCIAL INFO SVCS AGENCY 3294\nDEPARTMENT OF JUVENILE JUSTICE 88\nOFF OF PAYROLL ADMINISTRATION 1232\nINDEPENDENT BUDGET OFFICE 291\nEQUAL EMPLOY PRACTICES COMM 93\nCIVIL SERVICE COMMISSION 91\nLANDMARKS PRESERVATION COMM 617\nTAXI & LIMOUSINE COMMISSION 5435\nMUNICIPAL WATER FIN AUTHORITY 102\nDOE CUSTODIAL PAYROL 8065\nPUBLIC SERVICE CORPS 2321\nOFFICE OF LABOR RELATIONS 1020\nHUMAN RIGHTS COMMISSION 937\nNYC POLICE PENSION FUND 1240\nNYC FIRE PENSION FUND 108\nDEPT OF YOUTH & COMM DEV SRVS 4327\nOFFICE OF THE MAYOR 4981\nBOARD OF ELECTION 7364\nCAMPAIGN FINANCE BOARD 946\nOFFICE OF THE ACTUARY 302\nNYC EMPLOYEES RETIREMENT SYS 3505\nPRESIDENT BOROUGH OF MANHATTAN 511\nBOROUGH PRESIDENT-BRONX 435\nBOROUGH PRESIDENT-BROOKLYN 562\nBOROUGH PRESIDENT-QUEENS 489\nBOROUGH PRESIDENT-STATEN IS 375\nOFFICE OF THE COMPTROLLER 6681\nDEPARTMENT OF EDUCATION ADMIN 110936\nDEPT OF ED PEDAGOGICAL 758360\nCONFLICTS OF INTEREST BOARD 196\nOFFICE OF COLLECTIVE BARGAININ 133\nMANHATTAN COMMUNITY BOARD #1 30\nMANHATTAN COMMUNITY BOARD #2 32\nMANHATTAN COMMUNITY BOARD #3 31\nMANHATTAN COMMUNITY BOARD #4 24\nMANHATTAN COMMUNITY BOARD #5 28\nMANHATTAN COMMUNITY BOARD #6 27\nMANHATTAN COMMUNITY BOARD #7 21\nMANHATTAN COMMUNITY BOARD #8 38\nMANHATTAN COMMUNITY BOARD #9 21\nMANHATTAN COMMUNITY BOARD #10 28\nMANHATTAN COMMUNITY BOARD #11 25\nMANHATTAN COMMUNITY BOARD #12 23\nBRONX COMMUNITY BOARD #1 15\nBRONX COMMUNITY BOARD #2 23\nBRONX COMMUNITY BOARD #3 14\nBRONX COMMUNITY BOARD #4 22\nBRONX COMMUNITY BOARD #5 21\nBRONX COMMUNITY BOARD #6 21\nBRONX COMMUNITY BOARD #7 24\nBRONX COMMUNITY BOARD #8 26\nBRONX COMMUNITY BOARD #9 28\nBRONX COMMUNITY BOARD #10 42\nBRONX COMMUNITY BOARD #11 31\nBRONX COMMUNITY BOARD #12 20\nQUEENS COMMUNITY BOARD #1 31\nQUEENS COMMUNITY BOARD #2 28\nQUEENS COMMUNITY BOARD #3 30\nQUEENS COMMUNITY BOARD #4 22\nQUEENS COMMUNITY BOARD #5 28\nQUEENS COMMUNITY BOARD #6 29\nQUEENS COMMUNITY BOARD #7 32\nQUEENS COMMUNITY BOARD #8 36\nQUEENS COMMUNITY BOARD #9 28\nQUEENS COMMUNITY BOARD #10 29\nQUEENS COMMUNITY BOARD #11 23\nQUEENS COMMUNITY BOARD #12 28\nQUEENS COMMUNITY BOARD #13 22\nQUEENS COMMUNITY BOARD #14 25\nGUTTMAN COMMUNITY COLLEGE 4120\nCOMMUNITY COLLEGE (BRONX) 23312\nCOMMUNITY COLLEGE (QUEENSBORO) 26474\nCOMMUNITY COLLEGE (KINGSBORO) 31582\nCOMMUNITY COLLEGE (MANHATTAN) 41594\nCUNY CENTRAL OFFICE 365\nCOMMUNITY COLLEGE (HOSTOS) 15002\nCOMMUNITY COLLEGE (LAGUARDIA) 32068\nHUNTER COLLEGE HIGH SCHOOL 2617\nBROOKLYN COMMUNITY BOARD #1 22\nBROOKLYN COMMUNITY BOARD #2 27\nBROOKLYN COMMUNITY BOARD #3 21\nBROOKLYN COMMUNITY BOARD #4 24\nBROOKLYN COMMUNITY BOARD #5 30\nBROOKLYN COMMUNITY BOARD #6 24\nBROOKLYN COMMUNITY BOARD #7 22\nBROOKLYN COMMUNITY BOARD #8 22\nBROOKLYN COMMUNITY BOARD #9 20\nBROOKLYN COMMUNITY BOARD #10 30\nBROOKLYN COMMUNITY BOARD #11 24\nBROOKLYN COMMUNITY BOARD #12 23\nBROOKLYN COMMUNITY BOARD #13 28\nBROOKLYN COMMUNITY BOARD #14 21\nBROOKLYN COMMUNITY BOARD #15 24\nBROOKLYN COMMUNITY BOARD #16 22\nBROOKLYN COMMUNITY BOARD #17 28\nBROOKLYN COMMUNITY BOARD #18 22\nSTATEN ISLAND COMMUNITY BD #1 23\nSTATEN ISLAND COMMUNITY BD #2 29\nSTATEN ISLAND COMMUNITY BD #3 22\nDEPT OF ED HRLY SUPPORT STAFF 164165\nDEPT OF ED PER DIEM TEACHERS 90784\nDEPT OF ED PER SESSION TEACHER 608565\nDEPT OF ED PARA PROFESSIONALS 245259\nDEPARTMENT OF PROBATION 8385\nDEPARTMENT OF BUSINESS SERV. 2631\nHOUSING PRESERVATION & DVLPMNT 18158\nDEPARTMENT OF BUILDINGS 12031\nDEPT OF HEALTH/MENTAL HYGIENE 54291\nADMIN TRIALS AND HEARINGS 4967\nDEPT OF ENVIRONMENT PROTECTION 48751\nDEPARTMENT OF SANITATION 92755\nBUSINESS INTEGRITY COMMISSION 672\nDEPARTMENT OF FINANCE 16186\nDEPARTMENT OF TRANSPORTATION 42801\nDEPT OF PARKS & RECREATION 117212\nDEPT. OF DESIGN & CONSTRUCTION 10999\nDEPT OF INFO TECH & TELECOMM 12170\nDEPT OF RECORDS & INFO SERVICE 563\nCONSUMER AFFAIRS 3333\nDEPT OF CITYWIDE ADMIN SVCS 18885\nDISTRICT ATTORNEY-MANHATTAN 11405\nBRONX DISTRICT ATTORNEY 7237\nDISTRICT ATTORNEY KINGS COUNTY 7895\nDISTRICT ATTORNEY QNS COUNTY 4682\nDISTRICT ATTORNEY RICHMOND COU 1004\nDISTRICT ATTORNEY-SPECIAL NARC 1606\nPUBLIC ADMINISTRATOR-NEW YORK 80\nPUBLIC ADMINISTRATOR-BRONX 63\nPUBLIC ADMINISTRATOR-KINGS 105\nPUBLIC ADMINISTRATOR-QUEENS 60\nPUBLIC ADMINISTRATOR-RICHMOND 40\nNYC HOUSING AUTHORITY 95132\nBOARD OF CORRECTIONS 17\nDISTRICTING COMMISSION 3\nBRONX DA 935\nQUEENS DA 660\nSPEC NARCS-DA 251\nRICHMOND DA 112\nMANHATTAN DA 1622\nKINGS DA 1278\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=117",
              "$$hashKey": "object:3791"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639111715180_1061586270",
      "id": "paragraph_1639111715180_1061586270",
      "dateCreated": "2021-12-09T23:48:35-0500",
      "dateStarted": "2021-12-11T23:12:16-0500",
      "dateFinished": "2021-12-11T23:12:33-0500",
      "status": "FINISHED",
      "$$hashKey": "object:285"
    },
    {
      "text": "%spark.pyspark\n#count the precision for original clean and clean_new\n#we use the recall to check the percentage of the darty data and the numbers of the data we clean\n#in this case arr_new is just the same as arr_pres\narr_origin = []\narr_old = []\narr_new = []\narr_pres = []\nfor key, value in agency_name5.items():\n    arr_origin.append(key)\nfor key, value in agency_name_old5.items():\n    arr_old.append(key)\nfor key, value in agency_name_d5.items():\n    arr_new.append(key)\nfor key, value in agency_name_d5.items():\n    arr_pres.append(key)\n    \nclean_recall = len(set(arr_old).difference(set(arr_origin))) / (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres))))\nclean_new_recall =  len(set(arr_new).difference(set(arr_origin))) / (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres))))\n\nprint(\"clean_recall:\")\nprint(clean_recall)\nprint(\"clean_new_recall:\")\nprint(clean_new_recall)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:12:36-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "clean_recall:\n1.0\nclean_new_recall:\n1.0\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639118157587_312085580",
      "id": "paragraph_1639118157587_312085580",
      "dateCreated": "2021-12-10T01:35:57-0500",
      "dateStarted": "2021-12-11T23:12:36-0500",
      "dateFinished": "2021-12-11T23:12:36-0500",
      "status": "FINISHED",
      "$$hashKey": "object:286"
    },
    {
      "text": "%spark.pyspark\n###dataset6 test for Agency Name",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:12:38-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639111802896_769791761",
      "id": "paragraph_1639111802896_769791761",
      "dateCreated": "2021-12-09T23:50:02-0500",
      "dateStarted": "2021-12-11T23:12:38-0500",
      "dateFinished": "2021-12-11T23:12:38-0500",
      "status": "FINISHED",
      "$$hashKey": "object:287"
    },
    {
      "text": "%spark.pyspark\nagency_name6 = dataset6.map(lambda x: (x[3],1)).countByKey()\nfor key, value in agency_name6.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:12:39-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Agency Name 1\nMAYORALTY 12421\nBOARD OF ELECTIONS 1561\nFIRE DEPARTMENT 19878\nDEPARTMENT OF EMERGENCY MANAGEMENT 6251\nCAMPAIGN FINANCE BOARD 791\nOFFICE OF THE ACTUARY 743\nBOROUGH PRESIDENT - MANHATTAN 690\nBOROUGH PRESIDENT BRONX 1161\nOFFICE OF THE COMPTROLLER 3609\nBOROUGH PRESIDENT - BROOKLYN 977\nBOROUGH PRESIDENT - QUEENS 1022\nBOROUGH PRESIDENT STATEN ISLAND 1106\nDEPARTMENT OF EDUCATION 31009\nDEPARTMENT OF FINANCE 11439\nOFFICE OF ADMINISTRATIVE TAX APPEALS 708\nLAW DEPARTMENT 3315\nDEPARTMENT OF CITY PLANNING 4533\nDEPARTMENT OF INVESTIGATION 5356\nBROOKLYN PUBLIC LIBRARY 162\nCITY UNIVERSITY OF NEW YORK 11595\nPOLICE DEPARTMENT 32017\nCIVILIAN COMPLAINT REVIEW BOARD 886\nDEPARTMENT OF VETERANS' SERVICES 645\nADMIN FOR CHILDREN'S SERVICES 14747\nDEPARTMENT OF SOCIAL SERVICES 14828\nDEPARTMENT OF CORRECTION 6729\nDEPARTMENT OF HOMELESS SERVICES 14610\nBOARD OF CORRECTION 475\nMISCELLANEOUS 1215\nDEBT SERVICE 274\nPUBLIC ADVOCATE 624\nCITY COUNCIL 2550\nCITY CLERK 647\nDEPARTMENT FOR THE AGING 5978\nDEPARTMENT OF CULTURAL AFFAIRS 3149\nFINANCIAL INFORMATION SERVICE AGENCY 1491\nOFFICE OF PAYROLL ADMINISTRATION 1391\nINDEPENDENT BUDGET OFFICE 682\nEQUAL EMPLOYMENT PRACTICES COMMISSION 462\nCIVIL SERVICE COMMISSION 435\nLANDMARKS PRESERVATION COMM. 1212\nNYC TAXI AND LIMOUSINE COMM 1560\nCOMMISSION ON HUMAN RIGHTS 2793\nDEPARTMENT OF YOUTH & COMMUNITY DEV 7117\nCONFLICTS OF INTEREST BOARD 576\nOFFICE OF COLLECTIVE BARGAINING 529\nMANHATTAN COMMUNITY BOARD #1 350\nMANHATTAN COMMUNITY BOARD #2 205\nMANHATTAN COMMUNITY BOARD #3 282\nMANHATTAN COMMUNITY BOARD #4 251\nMANHATTAN COMMUNITY BOARD #5 175\nMANHATTAN COMMUNITY BOARD #6 321\nMANHATTAN COMMUNITY BOARD #7 241\nMANHATTAN COMMUNITY BOARD #8 256\nMANHATTAN COMMUNITY BOARD #9 226\nMANHATTAN COMMUNITY BOARD #10 244\nMANHATTAN COMMUNITY BOARD #11 382\nMANHATTAN COMMUNITY BOARD #12 268\nBRONX COMMUNITY BOARD #1 233\nBRONX COMMUNITY BOARD #2 329\nBRONX COMMUNITY BOARD #3 306\nBRONX COMMUNITY BOARD #5 245\nBRONX COMMUNITY BOARD #6 395\nBRONX COMMUNITY BOARD #7 381\nBRONX COMMUNITY BOARD #8 350\nBRONX COMMUNITY BOARD #9 312\nBRONX COMMUNITY BOARD #10 462\nBRONX COMMUNITY BOARD #11 358\nBRONX COMMUNITY BOARD #12 381\nQUEENS COMMUNITY BOARD #1 392\nQUEENS COMMUNITY BOARD #2 401\nQUEENS COMMUNITY BOARD #3 379\nQUEENS COMMUNITY BOARD #4 454\nQUEENS COMMUNITY BOARD #5 404\nQUEENS COMMUNITY BOARD #6 358\nQUEENS COMMUNITY BOARD #7 337\nQUEENS COMMUNITY BOARD #8 337\nDEPARTMENT OF SMALL BUSINESS SERVICES 11239\nQUEENS COMMUNITY BOARD #9 318\nQUEENS COMMUNITY BOARD #10 337\nQUEENS COMMUNITY BOARD #11 432\nQUEENS COMMUNITY BOARD #12 250\nQUEENS COMMUNITY BOARD #13 364\nQUEENS COMMUNITY BOARD #14 317\nBROOKLYN COMMUNITY BOARD #1 529\nBROOKLYN COMMUNITY BOARD #2 358\nBROOKLYN COMMUNITY BOARD #3 422\nBROOKLYN COMMUNITY BOARD #4 452\nBROOKLYN COMMUNITY BOARD #5 336\nBROOKLYN COMMUNITY BOARD #6 240\nBROOKLYN COMMUNITY BOARD #7 224\nBROOKLYN COMMUNITY BOARD #8 391\nBROOKLYN COMMUNITY BOARD #9 470\nBROOKLYN COMMUNITY BOARD #10 380\nBROOKLYN COMMUNITY BOARD #11 477\nBROOKLYN COMMUNITY BOARD #12 416\nBROOKLYN COMMUNITY BOARD #13 443\nBROOKLYN COMMUNITY BOARD #14 302\nBROOKLYN COMMUNITY BOARD #15 272\nBROOKLYN COMMUNITY BOARD #16 280\nBROOKLYN COMMUNITY BOARD #17 346\nBROOKLYN COMMUNITY BOARD #18 436\nSTATEN ISLAND COMMUNITY BOARD #1 363\nSTATEN ISLAND COMMUNITY BOARD #2 428\nSTATEN ISLAND COMMUNITY BOARD #3 320\nDEPARTMENT OF PROBATION 4079\nHOUSING PRESERVATION AND DEVELOPMENT 21448\nDEPARTMENT OF BUILDINGS 5404\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE 61274\nDEPARTMENT OF ENVIRONMENTAL PROTECT. 26594\nOFFICE OF ADMIN TRIALS & HEARINGS 2978\nDEPARTMENT OF SANITATION 18810\nBUSINESS INTEGRITY COMMISSION 1234\nDEPARTMENT OF TRANSPORTATION 41404\nDEPARTMENT OF PARKS AND RECREATION 32106\nDEPARTMENT OF DESIGN & CONSTRUCTION 8889\nDEPARTMENT OF CITYWIDE ADMIN SERVICE 21020\nDISTRICT ATTORNEY NEW YORK COUNTY 2644\nDEPARTMENT OF INFO TECH & TELECOMM 15337\nDEPARTMENT OF RECORDS & INFORMATION SVS 1366\nDEPARTMENT OF CONSUMER AFFAIRS 2385\nDISTRICT ATTORNEY BRONX COUNTY 1849\nDISTRICT ATTORNEY KINGS COUNTY 2273\nDISTRICT ATTORNEY QUEENS COUNTY 1422\nDISTRICT ATTORNEY RICHMOND COUNTY 1302\nOFFICE OF PROSECUTION SPEC NARCO 1276\nPUBLIC ADMINISTRATOR-KINGS COUNTY 229\nPUBLIC ADMINISTRATOR-RICHMOND COUNTY 240\nNEW YORK RESEARCH LIBRARIES 88\nNEW YORK PUBLIC LIBRARY 268\nQUEENS BOROUGH PUBLIC LIBRARY 130\nPENSION CONTRIBUTIONS 381\nBRONX COMMUNITY BOARD #4 258\nHEALTH AND HOSPITALS CORP 597\nPUBLIC ADMINISTRATOR-NEW YORK COUNTY 277\nPUBLIC ADMINISTRATOR-BRONX COUNTY 122\nPUBLIC ADMINISTRATOR- QUEENS COUNTY 113\nLEASE ADJUSTMENT 4\nCITYWIDE SAVINGS INITIATIVES 35\nENERGY ADJUSTMENT 4\nMAYORALTY                                799\nBOARD OF ELECTIONS                       94\nCAMPAIGN FINANCE BOARD                   53\nOFFICE OF THE ACTUARY                    48\nBOROUGH PRESIDENT - MANHATTAN            41\nBOROUGH PRESIDENT BRONX                  71\nBOROUGH PRESIDENT - BROOKLYN             58\nBOROUGH PRESIDENT - QUEENS               68\nBOROUGH PRESIDENT STATEN ISLAND          72\nOFFICE OF THE COMPTROLLER                223\nDEPARTMENT OF EMERGENCY MANAGEMENT       469\nOFFICE OF ADMINISTRATIVE TAX APPEALS     44\nLAW DEPARTMENT                           188\nDEPARTMENT OF CITY PLANNING              266\nDEPARTMENT OF INVESTIGATION              386\nBROOKLYN PUBLIC LIBRARY                  11\nDEPARTMENT OF EDUCATION                  2064\nCITY UNIVERSITY OF NEW YORK              726\nFIRE DEPARTMENT                          1202\nCIVILIAN COMPLAINT REVIEW BOARD          56\nPOLICE DEPARTMENT                        1985\nDEPARTMENT OF VETERANS' SERVICES         47\nADMIN FOR CHILDREN'S SERVICES            989\nFINANCIAL INFORMATION SERVICE AGENCY     90\nDEPARTMENT OF SOCIAL SERVICES            1026\nDEPARTMENT OF YOUTH & COMMUNITY DEV      450\nDEPARTMENT OF HOMELESS SERVICES          909\nDEPARTMENT OF CORRECTION                 438\nBOARD OF CORRECTION                      32\nMISCELLANEOUS                            75\nDEBT SERVICE                             14\nPUBLIC ADVOCATE                          38\nCITY COUNCIL                             168\nCITY CLERK                               43\nDEPARTMENT FOR THE AGING                 391\nDEPARTMENT OF CULTURAL AFFAIRS           204\nOFFICE OF PAYROLL ADMINISTRATION         81\nINDEPENDENT BUDGET OFFICE                45\nEQUAL EMPLOYMENT PRACTICES COMMISSION    28\nCIVIL SERVICE COMMISSION                 28\nLANDMARKS PRESERVATION COMM.             81\nNYC TAXI AND LIMOUSINE COMM              105\nCOMMISSION ON HUMAN RIGHTS               160\nCONFLICTS OF INTEREST BOARD              39\nOFFICE OF COLLECTIVE BARGAINING          33\nMANHATTAN COMMUNITY BOARD #1             22\nMANHATTAN COMMUNITY BOARD #2             12\nMANHATTAN COMMUNITY BOARD #3             16\nMANHATTAN COMMUNITY BOARD #4             17\nMANHATTAN COMMUNITY BOARD #5             10\nMANHATTAN COMMUNITY BOARD #6             22\nMANHATTAN COMMUNITY BOARD #7             14\nMANHATTAN COMMUNITY BOARD #8             16\nMANHATTAN COMMUNITY BOARD #9             16\nMANHATTAN COMMUNITY BOARD #10            16\nMANHATTAN COMMUNITY BOARD #11            23\nMANHATTAN COMMUNITY BOARD #12            17\nBRONX COMMUNITY BOARD #1                 15\nBRONX COMMUNITY BOARD #2                 22\nBRONX COMMUNITY BOARD #3                 22\nBRONX COMMUNITY BOARD #4                 17\nBRONX COMMUNITY BOARD #5                 14\nBRONX COMMUNITY BOARD #6                 28\nBRONX COMMUNITY BOARD #7                 24\nDEPARTMENT OF PROBATION                  276\nBRONX COMMUNITY BOARD #8                 17\nBRONX COMMUNITY BOARD #9                 21\nBRONX COMMUNITY BOARD #10                26\nBRONX COMMUNITY BOARD #11                24\nBRONX COMMUNITY BOARD #12                23\nQUEENS COMMUNITY BOARD #1                23\nQUEENS COMMUNITY BOARD #2                25\nQUEENS COMMUNITY BOARD #3                26\nQUEENS COMMUNITY BOARD #4                29\nQUEENS COMMUNITY BOARD #5                23\nQUEENS COMMUNITY BOARD #6                25\nQUEENS COMMUNITY BOARD #7                19\nQUEENS COMMUNITY BOARD #8                25\nQUEENS COMMUNITY BOARD #9                19\nQUEENS COMMUNITY BOARD #10               23\nQUEENS COMMUNITY BOARD #11               26\nQUEENS COMMUNITY BOARD #12               16\nQUEENS COMMUNITY BOARD #13               22\nQUEENS COMMUNITY BOARD #14               21\nBROOKLYN COMMUNITY BOARD #1              34\nBROOKLYN COMMUNITY BOARD #2              21\nBROOKLYN COMMUNITY BOARD #3              24\nBROOKLYN COMMUNITY BOARD #4              28\nBROOKLYN COMMUNITY BOARD #5              21\nBROOKLYN COMMUNITY BOARD #6              16\nBROOKLYN COMMUNITY BOARD #7              9\nBROOKLYN COMMUNITY BOARD #8              22\nBROOKLYN COMMUNITY BOARD #9              27\nBROOKLYN COMMUNITY BOARD #10             22\nBROOKLYN COMMUNITY BOARD #11             30\nBROOKLYN COMMUNITY BOARD #12             24\nBROOKLYN COMMUNITY BOARD #13             26\nBROOKLYN COMMUNITY BOARD #14             16\nBROOKLYN COMMUNITY BOARD #15             14\nBROOKLYN COMMUNITY BOARD #16             16\nBROOKLYN COMMUNITY BOARD #17             19\nBROOKLYN COMMUNITY BOARD #18             27\nSTATEN ISLAND COMMUNITY BOARD #1         24\nSTATEN ISLAND COMMUNITY BOARD #2         29\nSTATEN ISLAND COMMUNITY BOARD #3         22\nDEPARTMENT OF SMALL BUSINESS SERVICES    713\nHOUSING PRESERVATION AND DEVELOPMENT     1362\nDEPARTMENT OF BUILDINGS                  366\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE  3929\nDEPARTMENT OF ENVIRONMENTAL PROTECT.     1689\nDEPARTMENT OF FINANCE                    737\nOFFICE OF ADMIN TRIALS & HEARINGS        171\nDEPARTMENT OF PARKS AND RECREATION       2027\nDEPARTMENT OF SANITATION                 1203\nBUSINESS INTEGRITY COMMISSION            75\nDEPARTMENT OF TRANSPORTATION             2584\nDEPARTMENT OF DESIGN & CONSTRUCTION      656\nDEPARTMENT OF CITYWIDE ADMIN SERVICE     1291\nDEPARTMENT OF INFO TECH & TELECOMM       984\nDISTRICT ATTORNEY NEW YORK COUNTY        154\nDEPARTMENT OF RECORDS & INFORMATION SVS  98\nDEPARTMENT OF CONSUMER AFFAIRS           170\nDISTRICT ATTORNEY BRONX COUNTY           114\nDISTRICT ATTORNEY KINGS COUNTY           121\nDISTRICT ATTORNEY QUEENS COUNTY          87\nDISTRICT ATTORNEY RICHMOND COUNTY        77\nOFFICE OF PROSECUTION SPEC NARCO         78\nPUBLIC ADMINISTRATOR-KINGS COUNTY        16\nPUBLIC ADMINISTRATOR-RICHMOND COUNTY     15\nNEW YORK RESEARCH LIBRARIES              5\nNEW YORK PUBLIC LIBRARY                  17\nQUEENS BOROUGH PUBLIC LIBRARY            8\nPENSION CONTRIBUTIONS                    24\nHEALTH AND HOSPITALS CORP                44\n600 15\nPUBLIC ADMINISTRATOR-NEW YORK COUNTY     18\nPUBLIC ADMINISTRATOR-BRONX COUNTY        8\nPUBLIC ADMINISTRATOR- QUEENS COUNTY      8\nCITYWIDE SAVINGS INITIATIVES             14\nENERGY ADJUSTMENT                        1\nLEASE ADJUSTMENT                         1\nDEPARTMENT OF EMPLOYMENT                 26\nDEPARTMENT OF JUVENILE JUSTICE           32\nDISTRICTING COMMISSION                   1\nDEPARTMENT OF MENTAL HEALTH              60\n1 11\n42 4\n758 13\nDEPARTMENT OF EMPLOYMENT 208\nDEPARTMENT OF JUVENILE JUSTICE 256\nDISTRICTING COMMISSION 8\nDEPARTMENT OF MENTAL HEALTH 480\nDEPT OF CONSUMER & WORKER PROTECTION 380\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=118",
              "$$hashKey": "object:3917"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639111803900_1334015244",
      "id": "paragraph_1639111803900_1334015244",
      "dateCreated": "2021-12-09T23:50:03-0500",
      "dateStarted": "2021-12-11T23:12:39-0500",
      "dateFinished": "2021-12-11T23:12:42-0500",
      "status": "FINISHED",
      "$$hashKey": "object:288"
    },
    {
      "text": "%spark.pyspark\nagency_name_old6 = dataset6.map(lambda x:  (clean(x[3]),1)).countByKey()\nfor key, value in agency_name_d6.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:12:41-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "AGENCY NAME 1\nMAYORALTY 13220\nBOARD OF ELECTIONS 1655\nFIRE DEPARTMENT 21080\nDEPARTMENT OF EMERGENCY MANAGEMENT 6720\nCAMPAIGN FINANCE BOARD 844\nOFFICE OF THE ACTUARY 791\nBOROUGH PRESIDENT - MANHATTAN 731\nBOROUGH PRESIDENT BRONX 1232\nOFFICE OF THE COMPTROLLER 3832\nBOROUGH PRESIDENT - BROOKLYN 1035\nBOROUGH PRESIDENT - QUEENS 1090\nBOROUGH PRESIDENT STATEN ISLAND 1178\nDEPARTMENT OF EDUCATION 33073\nDEPARTMENT OF FINANCE 12176\nOFFICE OF ADMINISTRATIVE TAX APPEALS 752\nLAW DEPARTMENT 3503\nDEPARTMENT OF CITY PLANNING 4799\nDEPARTMENT OF INVESTIGATION 5742\nBROOKLYN PUBLIC LIBRARY 173\nCITY UNIVERSITY OF NEW YORK 12321\nPOLICE DEPARTMENT 34002\nCIVILIAN COMPLAINT REVIEW BOARD 942\nDEPARTMENT OF VETERANS' SERVICES 692\nADMIN FOR CHILDREN'S SERVICES 15736\nDEPARTMENT OF SOCIAL SERVICES 15854\nDEPARTMENT OF CORRECTION 7167\nDEPARTMENT OF HOMELESS SERVICES 15519\nBOARD OF CORRECTION 507\nMISCELLANEOUS 1290\nDEBT SERVICE 288\nPUBLIC ADVOCATE 662\nCITY COUNCIL 2718\nCITY CLERK 690\nDEPARTMENT FOR THE AGING 6369\nDEPARTMENT OF CULTURAL AFFAIRS 3353\nFINANCIAL INFORMATION SERVICE AGENCY 1581\nOFFICE OF PAYROLL ADMINISTRATION 1472\nINDEPENDENT BUDGET OFFICE 727\nEQUAL EMPLOYMENT PRACTICES COMMISSION 490\nCIVIL SERVICE COMMISSION 463\nLANDMARKS PRESERVATION COMM. 1293\nNYC TAXI AND LIMOUSINE COMM 1665\nCOMMISSION ON HUMAN RIGHTS 2953\nDEPARTMENT OF YOUTH & COMMUNITY DEV 7567\nCONFLICTS OF INTEREST BOARD 615\nOFFICE OF COLLECTIVE BARGAINING 562\nMANHATTAN COMMUNITY BOARD #1 372\nMANHATTAN COMMUNITY BOARD #2 217\nMANHATTAN COMMUNITY BOARD #3 298\nMANHATTAN COMMUNITY BOARD #4 268\nMANHATTAN COMMUNITY BOARD #5 185\nMANHATTAN COMMUNITY BOARD #6 343\nMANHATTAN COMMUNITY BOARD #7 255\nMANHATTAN COMMUNITY BOARD #8 272\nMANHATTAN COMMUNITY BOARD #9 242\nMANHATTAN COMMUNITY BOARD #10 260\nMANHATTAN COMMUNITY BOARD #11 405\nMANHATTAN COMMUNITY BOARD #12 285\nBRONX COMMUNITY BOARD #1 248\nBRONX COMMUNITY BOARD #2 351\nBRONX COMMUNITY BOARD #3 328\nBRONX COMMUNITY BOARD #5 259\nBRONX COMMUNITY BOARD #6 423\nBRONX COMMUNITY BOARD #7 405\nBRONX COMMUNITY BOARD #8 367\nBRONX COMMUNITY BOARD #9 333\nBRONX COMMUNITY BOARD #10 488\nBRONX COMMUNITY BOARD #11 382\nBRONX COMMUNITY BOARD #12 404\nQUEENS COMMUNITY BOARD #1 415\nQUEENS COMMUNITY BOARD #2 426\nQUEENS COMMUNITY BOARD #3 405\nQUEENS COMMUNITY BOARD #4 483\nQUEENS COMMUNITY BOARD #5 427\nQUEENS COMMUNITY BOARD #6 383\nQUEENS COMMUNITY BOARD #7 356\nQUEENS COMMUNITY BOARD #8 362\nDEPARTMENT OF SMALL BUSINESS SERVICES 11952\nQUEENS COMMUNITY BOARD #9 337\nQUEENS COMMUNITY BOARD #10 360\nQUEENS COMMUNITY BOARD #11 458\nQUEENS COMMUNITY BOARD #12 266\nQUEENS COMMUNITY BOARD #13 386\nQUEENS COMMUNITY BOARD #14 338\nBROOKLYN COMMUNITY BOARD #1 563\nBROOKLYN COMMUNITY BOARD #2 379\nBROOKLYN COMMUNITY BOARD #3 446\nBROOKLYN COMMUNITY BOARD #4 480\nBROOKLYN COMMUNITY BOARD #5 357\nBROOKLYN COMMUNITY BOARD #6 256\nBROOKLYN COMMUNITY BOARD #7 233\nBROOKLYN COMMUNITY BOARD #8 413\nBROOKLYN COMMUNITY BOARD #9 497\nBROOKLYN COMMUNITY BOARD #10 402\nBROOKLYN COMMUNITY BOARD #11 507\nBROOKLYN COMMUNITY BOARD #12 440\nBROOKLYN COMMUNITY BOARD #13 469\nBROOKLYN COMMUNITY BOARD #14 318\nBROOKLYN COMMUNITY BOARD #15 286\nBROOKLYN COMMUNITY BOARD #16 296\nBROOKLYN COMMUNITY BOARD #17 365\nBROOKLYN COMMUNITY BOARD #18 463\nSTATEN ISLAND COMMUNITY BOARD #1 387\nSTATEN ISLAND COMMUNITY BOARD #2 457\nSTATEN ISLAND COMMUNITY BOARD #3 342\nDEPARTMENT OF PROBATION 4355\nHOUSING PRESERVATION AND DEVELOPMENT 22810\nDEPARTMENT OF BUILDINGS 5770\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE 65203\nDEPARTMENT OF ENVIRONMENTAL PROTECT. 28283\nOFFICE OF ADMIN TRIALS & HEARINGS 3149\nDEPARTMENT OF SANITATION 20013\nBUSINESS INTEGRITY COMMISSION 1309\nDEPARTMENT OF TRANSPORTATION 43988\nDEPARTMENT OF PARKS AND RECREATION 34133\nDEPARTMENT OF DESIGN & CONSTRUCTION 9545\nDEPARTMENT OF CITYWIDE ADMIN SERVICE 22311\nDISTRICT ATTORNEY NEW YORK COUNTY 2798\nDEPARTMENT OF INFO TECH & TELECOMM 16321\nDEPARTMENT OF RECORDS & INFORMATION SVS 1464\nDEPARTMENT OF CONSUMER AFFAIRS 2555\nDISTRICT ATTORNEY BRONX COUNTY 1963\nDISTRICT ATTORNEY KINGS COUNTY 2394\nDISTRICT ATTORNEY QUEENS COUNTY 1509\nDISTRICT ATTORNEY RICHMOND COUNTY 1379\nOFFICE OF PROSECUTION SPEC NARCO 1354\nPUBLIC ADMINISTRATOR-KINGS COUNTY 245\nPUBLIC ADMINISTRATOR-RICHMOND COUNTY 255\nNEW YORK RESEARCH LIBRARIES 93\nNEW YORK PUBLIC LIBRARY 285\nQUEENS BOROUGH PUBLIC LIBRARY 138\nPENSION CONTRIBUTIONS 405\nBRONX COMMUNITY BOARD #4 275\nHEALTH AND HOSPITALS CORP 641\nPUBLIC ADMINISTRATOR-NEW YORK COUNTY 295\nPUBLIC ADMINISTRATOR-BRONX COUNTY 130\nPUBLIC ADMINISTRATOR- QUEENS COUNTY 121\nLEASE ADJUSTMENT 5\nCITYWIDE SAVINGS INITIATIVES 49\nENERGY ADJUSTMENT 5\n600 15\nDEPARTMENT OF EMPLOYMENT 234\nDEPARTMENT OF JUVENILE JUSTICE 288\nDISTRICTING COMMISSION 9\nDEPARTMENT OF MENTAL HEALTH 540\n1 11\n42 4\n758 13\nDEPT OF CONSUMER & WORKER PROTECTION 380\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=119",
              "$$hashKey": "object:3963"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639118479553_729307932",
      "id": "paragraph_1639118479553_729307932",
      "dateCreated": "2021-12-10T01:41:19-0500",
      "dateStarted": "2021-12-11T23:12:41-0500",
      "dateFinished": "2021-12-11T23:12:45-0500",
      "status": "FINISHED",
      "$$hashKey": "object:289"
    },
    {
      "text": "%spark.pyspark\nagency_name_d6 = dataset6.map(lambda x:  (clean_new(x[3]),1)).countByKey()\nfor key, value in agency_name_d6.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T14:01:41-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "AGENCY NAME 1\nMAYORALTY 13220\nBOARD OF ELECTIONS 1655\nFIRE DEPARTMENT 21080\nDEPARTMENT OF EMERGENCY MANAGEMENT 6720\nCAMPAIGN FINANCE BOARD 844\nOFFICE OF THE ACTUARY 791\nBOROUGH PRESIDENT - MANHATTAN 731\nBOROUGH PRESIDENT BRONX 1232\nOFFICE OF THE COMPTROLLER 3832\nBOROUGH PRESIDENT - BROOKLYN 1035\nBOROUGH PRESIDENT - QUEENS 1090\nBOROUGH PRESIDENT STATEN ISLAND 1178\nDEPARTMENT OF EDUCATION 33073\nDEPARTMENT OF FINANCE 12176\nOFFICE OF ADMINISTRATIVE TAX APPEALS 752\nLAW DEPARTMENT 3503\nDEPARTMENT OF CITY PLANNING 4799\nDEPARTMENT OF INVESTIGATION 5742\nBROOKLYN PUBLIC LIBRARY 173\nCITY UNIVERSITY OF NEW YORK 12321\nPOLICE DEPARTMENT 34002\nCIVILIAN COMPLAINT REVIEW BOARD 942\nDEPARTMENT OF VETERANS' SERVICES 692\nADMIN FOR CHILDREN'S SERVICES 15736\nDEPARTMENT OF SOCIAL SERVICES 15854\nDEPARTMENT OF CORRECTION 7167\nDEPARTMENT OF HOMELESS SERVICES 15519\nBOARD OF CORRECTION 507\nMISCELLANEOUS 1290\nDEBT SERVICE 288\nPUBLIC ADVOCATE 662\nCITY COUNCIL 2718\nCITY CLERK 690\nDEPARTMENT FOR THE AGING 6369\nDEPARTMENT OF CULTURAL AFFAIRS 3353\nFINANCIAL INFORMATION SERVICE AGENCY 1581\nOFFICE OF PAYROLL ADMINISTRATION 1472\nINDEPENDENT BUDGET OFFICE 727\nEQUAL EMPLOYMENT PRACTICES COMMISSION 490\nCIVIL SERVICE COMMISSION 463\nLANDMARKS PRESERVATION COMM. 1293\nNYC TAXI AND LIMOUSINE COMM 1665\nCOMMISSION ON HUMAN RIGHTS 2953\nDEPARTMENT OF YOUTH & COMMUNITY DEV 7567\nCONFLICTS OF INTEREST BOARD 615\nOFFICE OF COLLECTIVE BARGAINING 562\nMANHATTAN COMMUNITY BOARD #1 372\nMANHATTAN COMMUNITY BOARD #2 217\nMANHATTAN COMMUNITY BOARD #3 298\nMANHATTAN COMMUNITY BOARD #4 268\nMANHATTAN COMMUNITY BOARD #5 185\nMANHATTAN COMMUNITY BOARD #6 343\nMANHATTAN COMMUNITY BOARD #7 255\nMANHATTAN COMMUNITY BOARD #8 272\nMANHATTAN COMMUNITY BOARD #9 242\nMANHATTAN COMMUNITY BOARD #10 260\nMANHATTAN COMMUNITY BOARD #11 405\nMANHATTAN COMMUNITY BOARD #12 285\nBRONX COMMUNITY BOARD #1 248\nBRONX COMMUNITY BOARD #2 351\nBRONX COMMUNITY BOARD #3 328\nBRONX COMMUNITY BOARD #5 259\nBRONX COMMUNITY BOARD #6 423\nBRONX COMMUNITY BOARD #7 405\nBRONX COMMUNITY BOARD #8 367\nBRONX COMMUNITY BOARD #9 333\nBRONX COMMUNITY BOARD #10 488\nBRONX COMMUNITY BOARD #11 382\nBRONX COMMUNITY BOARD #12 404\nQUEENS COMMUNITY BOARD #1 415\nQUEENS COMMUNITY BOARD #2 426\nQUEENS COMMUNITY BOARD #3 405\nQUEENS COMMUNITY BOARD #4 483\nQUEENS COMMUNITY BOARD #5 427\nQUEENS COMMUNITY BOARD #6 383\nQUEENS COMMUNITY BOARD #7 356\nQUEENS COMMUNITY BOARD #8 362\nDEPARTMENT OF SMALL BUSINESS SERVICES 11952\nQUEENS COMMUNITY BOARD #9 337\nQUEENS COMMUNITY BOARD #10 360\nQUEENS COMMUNITY BOARD #11 458\nQUEENS COMMUNITY BOARD #12 266\nQUEENS COMMUNITY BOARD #13 386\nQUEENS COMMUNITY BOARD #14 338\nBROOKLYN COMMUNITY BOARD #1 563\nBROOKLYN COMMUNITY BOARD #2 379\nBROOKLYN COMMUNITY BOARD #3 446\nBROOKLYN COMMUNITY BOARD #4 480\nBROOKLYN COMMUNITY BOARD #5 357\nBROOKLYN COMMUNITY BOARD #6 256\nBROOKLYN COMMUNITY BOARD #7 233\nBROOKLYN COMMUNITY BOARD #8 413\nBROOKLYN COMMUNITY BOARD #9 497\nBROOKLYN COMMUNITY BOARD #10 402\nBROOKLYN COMMUNITY BOARD #11 507\nBROOKLYN COMMUNITY BOARD #12 440\nBROOKLYN COMMUNITY BOARD #13 469\nBROOKLYN COMMUNITY BOARD #14 318\nBROOKLYN COMMUNITY BOARD #15 286\nBROOKLYN COMMUNITY BOARD #16 296\nBROOKLYN COMMUNITY BOARD #17 365\nBROOKLYN COMMUNITY BOARD #18 463\nSTATEN ISLAND COMMUNITY BOARD #1 387\nSTATEN ISLAND COMMUNITY BOARD #2 457\nSTATEN ISLAND COMMUNITY BOARD #3 342\nDEPARTMENT OF PROBATION 4355\nHOUSING PRESERVATION AND DEVELOPMENT 22810\nDEPARTMENT OF BUILDINGS 5770\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE 65203\nDEPARTMENT OF ENVIRONMENTAL PROTECT. 28283\nOFFICE OF ADMIN TRIALS & HEARINGS 3149\nDEPARTMENT OF SANITATION 20013\nBUSINESS INTEGRITY COMMISSION 1309\nDEPARTMENT OF TRANSPORTATION 43988\nDEPARTMENT OF PARKS AND RECREATION 34133\nDEPARTMENT OF DESIGN & CONSTRUCTION 9545\nDEPARTMENT OF CITYWIDE ADMIN SERVICE 22311\nDISTRICT ATTORNEY NEW YORK COUNTY 2798\nDEPARTMENT OF INFO TECH & TELECOMM 16321\nDEPARTMENT OF RECORDS & INFORMATION SVS 1464\nDEPARTMENT OF CONSUMER AFFAIRS 2555\nDISTRICT ATTORNEY BRONX COUNTY 1963\nDISTRICT ATTORNEY KINGS COUNTY 2394\nDISTRICT ATTORNEY QUEENS COUNTY 1509\nDISTRICT ATTORNEY RICHMOND COUNTY 1379\nOFFICE OF PROSECUTION SPEC NARCO 1354\nPUBLIC ADMINISTRATOR-KINGS COUNTY 245\nPUBLIC ADMINISTRATOR-RICHMOND COUNTY 255\nNEW YORK RESEARCH LIBRARIES 93\nNEW YORK PUBLIC LIBRARY 285\nQUEENS BOROUGH PUBLIC LIBRARY 138\nPENSION CONTRIBUTIONS 405\nBRONX COMMUNITY BOARD #4 275\nHEALTH AND HOSPITALS CORP 641\nPUBLIC ADMINISTRATOR-NEW YORK COUNTY 295\nPUBLIC ADMINISTRATOR-BRONX COUNTY 130\nPUBLIC ADMINISTRATOR- QUEENS COUNTY 121\nLEASE ADJUSTMENT 5\nCITYWIDE SAVINGS INITIATIVES 49\nENERGY ADJUSTMENT 5\n600 15\nDEPARTMENT OF EMPLOYMENT 234\nDEPARTMENT OF JUVENILE JUSTICE 288\nDISTRICTING COMMISSION 9\nDEPARTMENT OF MENTAL HEALTH 540\n1 11\n42 4\n758 13\nDEPT OF CONSUMER & WORKER PROTECTION 380\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=28",
              "$$hashKey": "object:4009"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639111835098_402427214",
      "id": "paragraph_1639111835098_402427214",
      "dateCreated": "2021-12-09T23:50:35-0500",
      "dateStarted": "2021-12-11T12:26:00-0500",
      "dateFinished": "2021-12-11T12:26:07-0500",
      "status": "FINISHED",
      "$$hashKey": "object:290"
    },
    {
      "text": "%spark.pyspark\n#count the precision for original clean and clean_new\n#we use the recall to check the percentage of the darty data and the numbers of the data we clean\n#in this case arr_new is just the same as arr_pres\narr_origin = []\narr_old = []\narr_new = []\narr_pres = []\nfor key, value in agency_name6.items():\n    arr_origin.append(key)\nfor key, value in agency_name_old6.items():\n    arr_old.append(key)\nfor key, value in agency_name_d6.items():\n    arr_new.append(key)\nfor key, value in agency_name_d6.items():\n    arr_pres.append(key)\n    \nclean_recall = len(set(arr_old).difference(set(arr_origin))) / (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres))))\nclean_new_recall =  len(set(arr_new).difference(set(arr_origin))) / (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres))))\n\nprint(\"clean_recall:\")\nprint(clean_recall)\nprint(\"clean_new_recall:\")\nprint(clean_new_recall)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:12:49-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "clean_recall:\n1.0\nclean_new_recall:\n1.0\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639118124700_1190409299",
      "id": "paragraph_1639118124700_1190409299",
      "dateCreated": "2021-12-10T01:35:24-0500",
      "dateStarted": "2021-12-11T23:12:49-0500",
      "dateFinished": "2021-12-11T23:12:49-0500",
      "status": "FINISHED",
      "$$hashKey": "object:291"
    },
    {
      "text": "%spark.pyspark\n###dataset7 test for Agency Name",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:12:52-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639111951009_839060001",
      "id": "paragraph_1639111951009_839060001",
      "dateCreated": "2021-12-09T23:52:31-0500",
      "dateStarted": "2021-12-11T23:12:52-0500",
      "dateFinished": "2021-12-11T23:12:52-0500",
      "status": "FINISHED",
      "$$hashKey": "object:292"
    },
    {
      "text": "%spark.pyspark\nagency_name7 = dataset7.map(lambda x: (x[6],1)).countByKey()\nfor key, value in agency_name7.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:12:53-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "List Agency Desc 1\nDEPARTMENT OF EDUCATION 74386\nPOLICE DEPARTMENT 456294\nFIRE DEPARTMENT 113073\nDEPARTMENT OF ENVIRONMENTAL PROTECTION 61284\nN.Y.C. HOUSING AUTHORITY 79589\nN.Y.C. TRANSIT AUTHORITY 408548\nDEPARTMENT OF PARKS & RECREATION 32161\nDEPARTMENT OF CITYWIDE ADMINISTRATIVE SERVICES 39431\nNYC EMPLOYEES' RETIREMENT SYSTEM 17598\nDEPARTMENT OF HOMELESS SERVICES 54115\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE 58519\nADMINISTRATION FOR CHILDREN'S SERVICES 90767\n 43265\nHRA/DEPARTMENT OF SOCIAL SERVICES 171249\nDEPARTMENT OF SANITATION 90920\nTEACHERS' RETIREMENT SYSTEM 10927\nNYC POLICE PENSION FUND 8376\nDEPARTMENT OF CORRECTION 94164\nDEPARTMENT FOR THE AGING 10563\nLANDMARKS PRESERVATION COMMISSION 660\nDEPARTMENT OF YOUTH AND COMMUNITY DEVELOPMENT 20537\nDEPARTMENT OF PROBATION 11768\nDEPARTMENT OF INFORMATION TECHNOLOGY AND TELECOMMUNICATIONS 56869\nDISTRICT ATTORNEY-KINGS COUNTY 9307\nOFFICE OF THE MAYOR 1\nOFFICE OF THE COMPTROLLER 22712\nOFFICE OF EMERGENCY MANAGEMENT 1262\nDEPARTMENT OF CITY PLANNING 7466\nDEPARTMENT OF CULTURAL AFFAIRS 178\nOFFICE OF LABOR RELATIONS 3394\nHOUSING PRESERVATION & DEVELOPMENT 43221\nDEPARTMENT OF BUILDINGS 25875\nOFFICE OF ADMINISTRATIVE TRIALS AND HEARINGS (OATH) 5006\nOFFICE OF PAYROLL ADMINISTRATION 5293\nDEPARTMENT OF TRANSPORTATION 47556\nTRIBOROUGH BRIDGE AND TUNNEL AUTHORITY 5027\nDEPARTMENT OF FINANCE 56920\nDISTRICT ATTORNEY-NEW YORK COUNTY 953\nDISTRICT ATTORNEY-BRONX COUNTY 3273\nLAW DEPARTMENT 10909\nDEPARTMENT OF DESIGN AND CONSTRUCTION 27689\nDEPT. OF RECORDS AND INFORMATION SERVICES 1060\nFINANCIAL INFORMATION SERVICES AGENCY 6453\nDEPARTMENT OF CONSUMER AFFAIRS 16584\nTAXI AND LIMOUSINE COMMISSION 6232\nDISTRICT ATTORNEY-QUEENS COUNTY 1885\nCOMMISSION ON HUMAN RIGHTS 763\nCITY CLERK 1104\nDEPARTMENT OF INVESTIGATION 2169\nCIVIL SERVICE COMMISSION 1\nNYC HEALTH AND HOSPITALS CORPORATION 669\nBOROUGH PRESIDENT-QUEENS 4872\nOFFICE OF COLLECTIVE BARGAINING 22\nBUSINESS INTEGRITY COMMISSION 1200\nCIVILIAN COMPLAINT REVIEW BOARD 1930\nNEW YORK CITY FIRE PENSION FUND 268\nDEPARTMENT OF VETERANS' SERVICES 12005\nOFFICE OF THE ACTUARY 93\nMAYOR'S OFFICE OF CONTRACT SERVICES 218\nDISTRICT ATTORNEY-RICHMOND COUNTY 304\nDISTRICT ATTORNEY - SPECIAL NARCOTICS 165\nTAX COMMISSION 2935\nDEPARTMENT OF BUSINESS SERVICES 9695\nEQUAL EMPLOYMENT PRACTICES COMMISSION 1853\nBOROUGH PRESIDENT-BROOKLYN 1\nOFFICE OF MANAGEMENT AND BUDGET 112\nBOARD OF CORRECTIONS 421\nCONFLICTS OF INTEREST BOARD 1044\nBOROUGH PRESIDENT-MANHATTAN 1692\nCAMPAIGN FINANCE BOARD 52\nPUBLIC ADMINISTRATOR NEW YORK COUNTY 53\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=120",
              "$$hashKey": "object:4135"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639111963313_940508029",
      "id": "paragraph_1639111963313_940508029",
      "dateCreated": "2021-12-09T23:52:43-0500",
      "dateStarted": "2021-12-11T23:12:53-0500",
      "dateFinished": "2021-12-11T23:13:00-0500",
      "status": "FINISHED",
      "$$hashKey": "object:293"
    },
    {
      "text": "%spark.pyspark\nagency_name_old7 = dataset7.map(lambda x:  (clean(x[6]),1)).countByKey()\nfor key, value in agency_name_old7.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:12:54-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "LIST AGENCY DESC 1\nDEPARTMENT OF EDUCATION 74386\nPOLICE DEPARTMENT 456294\nFIRE DEPARTMENT 113073\nDEPARTMENT OF ENVIRONMENTAL PROTECTION 61284\nN.Y.C. HOUSING AUTHORITY 79589\nN.Y.C. TRANSIT AUTHORITY 408548\nDEPARTMENT OF PARKS & RECREATION 32161\nDEPARTMENT OF CITYWIDE ADMINISTRATIVE SERVICES 39431\nNYC EMPLOYEES' RETIREMENT SYSTEM 17598\nDEPARTMENT OF HOMELESS SERVICES 54115\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE 58519\nADMINISTRATION FOR CHILDREN'S SERVICES 90767\n  43265\nHRA/DEPARTMENT OF SOCIAL SERVICES 171249\nDEPARTMENT OF SANITATION 90920\nTEACHERS' RETIREMENT SYSTEM 10927\nNYC POLICE PENSION FUND 8376\nDEPARTMENT OF CORRECTION 94164\nDEPARTMENT FOR THE AGING 10563\nLANDMARKS PRESERVATION COMMISSION 660\nDEPARTMENT OF YOUTH AND COMMUNITY DEVELOPMENT 20537\nDEPARTMENT OF PROBATION 11768\nDEPARTMENT OF INFORMATION TECHNOLOGY AND TELECOMMUNICATIONS 56869\nDISTRICT ATTORNEY-KINGS COUNTY 9307\nOFFICE OF THE MAYOR 1\nOFFICE OF THE COMPTROLLER 22712\nOFFICE OF EMERGENCY MANAGEMENT 1262\nDEPARTMENT OF CITY PLANNING 7466\nDEPARTMENT OF CULTURAL AFFAIRS 178\nOFFICE OF LABOR RELATIONS 3394\nHOUSING PRESERVATION & DEVELOPMENT 43221\nDEPARTMENT OF BUILDINGS 25875\nOFFICE OF ADMINISTRATIVE TRIALS AND HEARINGS (OATH) 5006\nOFFICE OF PAYROLL ADMINISTRATION 5293\nDEPARTMENT OF TRANSPORTATION 47556\nTRIBOROUGH BRIDGE AND TUNNEL AUTHORITY 5027\nDEPARTMENT OF FINANCE 56920\nDISTRICT ATTORNEY-NEW YORK COUNTY 953\nDISTRICT ATTORNEY-BRONX COUNTY 3273\nLAW DEPARTMENT 10909\nDEPARTMENT OF DESIGN AND CONSTRUCTION 27689\nDEPT. OF RECORDS AND INFORMATION SERVICES 1060\nFINANCIAL INFORMATION SERVICES AGENCY 6453\nDEPARTMENT OF CONSUMER AFFAIRS 16584\nTAXI AND LIMOUSINE COMMISSION 6232\nDISTRICT ATTORNEY-QUEENS COUNTY 1885\nCOMMISSION ON HUMAN RIGHTS 763\nCITY CLERK 1104\nDEPARTMENT OF INVESTIGATION 2169\nCIVIL SERVICE COMMISSION 1\nNYC HEALTH AND HOSPITALS CORPORATION 669\nBOROUGH PRESIDENT-QUEENS 4872\nOFFICE OF COLLECTIVE BARGAINING 22\nBUSINESS INTEGRITY COMMISSION 1200\nCIVILIAN COMPLAINT REVIEW BOARD 1930\nNEW YORK CITY FIRE PENSION FUND 268\nDEPARTMENT OF VETERANS' SERVICES 12005\nOFFICE OF THE ACTUARY 93\nMAYOR'S OFFICE OF CONTRACT SERVICES 218\nDISTRICT ATTORNEY-RICHMOND COUNTY 304\nDISTRICT ATTORNEY - SPECIAL NARCOTICS 165\nTAX COMMISSION 2935\nDEPARTMENT OF BUSINESS SERVICES 9695\nEQUAL EMPLOYMENT PRACTICES COMMISSION 1853\nBOROUGH PRESIDENT-BROOKLYN 1\nOFFICE OF MANAGEMENT AND BUDGET 112\nBOARD OF CORRECTIONS 421\nCONFLICTS OF INTEREST BOARD 1044\nBOROUGH PRESIDENT-MANHATTAN 1692\nCAMPAIGN FINANCE BOARD 52\nPUBLIC ADMINISTRATOR NEW YORK COUNTY 53\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=121",
              "$$hashKey": "object:4181"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639118523366_2007994285",
      "id": "paragraph_1639118523366_2007994285",
      "dateCreated": "2021-12-10T01:42:03-0500",
      "dateStarted": "2021-12-11T23:12:54-0500",
      "dateFinished": "2021-12-11T23:13:07-0500",
      "status": "FINISHED",
      "$$hashKey": "object:294"
    },
    {
      "text": "%spark.pyspark\nagency_name_d7 = dataset7.map(lambda x:  (clean_new(x[6]),1)).countByKey()\nfor key, value in agency_name_d7.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T22:30:27-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "LIST AGENCY DESC 1\nDEPARTMENT OF EDUCATION 74386\nPOLICE DEPARTMENT 456294\nFIRE DEPARTMENT 113073\nDEPARTMENT OF ENVIRONMENTAL PROTECTION 61284\nN.Y.C. HOUSING AUTHORITY 79589\nN.Y.C. TRANSIT AUTHORITY 408548\nDEPARTMENT OF PARKS & RECREATION 32161\nDEPARTMENT OF CITYWIDE ADMINISTRATIVE SERVICES 39431\nNYC EMPLOYEES' RETIREMENT SYSTEM 17598\nDEPARTMENT OF HOMELESS SERVICES 54115\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE 58519\nADMINISTRATION FOR CHILDREN'S SERVICES 90767\n 43265\nHRA/DEPARTMENT OF SOCIAL SERVICES 171249\nDEPARTMENT OF SANITATION 90920\nTEACHERS' RETIREMENT SYSTEM 10927\nNYC POLICE PENSION FUND 8376\nDEPARTMENT OF CORRECTION 94164\nDEPARTMENT FOR THE AGING 10563\nLANDMARKS PRESERVATION COMMISSION 660\nDEPARTMENT OF YOUTH AND COMMUNITY DEVELOPMENT 20537\nDEPARTMENT OF PROBATION 11768\nDEPARTMENT OF INFORMATION TECHNOLOGY AND TELECOMMUNICATIONS 56869\nDISTRICT ATTORNEY-KINGS COUNTY 9307\nOFFICE OF THE MAYOR 1\nOFFICE OF THE COMPTROLLER 22712\nOFFICE OF EMERGENCY MANAGEMENT 1262\nDEPARTMENT OF CITY PLANNING 7466\nDEPARTMENT OF CULTURAL AFFAIRS 178\nOFFICE OF LABOR RELATIONS 3394\nHOUSING PRESERVATION & DEVELOPMENT 43221\nDEPARTMENT OF BUILDINGS 25875\nOFFICE OF ADMINISTRATIVE TRIALS AND HEARINGS (OATH) 5006\nOFFICE OF PAYROLL ADMINISTRATION 5293\nDEPARTMENT OF TRANSPORTATION 47556\nTRIBOROUGH BRIDGE AND TUNNEL AUTHORITY 5027\nDEPARTMENT OF FINANCE 56920\nDISTRICT ATTORNEY-NEW YORK COUNTY 953\nDISTRICT ATTORNEY-BRONX COUNTY 3273\nLAW DEPARTMENT 10909\nDEPARTMENT OF DESIGN AND CONSTRUCTION 27689\nDEPT. OF RECORDS AND INFORMATION SERVICES 1060\nFINANCIAL INFORMATION SERVICES AGENCY 6453\nDEPARTMENT OF CONSUMER AFFAIRS 16584\nTAXI AND LIMOUSINE COMMISSION 6232\nDISTRICT ATTORNEY-QUEENS COUNTY 1885\nCOMMISSION ON HUMAN RIGHTS 763\nCITY CLERK 1104\nDEPARTMENT OF INVESTIGATION 2169\nCIVIL SERVICE COMMISSION 1\nNYC HEALTH AND HOSPITALS CORPORATION 669\nBOROUGH PRESIDENT-QUEENS 4872\nOFFICE OF COLLECTIVE BARGAINING 22\nBUSINESS INTEGRITY COMMISSION 1200\nCIVILIAN COMPLAINT REVIEW BOARD 1930\nNEW YORK CITY FIRE PENSION FUND 268\nDEPARTMENT OF VETERANS' SERVICES 12005\nOFFICE OF THE ACTUARY 93\nMAYOR'S OFFICE OF CONTRACT SERVICES 218\nDISTRICT ATTORNEY-RICHMOND COUNTY 304\nDISTRICT ATTORNEY - SPECIAL NARCOTICS 165\nTAX COMMISSION 2935\nDEPARTMENT OF BUSINESS SERVICES 9695\nEQUAL EMPLOYMENT PRACTICES COMMISSION 1853\nBOROUGH PRESIDENT-BROOKLYN 1\nOFFICE OF MANAGEMENT AND BUDGET 112\nBOARD OF CORRECTIONS 421\nCONFLICTS OF INTEREST BOARD 1044\nBOROUGH PRESIDENT-MANHATTAN 1692\nCAMPAIGN FINANCE BOARD 52\nPUBLIC ADMINISTRATOR NEW YORK COUNTY 53\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=61",
              "$$hashKey": "object:4227"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639111971242_1918459905",
      "id": "paragraph_1639111971242_1918459905",
      "dateCreated": "2021-12-09T23:52:51-0500",
      "dateStarted": "2021-12-11T22:30:27-0500",
      "dateFinished": "2021-12-11T22:30:40-0500",
      "status": "FINISHED",
      "$$hashKey": "object:295"
    },
    {
      "text": "%spark.pyspark\n#count the precision for original clean and clean_new\n#we use the recall to check the percentage of the darty data and the numbers of the data we clean\n#in this case arr_new is just the same as arr_pres\narr_origin = []\narr_old = []\narr_new = []\narr_pres = []\nfor key, value in agency_name7.items():\n    arr_origin.append(key)\nfor key, value in agency_name_old7.items():\n    arr_old.append(key)\nfor key, value in agency_name_d7.items():\n    arr_new.append(key)\nfor key, value in agency_name_d7.items():\n    arr_pres.append(key)\n    \nclean_recall = (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres)))) / len(set(arr_old).difference(set(arr_origin)))\nclean_new_recall =  len(set(arr_new).difference(set(arr_origin))) / (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres))))\n\nprint(\"clean_recall:\")\nprint(clean_recall)\nprint(\"clean_new_recall:\")\nprint(clean_new_recall)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:13:44-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "clean_recall:\n0.5\nclean_new_recall:\n1.0\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639118109581_1006876599",
      "id": "paragraph_1639118109581_1006876599",
      "dateCreated": "2021-12-10T01:35:09-0500",
      "dateStarted": "2021-12-11T23:13:44-0500",
      "dateFinished": "2021-12-11T23:13:44-0500",
      "status": "FINISHED",
      "$$hashKey": "object:296"
    },
    {
      "text": "%spark.pyspark\n###dataset8 test for Agency Name",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:13:15-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639112055513_354590491",
      "id": "paragraph_1639112055513_354590491",
      "dateCreated": "2021-12-09T23:54:15-0500",
      "dateStarted": "2021-12-11T23:13:15-0500",
      "dateFinished": "2021-12-11T23:13:15-0500",
      "status": "FINISHED",
      "$$hashKey": "object:297"
    },
    {
      "text": "%spark.pyspark\nagency_name8 = dataset8.map(lambda x: (x[10],1)).countByKey()\nfor key, value in agency_name8.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:13:16-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "List Agency Desc 1\nOPEN COMPETITIVE 516444\nNYC EMPLOYEES' RETIREMENT SYSTEM 115\nOFFICE OF THE COMPTROLLER 154\nDEPARTMENT OF CITY PLANNING 30\nDEPARTMENT OF EDUCATION 694\nTEACHERS' RETIREMENT SYSTEM 51\nPOLICE DEPARTMENT 10766\nADMINISTRATION FOR CHILDREN'S SERVICES 1266\nHRA/DEPARTMENT OF SOCIAL SERVICES 3995\nFINANCIAL INFORMATION SERVICES AGENCY 59\nOFFICE OF PAYROLL ADMINISTRATION 56\nTAXI AND LIMOUSINE COMMISSION 136\nOFFICE OF LABOR RELATIONS 12\nNYC POLICE PENSION FUND 30\nNEW YORK CITY FIRE PENSION FUND 2\nHOUSING PRESERVATION & DEVELOPMENT 261\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE 784\nDEPARTMENT OF ENVIRONMENTAL PROTECTION 1451\nDEPARTMENT OF SANITATION 1462\nDEPARTMENT OF FINANCE 299\nDEPARTMENT OF TRANSPORTATION 1012\nDEPARTMENT OF PARKS & RECREATION 918\nDEPARTMENT OF DESIGN AND CONSTRUCTION 294\nDEPARTMENT OF CITYWIDE ADMINISTRATIVE SERVICES 379\nDISTRICT ATTORNEY-QUEENS COUNTY 14\nN.Y.C. HOUSING AUTHORITY 2185\nDEPARTMENT OF HOMELESS SERVICES 480\nDEPARTMENT FOR THE AGING 43\nDEPARTMENT OF BUILDINGS 300\nN.Y.C. TRANSIT AUTHORITY 6101\nDEPARTMENT OF BUSINESS SERVICES 46\nDEPARTMENT OF INFORMATION TECHNOLOGY AND TELECOMMUNICATIONS 447\nDEPARTMENT OF CONSUMER AFFAIRS 17\nOFFICE OF MANAGEMENT AND BUDGET 34\nCITY CLERK 6\nDEPARTMENT OF YOUTH AND COMMUNITY DEVELOPMENT 121\nQUALIFIED INCUMBENT 972\nFIRE DEPARTMENT 7238\nDEPARTMENT OF CORRECTION 1488\nTRIBOROUGH BRIDGE AND TUNNEL AUTHORITY 23\nBOROUGH PRESIDENT-BRONX 3\nBOROUGH PRESIDENT-BROOKLYN 2\nBOROUGH PRESIDENT-QUEENS 2\nOFFICE OF EMERGENCY MANAGEMENT 4\nTAX COMMISSION 5\nLAW DEPARTMENT 53\nDEPARTMENT OF INVESTIGATION 19\nCIVILIAN COMPLAINT REVIEW BOARD 3\nDEPARTMENT OF CULTURAL AFFAIRS 3\nINDEPENDENT BUDGET OFFICE 8\nDEPARTMENT OF PROBATION 23\nOFFICE OF ADMINISTRATIVE TRIALS AND HEARINGS (OATH) 22\nDEPT. OF RECORDS AND INFORMATION SERVICES 2\nDISTRICT ATTORNEY-NEW YORK COUNTY 9\nDISTRICT ATTORNEY-KINGS COUNTY 23\nOFFICE OF THE MAYOR 1\nBOROUGH PRESIDENT-MANHATTAN 1\nLANDMARKS PRESERVATION COMMISSION 1\nBUSINESS INTEGRITY COMMISSION 2\nDISTRICT ATTORNEY-BRONX COUNTY 8\nDISTRICT ATTORNEY-RICHMOND COUNTY 2\nCIVIL SERVICE COMMISSION 1\nDEPARTMENT OF VETERANS' SERVICES 1\nMAYOR'S OFFICE OF CONTRACT SERVICES 1\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=122",
              "$$hashKey": "object:4353"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639112045623_386044505",
      "id": "paragraph_1639112045623_386044505",
      "dateCreated": "2021-12-09T23:54:05-0500",
      "dateStarted": "2021-12-11T23:13:16-0500",
      "dateFinished": "2021-12-11T23:13:17-0500",
      "status": "FINISHED",
      "$$hashKey": "object:298"
    },
    {
      "text": "%spark.pyspark\nagency_name_old8 = dataset8.map(lambda x:  (clean(x[10]),1)).countByKey()\nfor key, value in agency_name_d8.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:13:20-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "LIST AGENCY DESC 1\nOPEN COMPETITIVE 516444\nNYC EMPLOYEES' RETIREMENT SYSTEM 115\nOFFICE OF THE COMPTROLLER 154\nDEPARTMENT OF CITY PLANNING 30\nDEPARTMENT OF EDUCATION 694\nTEACHERS' RETIREMENT SYSTEM 51\nPOLICE DEPARTMENT 10766\nADMINISTRATION FOR CHILDREN'S SERVICES 1266\nHRA/DEPARTMENT OF SOCIAL SERVICES 3995\nFINANCIAL INFORMATION SERVICES AGENCY 59\nOFFICE OF PAYROLL ADMINISTRATION 56\nTAXI AND LIMOUSINE COMMISSION 136\nOFFICE OF LABOR RELATIONS 12\nNYC POLICE PENSION FUND 30\nNEW YORK CITY FIRE PENSION FUND 2\nHOUSING PRESERVATION & DEVELOPMENT 261\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE 784\nDEPARTMENT OF ENVIRONMENTAL PROTECTION 1451\nDEPARTMENT OF SANITATION 1462\nDEPARTMENT OF FINANCE 299\nDEPARTMENT OF TRANSPORTATION 1012\nDEPARTMENT OF PARKS & RECREATION 918\nDEPARTMENT OF DESIGN AND CONSTRUCTION 294\nDEPARTMENT OF CITYWIDE ADMINISTRATIVE SERVICES 379\nDISTRICT ATTORNEY-QUEENS COUNTY 14\nN.Y.C. HOUSING AUTHORITY 2185\nDEPARTMENT OF HOMELESS SERVICES 480\nDEPARTMENT FOR THE AGING 43\nDEPARTMENT OF BUILDINGS 300\nN.Y.C. TRANSIT AUTHORITY 6101\nDEPARTMENT OF BUSINESS SERVICES 46\nDEPARTMENT OF INFORMATION TECHNOLOGY AND TELECOMMUNICATIONS 447\nDEPARTMENT OF CONSUMER AFFAIRS 17\nOFFICE OF MANAGEMENT AND BUDGET 34\nCITY CLERK 6\nDEPARTMENT OF YOUTH AND COMMUNITY DEVELOPMENT 121\nQUALIFIED INCUMBENT 972\nFIRE DEPARTMENT 7238\nDEPARTMENT OF CORRECTION 1488\nTRIBOROUGH BRIDGE AND TUNNEL AUTHORITY 23\nBOROUGH PRESIDENT-BRONX 3\nBOROUGH PRESIDENT-BROOKLYN 2\nBOROUGH PRESIDENT-QUEENS 2\nOFFICE OF EMERGENCY MANAGEMENT 4\nTAX COMMISSION 5\nLAW DEPARTMENT 53\nDEPARTMENT OF INVESTIGATION 19\nCIVILIAN COMPLAINT REVIEW BOARD 3\nDEPARTMENT OF CULTURAL AFFAIRS 3\nINDEPENDENT BUDGET OFFICE 8\nDEPARTMENT OF PROBATION 23\nOFFICE OF ADMINISTRATIVE TRIALS AND HEARINGS (OATH) 22\nDEPT. OF RECORDS AND INFORMATION SERVICES 2\nDISTRICT ATTORNEY-NEW YORK COUNTY 9\nDISTRICT ATTORNEY-KINGS COUNTY 23\nOFFICE OF THE MAYOR 1\nBOROUGH PRESIDENT-MANHATTAN 1\nLANDMARKS PRESERVATION COMMISSION 1\nBUSINESS INTEGRITY COMMISSION 2\nDISTRICT ATTORNEY-BRONX COUNTY 8\nDISTRICT ATTORNEY-RICHMOND COUNTY 2\nCIVIL SERVICE COMMISSION 1\nDEPARTMENT OF VETERANS' SERVICES 1\nMAYOR'S OFFICE OF CONTRACT SERVICES 1\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=123",
              "$$hashKey": "object:4399"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639118553568_1198784378",
      "id": "paragraph_1639118553568_1198784378",
      "dateCreated": "2021-12-10T01:42:33-0500",
      "dateStarted": "2021-12-11T23:13:20-0500",
      "dateFinished": "2021-12-11T23:13:21-0500",
      "status": "FINISHED",
      "$$hashKey": "object:299"
    },
    {
      "text": "%spark.pyspark\nagency_name_d8 = dataset8.map(lambda x:  (clean_new(x[10]),1)).countByKey()\nfor key, value in agency_name_d8.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:13:48-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "LIST AGENCY DESC 1\nOPEN COMPETITIVE 516444\nNYC EMPLOYEES' RETIREMENT SYSTEM 115\nOFFICE OF THE COMPTROLLER 154\nDEPARTMENT OF CITY PLANNING 30\nDEPARTMENT OF EDUCATION 694\nTEACHERS' RETIREMENT SYSTEM 51\nPOLICE DEPARTMENT 10766\nADMINISTRATION FOR CHILDREN'S SERVICES 1266\nHRA/DEPARTMENT OF SOCIAL SERVICES 3995\nFINANCIAL INFORMATION SERVICES AGENCY 59\nOFFICE OF PAYROLL ADMINISTRATION 56\nTAXI AND LIMOUSINE COMMISSION 136\nOFFICE OF LABOR RELATIONS 12\nNYC POLICE PENSION FUND 30\nNEW YORK CITY FIRE PENSION FUND 2\nHOUSING PRESERVATION & DEVELOPMENT 261\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE 784\nDEPARTMENT OF ENVIRONMENTAL PROTECTION 1451\nDEPARTMENT OF SANITATION 1462\nDEPARTMENT OF FINANCE 299\nDEPARTMENT OF TRANSPORTATION 1012\nDEPARTMENT OF PARKS & RECREATION 918\nDEPARTMENT OF DESIGN AND CONSTRUCTION 294\nDEPARTMENT OF CITYWIDE ADMINISTRATIVE SERVICES 379\nDISTRICT ATTORNEY-QUEENS COUNTY 14\nN.Y.C. HOUSING AUTHORITY 2185\nDEPARTMENT OF HOMELESS SERVICES 480\nDEPARTMENT FOR THE AGING 43\nDEPARTMENT OF BUILDINGS 300\nN.Y.C. TRANSIT AUTHORITY 6101\nDEPARTMENT OF BUSINESS SERVICES 46\nDEPARTMENT OF INFORMATION TECHNOLOGY AND TELECOMMUNICATIONS 447\nDEPARTMENT OF CONSUMER AFFAIRS 17\nOFFICE OF MANAGEMENT AND BUDGET 34\nCITY CLERK 6\nDEPARTMENT OF YOUTH AND COMMUNITY DEVELOPMENT 121\nQUALIFIED INCUMBENT 972\nFIRE DEPARTMENT 7238\nDEPARTMENT OF CORRECTION 1488\nTRIBOROUGH BRIDGE AND TUNNEL AUTHORITY 23\nBOROUGH PRESIDENT-BRONX 3\nBOROUGH PRESIDENT-BROOKLYN 2\nBOROUGH PRESIDENT-QUEENS 2\nOFFICE OF EMERGENCY MANAGEMENT 4\nTAX COMMISSION 5\nLAW DEPARTMENT 53\nDEPARTMENT OF INVESTIGATION 19\nCIVILIAN COMPLAINT REVIEW BOARD 3\nDEPARTMENT OF CULTURAL AFFAIRS 3\nINDEPENDENT BUDGET OFFICE 8\nDEPARTMENT OF PROBATION 23\nOFFICE OF ADMINISTRATIVE TRIALS AND HEARINGS (OATH) 22\nDEPT. OF RECORDS AND INFORMATION SERVICES 2\nDISTRICT ATTORNEY-NEW YORK COUNTY 9\nDISTRICT ATTORNEY-KINGS COUNTY 23\nOFFICE OF THE MAYOR 1\nBOROUGH PRESIDENT-MANHATTAN 1\nLANDMARKS PRESERVATION COMMISSION 1\nBUSINESS INTEGRITY COMMISSION 2\nDISTRICT ATTORNEY-BRONX COUNTY 8\nDISTRICT ATTORNEY-RICHMOND COUNTY 2\nCIVIL SERVICE COMMISSION 1\nDEPARTMENT OF VETERANS' SERVICES 1\nMAYOR'S OFFICE OF CONTRACT SERVICES 1\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=125",
              "$$hashKey": "object:4445"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639112042857_1592864574",
      "id": "paragraph_1639112042857_1592864574",
      "dateCreated": "2021-12-09T23:54:02-0500",
      "dateStarted": "2021-12-11T23:13:48-0500",
      "dateFinished": "2021-12-11T23:13:49-0500",
      "status": "FINISHED",
      "$$hashKey": "object:300"
    },
    {
      "text": "%spark.pyspark\n#count the precision for original clean and clean_new\n#we use the recall to check the percentage of the darty data and the numbers of the data we clean\n#in this case arr_new is just the same as arr_pres\narr_origin = []\narr_old = []\narr_new = []\narr_pres = []\nfor key, value in agency_name8.items():\n    arr_origin.append(key)\nfor key, value in agency_name_old8.items():\n    arr_old.append(key)\nfor key, value in agency_name_d8.items():\n    arr_new.append(key)\nfor key, value in agency_name_d8.items():\n    arr_pres.append(key)\n    \nclean_recall = len(set(arr_old).difference(set(arr_origin))) / (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres))))\nclean_new_recall =  len(set(arr_new).difference(set(arr_origin))) / (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres))))\n\nprint(\"clean_recall:\")\nprint(clean_recall)\nprint(\"clean_new_recall:\")\nprint(clean_new_recall)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:13:51-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "clean_recall:\n1.0\nclean_new_recall:\n1.0\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639118089679_562387044",
      "id": "paragraph_1639118089679_562387044",
      "dateCreated": "2021-12-10T01:34:49-0500",
      "dateStarted": "2021-12-11T23:13:51-0500",
      "dateFinished": "2021-12-11T23:13:51-0500",
      "status": "FINISHED",
      "$$hashKey": "object:301"
    },
    {
      "text": "%spark.pyspark\n###dataset9 test for Agency Name",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:13:53-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639112122252_1041966817",
      "id": "paragraph_1639112122252_1041966817",
      "dateCreated": "2021-12-09T23:55:22-0500",
      "dateStarted": "2021-12-11T23:13:53-0500",
      "dateFinished": "2021-12-11T23:13:53-0500",
      "status": "FINISHED",
      "$$hashKey": "object:302"
    },
    {
      "text": "%spark.pyspark\nagency_name9 = dataset9.map(lambda x: (x[2],1)).countByKey()\nfor key, value in agency_name9.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:13:53-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Agency Name 1\nBusiness Integrity Commission 9\nCommission on Human Rights 41\nCivilian Complaint Review Board 9\nDepartment of Consumer Affairs 35\nDepartment of Citywide Administrative Services 57\nDepartment of City Planning 51\nDepartment of Environmental Protection 47\nDepartment for the Aging 10\nDepartment of Homeless Services 23\nDepartment of Buildings 205\nNew York City Police Department 54\nDepartment of Parks and Recreation 301\nDepartment of Education 143\nDepartment of Finance 56\nDepartment of Health and Mental Hygiene 192\nDepartment of Investigation 15\nDepartment of Records and Information Services 19\nDepartment of Transportation 80\nMayor's Office to Combat Domestic Violence 20\nFire Department of New York 17\nDepartment of Housing Preservation and Development 76\nHuman Resources Administration 501\nMayor's Office of Film, Theatre and Broadcasting 6\nNew York City Housing Authority 112\nOffice of Administrative Trials and Hearings 57\nSmall Business Services 143\nTaxi and Limousine Commission 40\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=126",
              "$$hashKey": "object:4571"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639112153860_1793542751",
      "id": "paragraph_1639112153860_1793542751",
      "dateCreated": "2021-12-09T23:55:53-0500",
      "dateStarted": "2021-12-11T23:13:53-0500",
      "dateFinished": "2021-12-11T23:13:53-0500",
      "status": "FINISHED",
      "$$hashKey": "object:303"
    },
    {
      "text": "%spark.pyspark\nagency_name_old9 = dataset9.map(lambda x: (clean(x[2]),1)).countByKey()\nfor key, value in agency_name_d9.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:13:55-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "AGENCY NAME 1\nBUSINESS INTEGRITY COMMISSION 9\nCOMMISSION ON HUMAN RIGHTS 41\nCIVILIAN COMPLAINT REVIEW BOARD 9\nDEPARTMENT OF CONSUMER AFFAIRS 35\nDEPARTMENT OF CITYWIDE ADMINISTRATIVE SERVICES 57\nDEPARTMENT OF CITY PLANNING 51\nDEPARTMENT OF ENVIRONMENTAL PROTECTION 47\nDEPARTMENT FOR THE AGING 10\nDEPARTMENT OF HOMELESS SERVICES 23\nDEPARTMENT OF BUILDINGS 205\nNEW YORK CITY POLICE DEPARTMENT 54\nDEPARTMENT OF PARKS AND RECREATION 301\nDEPARTMENT OF EDUCATION 143\nDEPARTMENT OF FINANCE 56\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE 192\nDEPARTMENT OF INVESTIGATION 15\nDEPARTMENT OF RECORDS AND INFORMATION SERVICES 19\nDEPARTMENT OF TRANSPORTATION 80\nMAYOR'S OFFICE TO COMBAT DOMESTIC VIOLENCE 20\nFIRE DEPARTMENT OF NEW YORK 17\nDEPARTMENT OF HOUSING PRESERVATION AND DEVELOPMENT 76\nHUMAN RESOURCES ADMINISTRATION 501\nMAYOR'S OFFICE OF FILM, THEATRE AND BROADCASTING 6\nNEW YORK CITY HOUSING AUTHORITY 112\nOFFICE OF ADMINISTRATIVE TRIALS AND HEARINGS 57\nSMALL BUSINESS SERVICES 143\nTAXI AND LIMOUSINE COMMISSION 40\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=127",
              "$$hashKey": "object:4617"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639118581024_914409269",
      "id": "paragraph_1639118581024_914409269",
      "dateCreated": "2021-12-10T01:43:01-0500",
      "dateStarted": "2021-12-11T23:13:55-0500",
      "dateFinished": "2021-12-11T23:13:55-0500",
      "status": "FINISHED",
      "$$hashKey": "object:304"
    },
    {
      "text": "%spark.pyspark\nagency_name_d9 = dataset9.map(lambda x: (clean_new(x[2]),1)).countByKey()\nfor key, value in agency_name_d9.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:13:57-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "AGENCY NAME 1\nBUSINESS INTEGRITY COMMISSION 9\nCOMMISSION ON HUMAN RIGHTS 41\nCIVILIAN COMPLAINT REVIEW BOARD 9\nDEPARTMENT OF CONSUMER AFFAIRS 35\nDEPARTMENT OF CITYWIDE ADMINISTRATIVE SERVICES 57\nDEPARTMENT OF CITY PLANNING 51\nDEPARTMENT OF ENVIRONMENTAL PROTECTION 47\nDEPARTMENT FOR THE AGING 10\nDEPARTMENT OF HOMELESS SERVICES 23\nDEPARTMENT OF BUILDINGS 205\nNEW YORK CITY POLICE DEPARTMENT 54\nDEPARTMENT OF PARKS AND RECREATION 301\nDEPARTMENT OF EDUCATION 143\nDEPARTMENT OF FINANCE 56\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE 192\nDEPARTMENT OF INVESTIGATION 15\nDEPARTMENT OF RECORDS AND INFORMATION SERVICES 19\nDEPARTMENT OF TRANSPORTATION 80\nMAYOR'S OFFICE TO COMBAT DOMESTIC VIOLENCE 20\nFIRE DEPARTMENT OF NEW YORK 17\nDEPARTMENT OF HOUSING PRESERVATION AND DEVELOPMENT 76\nHUMAN RESOURCES ADMINISTRATION 501\nMAYOR'S OFFICE OF FILM, THEATRE AND BROADCASTING 6\nNEW YORK CITY HOUSING AUTHORITY 112\nOFFICE OF ADMINISTRATIVE TRIALS AND HEARINGS 57\nSMALL BUSINESS SERVICES 143\nTAXI AND LIMOUSINE COMMISSION 40\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=128",
              "$$hashKey": "object:4663"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639112132411_2106116233",
      "id": "paragraph_1639112132411_2106116233",
      "dateCreated": "2021-12-09T23:55:32-0500",
      "dateStarted": "2021-12-11T23:13:57-0500",
      "dateFinished": "2021-12-11T23:13:57-0500",
      "status": "FINISHED",
      "$$hashKey": "object:305"
    },
    {
      "text": "%spark.pyspark\n#count the precision for original clean and clean_new\n#we use the recall to check the percentage of the darty data and the numbers of the data we clean\n#in this case arr_new is just the same as arr_pres\narr_origin = []\narr_old = []\narr_new = []\narr_pres = []\nfor key, value in agency_name9.items():\n    arr_origin.append(key)\nfor key, value in agency_name_old9.items():\n    arr_old.append(key)\nfor key, value in agency_name_d9.items():\n    arr_new.append(key)\nfor key, value in agency_name_d9.items():\n    arr_pres.append(key)\n    \nclean_recall = len(set(arr_old).difference(set(arr_origin))) / (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres))))\nclean_new_recall =  len(set(arr_new).difference(set(arr_origin))) / (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres))))\n\nprint(\"clean_recall:\")\nprint(clean_recall)\nprint(\"clean_new_recall:\")\nprint(clean_new_recall)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:13:58-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "clean_recall:\n1.0\nclean_new_recall:\n1.0\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639118067782_1836060055",
      "id": "paragraph_1639118067782_1836060055",
      "dateCreated": "2021-12-10T01:34:27-0500",
      "dateStarted": "2021-12-11T23:13:58-0500",
      "dateFinished": "2021-12-11T23:13:58-0500",
      "status": "FINISHED",
      "$$hashKey": "object:306"
    },
    {
      "text": "%spark.pyspark\n###dataset10 test for Agency Name",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:14:00-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639112300668_214230966",
      "id": "paragraph_1639112300668_214230966",
      "dateCreated": "2021-12-09T23:58:20-0500",
      "dateStarted": "2021-12-11T23:14:00-0500",
      "dateFinished": "2021-12-11T23:14:00-0500",
      "status": "FINISHED",
      "$$hashKey": "object:307"
    },
    {
      "text": "%spark.pyspark\nagency_name10 = dataset10.map(lambda x: (x[2],1)).countByKey()\nfor key, value in agency_name10.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:14:01-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Agency Name 1\n311 1\nNEW YORK CITY HOUSING AUTHORITY 1\nDEPARTMENT OF EDUCATION - SCHOOL CONSTRUCTION AUTHORITY                 1\nBOARD OF ELECTIONS                       2\nDEPARTMENT OF EMERGENCY MANAGEMENT       2\nLAW DEPARTMENT                           2\nDEPARTMENT OF CITY PLANNING              4\nDEPARTMENT OF INVESTIGATION              4\nNEW YORK PUBLIC LIBRARY - RESEARCH 1\nNEW YORK PUBLIC LIBRARY                  5\nBROOKLYN PUBLIC LIBRARY                  1\nQUEENS BOROUGH PUBLIC LIBRARY            1\nDEPARTMENT OF EDUCATION                  30\nCITY UNIVERSITY OF NEW YORK              5\nCIVILIAN COMPLAINT REVIEW BOARD          2\nPOLICE DEPARTMENT                        14\nFIRE DEPARTMENT                          10\nDEPARTMENT OF VETERANS' SERVICES         2\nADMIN FOR CHILDREN'S SERVICES            8\nHUMAN RESOURCES ADMINISTRATION 9\nDEPARTMENT OF HOMELESS SERVICES          2\nDEPARTMENT OF CORRECTION                 4\nDEPARTMENT FOR THE AGING                 4\nDEPARTMENT OF CULTURAL AFFAIRS           22\nLANDMARKS PRESERVATION COMM.             2\nTAXI AND LIMOUSINE COMMISSION              2\nCOMMISSION ON HUMAN RIGHTS               4\nDEPARTMENT OF YOUTH & COMMUNITY DEVELOPMENT      4\nDEPARTMENT OF PROBATION                  4\nDEPARTMENT OF SMALL BUSINESS SERVICES    8\nHOUSING PRESERVATION AND DEVELOPMENT     8\nDEPARTMENT OF BUILDINGS                  2\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE  21\nHEALTH AND HOSPITALS CORP                1\nOFFICE OF ADMINISTRATION TRIALS & HEARINGS        2\nDEPARTMENT OF ENVIRONMENTAL PROTECT.     8\nDEPARTMENT OF SANITATION                 12\nBUSINESS INTEGRITY COMMISSION            2\nDEPARTMENT OF FINANCE                    15\nDEPARTMENT OF TRANSPORTATION             10\nDEPARTMENT OF PARKS AND RECREATION       8\nDEPARTMENT OF DESIGN & CONSTRUCTION      2\nDEPARTMENT OF CITYWIDE ADMIN SERVICE     18\nDEPARTMENT OF INFORMATION TECHNOLOGY & TELECOMMUNICATIONS       2\nDEPARTMENT OF RECORDS & INFORMATION SERVICES 2\nDEPARTMENT OF CONSUMER AFFAIRS           4\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=129",
              "$$hashKey": "object:4789"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639112316066_788493125",
      "id": "paragraph_1639112316066_788493125",
      "dateCreated": "2021-12-09T23:58:36-0500",
      "dateStarted": "2021-12-11T23:14:01-0500",
      "dateFinished": "2021-12-11T23:14:01-0500",
      "status": "FINISHED",
      "$$hashKey": "object:308"
    },
    {
      "text": "%spark.pyspark\nagency_name_old10 = dataset10.map(lambda x: (clean(x[2]),1)).countByKey()\nfor key, value in agency_name_d10.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:14:03-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "AGENCY NAME 1\n311 1\nNEW YORK CITY HOUSING AUTHORITY 1\nDEPARTMENT OF EDUCATION - SCHOOL CONSTRUCTION AUTHORITY 1\nBOARD OF ELECTIONS 2\nDEPARTMENT OF EMERGENCY MANAGEMENT 2\nLAW DEPARTMENT 2\nDEPARTMENT OF CITY PLANNING 4\nDEPARTMENT OF INVESTIGATION 4\nNEW YORK PUBLIC LIBRARY - RESEARCH 1\nNEW YORK PUBLIC LIBRARY 5\nBROOKLYN PUBLIC LIBRARY 1\nQUEENS BOROUGH PUBLIC LIBRARY 1\nDEPARTMENT OF EDUCATION 30\nCITY UNIVERSITY OF NEW YORK 5\nCIVILIAN COMPLAINT REVIEW BOARD 2\nPOLICE DEPARTMENT 14\nFIRE DEPARTMENT 10\nDEPARTMENT OF VETERANS' SERVICES 2\nADMIN FOR CHILDREN'S SERVICES 8\nHUMAN RESOURCES ADMINISTRATION 9\nDEPARTMENT OF HOMELESS SERVICES 2\nDEPARTMENT OF CORRECTION 4\nDEPARTMENT FOR THE AGING 4\nDEPARTMENT OF CULTURAL AFFAIRS 22\nLANDMARKS PRESERVATION COMM. 2\nTAXI AND LIMOUSINE COMMISSION 2\nCOMMISSION ON HUMAN RIGHTS 4\nDEPARTMENT OF YOUTH & COMMUNITY DEVELOPMENT 4\nDEPARTMENT OF PROBATION 4\nDEPARTMENT OF SMALL BUSINESS SERVICES 8\nHOUSING PRESERVATION AND DEVELOPMENT 8\nDEPARTMENT OF BUILDINGS 2\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE 21\nHEALTH AND HOSPITALS CORP 1\nOFFICE OF ADMINISTRATION TRIALS & HEARINGS 2\nDEPARTMENT OF ENVIRONMENTAL PROTECT. 8\nDEPARTMENT OF SANITATION 12\nBUSINESS INTEGRITY COMMISSION 2\nDEPARTMENT OF FINANCE 15\nDEPARTMENT OF TRANSPORTATION 10\nDEPARTMENT OF PARKS AND RECREATION 8\nDEPARTMENT OF DESIGN & CONSTRUCTION 2\nDEPARTMENT OF CITYWIDE ADMIN SERVICE 18\nDEPARTMENT OF INFORMATION TECHNOLOGY & TELECOMMUNICATIONS 2\nDEPARTMENT OF RECORDS & INFORMATION SERVICES 2\nDEPARTMENT OF CONSUMER AFFAIRS 4\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=130",
              "$$hashKey": "object:4835"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639118610690_2066634162",
      "id": "paragraph_1639118610690_2066634162",
      "dateCreated": "2021-12-10T01:43:30-0500",
      "dateStarted": "2021-12-11T23:14:03-0500",
      "dateFinished": "2021-12-11T23:14:03-0500",
      "status": "FINISHED",
      "$$hashKey": "object:309"
    },
    {
      "text": "%spark.pyspark\nagency_name_d10 = dataset10.map(lambda x: (clean_new(x[2]),1)).countByKey()\nfor key, value in agency_name_d10.items():\n    print(key, value)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:14:06-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "AGENCY NAME 1\n311 1\nNEW YORK CITY HOUSING AUTHORITY 1\nDEPARTMENT OF EDUCATION - SCHOOL CONSTRUCTION AUTHORITY 1\nBOARD OF ELECTIONS 2\nDEPARTMENT OF EMERGENCY MANAGEMENT 2\nLAW DEPARTMENT 2\nDEPARTMENT OF CITY PLANNING 4\nDEPARTMENT OF INVESTIGATION 4\nNEW YORK PUBLIC LIBRARY - RESEARCH 1\nNEW YORK PUBLIC LIBRARY 5\nBROOKLYN PUBLIC LIBRARY 1\nQUEENS BOROUGH PUBLIC LIBRARY 1\nDEPARTMENT OF EDUCATION 30\nCITY UNIVERSITY OF NEW YORK 5\nCIVILIAN COMPLAINT REVIEW BOARD 2\nPOLICE DEPARTMENT 14\nFIRE DEPARTMENT 10\nDEPARTMENT OF VETERANS' SERVICES 2\nADMIN FOR CHILDREN'S SERVICES 8\nHUMAN RESOURCES ADMINISTRATION 9\nDEPARTMENT OF HOMELESS SERVICES 2\nDEPARTMENT OF CORRECTION 4\nDEPARTMENT FOR THE AGING 4\nDEPARTMENT OF CULTURAL AFFAIRS 22\nLANDMARKS PRESERVATION COMM. 2\nTAXI AND LIMOUSINE COMMISSION 2\nCOMMISSION ON HUMAN RIGHTS 4\nDEPARTMENT OF YOUTH & COMMUNITY DEVELOPMENT 4\nDEPARTMENT OF PROBATION 4\nDEPARTMENT OF SMALL BUSINESS SERVICES 8\nHOUSING PRESERVATION AND DEVELOPMENT 8\nDEPARTMENT OF BUILDINGS 2\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE 21\nHEALTH AND HOSPITALS CORP 1\nOFFICE OF ADMINISTRATION TRIALS & HEARINGS 2\nDEPARTMENT OF ENVIRONMENTAL PROTECT. 8\nDEPARTMENT OF SANITATION 12\nBUSINESS INTEGRITY COMMISSION 2\nDEPARTMENT OF FINANCE 15\nDEPARTMENT OF TRANSPORTATION 10\nDEPARTMENT OF PARKS AND RECREATION 8\nDEPARTMENT OF DESIGN & CONSTRUCTION 2\nDEPARTMENT OF CITYWIDE ADMIN SERVICE 18\nDEPARTMENT OF INFORMATION TECHNOLOGY & TELECOMMUNICATIONS 2\nDEPARTMENT OF RECORDS & INFORMATION SERVICES 2\nDEPARTMENT OF CONSUMER AFFAIRS 4\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://hc06.nyu.cluster:40375/jobs/job?id=131",
              "$$hashKey": "object:4881"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639112317432_791939576",
      "id": "paragraph_1639112317432_791939576",
      "dateCreated": "2021-12-09T23:58:37-0500",
      "dateStarted": "2021-12-11T23:14:06-0500",
      "dateFinished": "2021-12-11T23:14:06-0500",
      "status": "FINISHED",
      "$$hashKey": "object:310"
    },
    {
      "text": "%spark.pyspark\n#count the precision for original clean and clean_new\n#we use the recall to check the percentage of the darty data and the numbers of the data we clean\n#in this case arr_new is just the same as arr_pres\narr_origin = []\narr_old = []\narr_new = []\narr_pres = []\nfor key, value in agency_name10.items():\n    arr_origin.append(key)\nfor key, value in agency_name_old10.items():\n    arr_old.append(key)\nfor key, value in agency_name_d10.items():\n    arr_new.append(key)\nfor key, value in agency_name_d10.items():\n    arr_pres.append(key)\n    \nclean_recall = len(set(arr_old).difference(set(arr_origin))) / (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres))))\nclean_new_recall =  len(set(arr_new).difference(set(arr_origin))) / (len(arr_pres) - len(set(arr_origin).intersection(set(arr_pres))))\n\nprint(\"clean_recall:\")\nprint(clean_recall)\nprint(\"clean_new_recall:\")\nprint(clean_new_recall)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:14:07-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "clean_recall:\n0.023809523809523808\nclean_new_recall:\n1.0\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639118030377_1045906474",
      "id": "paragraph_1639118030377_1045906474",
      "dateCreated": "2021-12-10T01:33:50-0500",
      "dateStarted": "2021-12-11T23:14:07-0500",
      "dateFinished": "2021-12-11T23:14:07-0500",
      "status": "FINISHED",
      "$$hashKey": "object:311"
    },
    {
      "text": "%spark.pyspark\narr_pres1 = []\nfor key, value in agency_name_d1.items():\n    arr_pres1.append(key)\n    \narr_pres2 = []\nfor key, value in agency_name_d2.items():\n    arr_pres2.append(key)\n    \narr_pres3 = []\nfor key, value in agency_name_d3.items():\n    arr_pres3.append(key)\n    \narr_pres4 = []\nfor key, value in agency_name_d4.items():\n    arr_pres4.append(key)\n    \narr_pres5 = []\nfor key, value in agency_name_d5.items():\n    arr_pres5.append(key)\n    \narr_pres6 = []\nfor key, value in agency_name_d6.items():\n    arr_pres6.append(key)\n    \narr_pres7 = []\nfor key, value in agency_name_d7.items():\n    arr_pres7.append(key)\n    \narr_pres8 = []\nfor key, value in agency_name_d8.items():\n    arr_pres8.append(key)\n    \narr_pres9 = []\nfor key, value in agency_name_d9.items():\n    arr_pres9.append(key)\n\narr_pres10 = []\nfor key, value in agency_name_d10.items():\n    arr_pres10.append(key)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:14:09-0500",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639243703269_2137965385",
      "id": "paragraph_1639243703269_2137965385",
      "dateCreated": "2021-12-11T12:28:23-0500",
      "dateStarted": "2021-12-11T23:14:09-0500",
      "dateFinished": "2021-12-11T23:14:09-0500",
      "status": "FINISHED",
      "$$hashKey": "object:312"
    },
    {
      "text": "%spark.pyspark\nreference_data_agency_name = set(arr_pres1).union(set(arr_pres2).union(set(arr_pres3).union(set(arr_pres4).union(set(arr_pres5).union(set(arr_pres6).union(set(arr_pres7).union(set(arr_pres8).union(set(arr_pres9).union(set(arr_pres10))))))))))",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:14:11-0500",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639243761520_386639009",
      "id": "paragraph_1639243761520_386639009",
      "dateCreated": "2021-12-11T12:29:21-0500",
      "dateStarted": "2021-12-11T23:14:11-0500",
      "dateFinished": "2021-12-11T23:14:11-0500",
      "status": "FINISHED",
      "$$hashKey": "object:313"
    },
    {
      "text": "%spark.pyspark\nimport pandas as pd\nfor i in reference_data_agency_name:\n    print(i)\n\ndf = pd.DataFrame(reference_data_agency_name)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:14:11-0500",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\nDEPARTMENT OF YOUTH AND COMMUNITY DEVELOPMENT\nCITY UNIVERSITY CONSTRUCTION FUND\nOFFICE OF COLLECTIVE BARGAININ\nSANITATION\nMISCELLANEOUS\nDISTRICT ATTORNEY RICHMOND COUNTY\nGOVERNOR'S OFFICE\nBRONX DA\nPUBLIC ADMINISTRATOR-BRONX COUNTY\nBROOKLYN COMMUNITY BOARD #13\nHUMAN RIGHTS, COMMISSION ON\nDEPARTMENT OF SMALL BUSINESS SERVICES\nBOARD OF ELECTIONS\nMAYOR, OFFICE OF THE\nEDUCATION RETIREMENT SYSTEM, BOARD OF\nOFFICE OF MANAGEMENT & BUDGET\nHOUSING PRESERVATION & DEVELOPMENT\nQUEENS COMMUNITY BOARD #5\nBUILDINGS\nDEPT OF HEALTH/MENTAL HYGIENE\nDEPARTMENT OF ENVIRONMENTAL\nCOMMUNITY BOARDS\n600\nINSPECTOR GENERAL, OFFICE OF THE NYS\nDISTRICT ATTORNEY KINGS COUNTY\nBOROUGH PRESIDENT-BRONX\nQUEENS COMMUNITY BOARD #14\nBRONX COMMUNITY BOARD #8\nEQUAL EMPLOY PRACTICES COMM\nBOROUGH PRESIDENT-RICHMOND\nADMIN FOR CHILDREN'S SVCS\nCUNY KINGSBOROUGH COMMUNITY\nTRIBOROUGH BRIDGE AND TUNNEL AUTHORITY\nMANHATTAN COMMUNITY BOARD #10\nDEPT OF ED PARA PROFESSIONALS\nDEPARTMENT OF EDUCATION (NON-PEDAGOGICAL)\nGROWNYC\nBOROUGH PRESIDENT - MANHATTAN\nSTATE UNIVERSITY CONSTRUCTION FUND\nNEW YORK STATE SURROGATE'S COURT - RICHMOND COUNTY\nCUNY QUEENSBOROUGH COMMUNITY\nCOMMUNITY COLLEGE (BRONX)\nHUNTER COLLEGE HIGH SCHOOL\nCITY PLANNING\nDEPARTMENT OF INFORMATION TECHNOLOGY AND TELECOMMUNICATIONS\nDEPARTMENT OF YOUTH & COMMUNITY DEV\nBROOKLYN COMMUNITY BOARD #16\nNYC FIRE PENSION FUND\nOFFICE OF PROSECUTION SPEC NARCO\nDEPARTMENT OF EDUCATION - SCHOOL CONSTRUCTION AUTHORITY\nMAYORS OFFICE OF CONTRACT SERVICES\nBOARD OF ELECTION\nDEPARTMENT OF RECORDS & INFORMATION SVS\nBROOKLYN COMMUNITY BOARD #4\nOFFICE OF ADMINISTRATIVE T\nHOUSING PRESERVATION & DVLPMNT\nDEPARTMENT OF EMERGENCY MANAGEMENT\nFINANCIAL INFO SVCS AGENCY\nNYC HEALTH AND HOSPITALS CORPORATION\nQUEENS COMMUNITY BOARD #10\nCIVILIAN COMPLAINT REVIEW BD\nEMPIRE STATE DEVELOPMENT\nDEPARTMENT OF SANITATION\nDEPARTMENT OF YOUTH AND COMUNITY SERVICES\nLABOR RELATIONS, OFFICE OF\nOFFICE OF EMERGENCY MANAGEMENT\nBRONX COMMUNITY BOARD #6\nQUEENS COMMUNITY BOARD #4\nCOMMUNITY COLLEGE (LAGUARDIA)\nVETERANS' SERVICES, DEPARTMENT OF\nINFORMATION TECHNOLOGY AND TELECOMMUNICATIONS\nBROOKLYN BRIDGE PARK CORPORATION\nDEPARTMENT OF VETERANS' SERVICES\nAGRICULTURE & MARKETS, DEPARTMENT OF\nMANHATTAN COMMUNITY BOARD #4\nCOMMUNITY BOARD NO.4 BRONX\nMANHATTAN COMMUNITY BOARD #11\nDEPUTY CHIEF ADMINISTRATIVE JUDGE FOR THE NEW YORK CITY COURTS\nBRONX COMMUNITY BOARD #11\nBOROUGH PRESIDENT - BROOKLYN\nMETROPOLITAN TRANSPORTATION AUTHORITY, INSPECTOR GENERAL, OFFICE OF THE\nPUBLIC ADMINISTRATOR-QUEENS\nDISTRICT ATTORNEY BRONX COUNTY\nDEPARTMENT OF ENVIRONMENTAL PROTECT.\nFINANCIAL SERVICES, DEPARTMENT OF\nSTATEN ISLAND COMMUNITY BOARD #2\nNYC POLICE PENSION FUND\nNYS UNIFIED COURT SYSTEM OFFICE OF COURT ADMINISTRATION\nCOMMUNITY COLLEGE (KINGSBORO)\nSPEC NARCS-DA\nQUEENS COMMUNITY BOARD #1\nCUNY CENTRAL OFFICE\nCITY CLERK\nCONTRACT SERVICES, MAYOR'S OFFICE OF\nENVIRONMENTAL CONSERVATION, DEPARTMENT OF\nCOLLECTIVE BARGAINING, OFFICE OF\nBROOKLYN COMMUNITY BOARD #12\nMEDIA ENTERTAINMENT, MAYOR'S OFFICE OF\nVICTIM SERVICES, OFFICE OF\nDISTRICT ATTORNEY-SPECIAL NARC\nHUMAN RIGHTS COMMISSION\nU.S. DISTRICT COURT - SOUTHERN DISTRICT OF NEW YORK\nEMERGENCY MANAGEMENT, NYC\nHIGHER EDUCATION SERVICES CORPORATION, NYS\nBOROUGH PRESIDENT-MANHATTAN\nDEPT. OF HOMELESS SERVICES\nHRA/DEPT OF SOCIAL SERVICES\nCRIMINAL JUSTICE SERVICES, DIVISION OF\nBROOKLYN COMMUNITY BOARD #18\nQUEENS BOROUGH PUBLIC LIBRARY\nCITYWIDE ADMINISTRATIVE SERVICES\nMANHATTAN COMMUNITY BOARD #8\nCUNY LAGUARDIA COMMUNITY C\nLEGISLATURE OF THE STATE OF NY\nBROOKLYN COMMUNITY BOARD #17\nCONFLICTS OF INTEREST BOAR\nRECORDS & INFORMATION SERVICES\nQUEENS COMMUNITY BOARD #6\nNEW YORK STATE SUPREME COURT - TWELFTH JUDICIAL DISTRICT (BRONX COUNTY)\nGENERAL SERVICES, OFFICE OF\nBRONX COMMUNITY BOARD #10\nSTATEN ISLAND COMMUNITY BOARD #3\nDEPARTMENT OF HEALTH AND MENTAL HYGIENE\nAGENCY NAME\nOFFICE OF THE MAYOR\nDEPARTMENT OF HOMELESS SERVICES\nBROOKLYN COMMUNITY BOARD #3\n758\nDEPARTMENT OF CITYWIDE ADMIN SERVICE\nBROOKLYN COMMUNITY BOARD #2\nMAYOR'S OFFICE OF CONTRACT\nENERGY ADJUSTMENT\nDISTRICT ATTORNEY-NEW YORK COUNTY\nHUMAN RESOURCES ADMINISTRATION/DEPARTMENT OF SOCIAL SERVICES\nEDUCATION DEPARTMENT, NYS\nFINANCIAL INFORMATION SERVICES AGENCY\nHOMELAND SECURITY & EMERGENCY SERVICES, DIVISION OF\nCOMPTROLLER, STATE, OFFICE OF THE\nJUDICIAL CONFERENCE OF THE UNITED STATES\nECONOMIC DEVELOPMENT CORPORATION, NYC\nCUNY MANHATTAN COMMUNITY C\nTEACHERS RETIREMENT SYSTEM\nMAYORALTY\nNEW YORK STATE SUPREME COURT APPELLATE DIVISION - SECOND DEPARTMENT (INCLUDES KINGS, QUEENS AND RICHMOND COUNTIES )\nHEALTH + HOSPITALS NYC, (NYC H+H)\nPENSION CONTRIBUTIONS\nPUBLIC ADMINISTRATOR KINGS\nHEALTH AND HOSPITALS CORP\nOFFICE OF ADMINISTRATIVE TAX APPEALS\nAGING\nDEPT. OF DESIGN & CONSTRUCTION\nQUEENS PUBLIC LIBRARY\nPERSONNEL MONITORS\n311\nWATERFRONT COMMISSION OF NY HARBOR\nCOMMUNITY COLLEGE (MANHATTAN)\nEDUCATIONAL CONSTRUCTION FUND\nJOINT COMMISSION ON PUBLIC ETHICS, NYS\nLEGISLATIVE BILL DRAFTING COMMISSION\nN.Y.C. TRANSIT AUTHORITY\nMANHATTAN COMMUNITY BOARD #12\nCHILDREN'S SERVICES, ADMINISTRATION FOR\nEMPLOYEE RELATIONS, GOVERNOR'S OFFICE OF\nSTATEN ISLAND COMMUNITY BD #3\nTEACHERS' RETIREMENT SYSTEM\nOFFICE OF MANAGEMENT AND BUDGET\nMANHATTAN COMMUNITY BOARD #1\nMETROPOLITAN TRANSPORTATION AUTHORITY (MTA)\nNEW YORK PUBLIC LIBRARY - RESEARCH\nDEPARTMENT OF BUSINESS SERVICES\nPUBLIC ADMINISTRATOR QUEEN\nOPEN COMPETITIVE\nNEW YORK STATE COURT OF APPEALS\nTAX APPEALS, OFFICE OF ADMINISTRATIVE\nPROBATION\nRICHMOND COMMUNITY BOARD #2\nBUSINESS INTEGRITY COMMISSION\nTHRUWAY AUTHORITY, NYS\nRICHMOND COMMUNITY BOARD #1\nNEW YORK CITY POLICE DEPARTMENT\nBATTERY PARK CITY AUTHORITY\nNEW YORK CITY COURTS\nFIRE DEPARTMENT OF NEW YORK\nTAXI & LIMOUSINE COMMISSION\nPUBLIC ADMINISTRATOR-BRONX\nDEPT OF CITYWIDE ADMIN SVCS\nDORMITORY AUTHORITY STATE OF NY\nDEPARTMENT OF DESIGN & CONSTRUCTION\nGOVERNORS ISLAND, TRUST FOR\nDEPARTMENT OF RECORDS & INFORMATION SERVICES\nBRONX COMMUNITY BOARD #7\nPUBLIC ADMINISTRATOR-RICHMOND COUNTY\nPARKS, RECREATION & HISTORIC PRESERVATION, OFFICE OF\nMAYOR'S OFFICE OF FILM, THEATRE AND BROADCASTING\nDEPARTMENT OF INFO TECH & TELECOMM\nDISTRICT ATTORNEY\nRENT GUIDELINES BOARD\nBOARD OF ELECTION POLL WORKERS\nCITYWIDE SAVINGS INITIATIVES\nDISTRICT ATTORNEY-KINGS COUNTY\nELECTIONS, BOARD OF\nNEW YORK CITY FIRE PENSION\nSTATEN ISLAND COMMUNITY BD #2\nU.S. COURT OF INTERNATIONAL TRADE\nBRONX COMMUNITY BOARD #2\nDOE CUSTODIAL PAYROL\nDISTRICT ATTORNEY QUEENS COUNTY\nCITY COUNCIL\nGUTTMAN COMMUNITY COLLEGE\nNEW YORK METROPOLITAN TRANSPORTATION COUNCIL\nSTATEN ISLAND COMMUNITY BOARD #1\nADDICTION SERVICES & SUPPORTS, OFFICE OF\nNEW YORK STATE SUPREME COURT LIBRARIES (NEW YORK CITY)\nOFFICE OF ADMINISTRATIVE TRIALS AND HEARINGS\nOFFICE OF LABOR RELATIONS\nDISTRICT ATTORNEY-NEW YORK\nSUPREME COURT OF THE UNITED STATES\nDEPARTMENT OF EMPLOYMENT\nBOROUGH PRESIDENT-MANHATTA\nADMINISTRATION FOR CHILDREN'S SERVICES\nLAW EXAMINERS, NYS BOARD OF\nHOUSING DEVELOPMENT CORPORATION, NYC\nBROOKLYN COMMUNITY BOARD #14\nTAXI AND LIMOUSINE COMMISSION\nCIVIL SERVICE COMMISSION\nDEPT OF CONSUMER & WORKER PROTECTION\nEQUAL EMPLOYMENT PRACTICES COMMISSION\nCOMMUNITY COLLEGE (QUEENSBORO)\nOFFICE OF THE ACTUARY\nAGING, NYS OFFICE FOR THE\nDEPARTMENT OF ENVIRONMENTAL PROTECTION\nADMINISTRATION FOR CHILDREN'S SERVIVES\nDISTRICT ATTORNEY-BRONX COUNTY\nACTUARY, OFFICE OF\nCONSUMER AFFAIRS\n1\nPUBLIC EMPLOYMENT RELATIONS BOARD\nSTATE POLICE, DIVISION OF\nDEPARTMENT OF VETERANS' SE\nDEPARTMENT OF CITY PLANNING\nDEPARTMENT OF CONSUMER AFFAIRS\nNYC EMPLOYEES' RETIREMENT\nSTANDARDS AND APPEALS, BOARD OF\nHEALTH, DEPARTMENT OF\nINVESTIGATION\nPUBLIC ADMINISTRATOR-NEW YORK COUNTY\nBROOKLYN COMMUNITY BOARD #5\nCUNY HUNTER COLLEGE HIGH SCHOOL\nBOROUGH HISTORICAL SOCIETIES\nPRESIDENT BOROUGH OF MANHATTAN\nCITY UNIVERSITY OF NEW YORK\nDEPT OF ED PEDAGOGICAL\nPUBLIC ADMINISTRATOR-KINGS\nNEW YORK CITY FIRE PENSION FUND\nCITY UNIVERSITY OF NEW YORK - BOARD OF TRUSTEES\nPUBLIC ADMINISTRATOR-NEW YORK\nU.S. DISTRICT COURT - EASTERN DISTRICT OF NEW YORK\nDEPARTMENT OF FINANCE\nDEPARTMENT OF BUSINESS SERV.\nBROOKLYN COMMUNITY BOARD #9\nMENTAL HEALTH, OFFICE OF\nCOUNTY CLERK\nENVIRONMENTAL COMMISSION, INTERSTATE\nSTATEN ISLAND COMMUNITY BD #1\nTEACHERS' RETIREMENT SYSTEM, NYS\nCOMMISSION ON HUMAN RIGHTS\nDEBT SERVICE\nLAW DEPARTMENT\nBOROUGH PRESIDENT - QUEENS\nDEPT OF INFO TECH & TELECOMM\nDEPARTMENT OF BUILDINGS\nDEPARTMENT OF DESIGN AND C\nDEPT OF ENVIRONMENT PROTECTION\nDISTRICT ATTORNEY RICHMOND COU\nFINANCIAL CONTROL BOARD, NYS\nMANHATTAN COMMUNITY BOARD #7\nPUBLIC ADMINISTRATOR NEW YORK COUNTY\nDESIGN AND CONSTRUCTION\nMUNICIPAL WATER FINANCE AU\nMANHATTAN COMMUNITY BOARD #2\nDEPARTMENT OF INFORMATION\nDEPARTMENT OF CITYWIDE ADMINISTRATIVE SERVICES\nBOROUGH PRESIDENT - BRONX\nDEPARTMENT OF HEALTH AND M\nLANDMARKS PRESERVATION COMM.\nQUEENS COMMUNITY BOARD #13\nTRANSITIONAL FINANCE AUTHORITY, NYC\nINDEPENDENT BUDGET OFFICE\nDEPT OF ED HRLY SUPPORT STAFF\nQUALIFIED INCUMBENT\nCORRECTION, COMMISSION OF\nGAMING COMMISSION, NYS\nTAX APPEALS TRIBUNAL, NYS\nQUEENS COMMUNITY BOARD #11\nBUDGET, DIVISION OF THE\nNEW YORK CITY HOUSING AUTHORITY\nHEALTH + HOSPITALS / BOARD OF DIRECTORS, NYC\nKINGS DA\nQUEENS COMMUNITY BOARD #7\nBRONX COMMUNITY BOARD #4\nNEW YORK STATE SURROGATE'S COURT - NEW YORK COUNTY\nLIST AGENCY DESC\nCAMPAIGN FINANCE BOARD\nMILITARY & NAVAL AFFAIRS, NYS DIVISION OF\nBOROUGH PRESIDENT-STATEN IS\nRICHMOND COMMUNITY BOARD #3\nNEW YORK RESEARCH LIBRARIES\nLOWER MANHATTAN DEVELOPMENT CORPORATION\nPOLICE CORRUPTION, COMMISSION TO COMBAT\nFINANCIAL INFORMATION SERVICE AGENCY\nNEW YORK STATE SURROGATE'S COURT - QUEENS COUNTY\nPUBLIC ADMINISTRATOR\nOFFICE OF ADMINISTRATIVE TRIALS AND HEARINGS (OATH)\nNEW YORK STATE SUPREME COURT - ELEVENTH JUDICIAL DISTRICT (QUEENS COUNTY)\nBROOKLYN NAVY YARD DEVELOPMENT CORPORATION\nCYBER COMMAND, NYC\nCIVILIAN COMPLAINT REVIEW BOARD\nPUBLIC ADVOCATE\nDEPARTMENT OF CULTURAL AFFAIRS\nCIVIL SERVICE COMMISSION, CITY\nTRIBOROUGH BRIDGE AND TUNNEL\nCUNY HOSTOS COMMUNITY COLL\nDISTRICT ATTORNEY QNS COUNTY\nOFFICE OF ADMINISTRATION TRIALS & HEARINGS\nATTORNEY GENERAL, OFFICE OF\nDISTRICT ATTORNEY-MANHATTAN\nSTATE, DEPARTMENT OF\nNEW YORK STATE SUPREME COURT - THIRTEENTH JUDICIAL DISTRICT (RICHMOND COUNTY)\nCUNY COLLEGE OF STATEN ISLAND\nDEPARTMENT OF PROBATION\nMAYOR'S OFFICE OF CONTRACT SERVICES\nMANHATTAN COMMUNITY BOARD #9\nBRONX COMMUNITY BOARD #12\nBOROUGH PRESIDENT - STATEN ISLAND\nBOROUGH PRESIDENT-BROOKLYN\nMEDICAL EXAMINER, OFFICE OF CHIEF, INSTITUTE OF FORENSIC SCIENCES\nHOUSING AUTHORITY, NYC\nOFF OF PAYROLL ADMINISTRATION\nDISTRICT ATTORNEY-RICHMOND COUNTY\nDEPARTMENT OF SOCIAL SERVICES\nDEPARTMENT OF RECORDS AND INFORMATION SERVICES\nMANHATTAN COMMUNITY BOARD #5\nCUNY MEDGAR EVERS COLLEGE\nBROOKLYN COMMUNITY BOARD #11\nHOMELESS SERVICES\nOFFICE OF COLLECTIVE BARGAINING\nTRANSPORTATION, DEPARTMENT OF\nRICHMOND DA\nDEPT OF RECORDS & INFO SERVICE\nCITY CLERK & CLERK OF THE COUNCIL\nNYC DEPT OF VETERANS' SERVICES\nADMIN FOR CHILDREN'S SERVICES\nLANDMARKS PRESERVATION COMM\nSTATE UNIVERSITY OF NEW YORK, (SUNY)\nBRONX COMMUNITY BOARD #5\nSCHOOL CONSTRUCTION AUTHORITY, NYC\nDEPARTMENT FOR THE AGING\nLIQUIDATION BUREAU, NEW YORK\nROOSEVELT ISLAND OPERATING CORP. OF THE STATE OF NY\nMUNICIPAL CREDIT UNION\nNYC HOUSING AUTHORITY\nDEPARTMENT OF EDUCATION ADMIN\nLAW DEPARTMENT, OFFICE OF THE CORPORATION COUNSEL\nNYC & COMPANY\nMAYOR'S OFFICE TO COMBAT DOMESTIC VIOLENCE\nQUEENS COMMUNITY BOARD #12\nDEPARTMENT OF CORRECTION\nFINANCIAL INFORMATION SERVIVES\nBROOKLYN COMMUNITY BOARD #8\nBOROUGH PRESIDENT BRONX\nU.S. COURT OF APPEALS FOR THE 2ND CIRCUIT\nBROOKLYN COMMUNITY BOARD #15\nTAXATION & FINANCE, NYS DEPARTMENT OF\nPOLICE PENSION FUND\nADMINISTRATIVE TRIALS AND HEARINGS, OFFICE OF\nPARKS, NYC\nNYC EMPLOYEES RETIREMENT SYS\nPUBLIC ADMINISTRATOR BRONX\nHUMAN RESOURCES ADMINISTRATION\nHEALTH & MENTAL HYGIENE, DEPARTMENT OF\nU.S. COURT OF APPEALS FOR THE FEDERAL CIRCUIT\nQUEENS DA\nMANHATTAN DA\nQUEENS COMMUNITY BOARD #8\nDEPT OF ED PER SESSION TEACHER\nDISTRICT ATTORNEY-QUEENS COUNTY\nCUNY BRONX COMMUNITY COLLEGE\nCORRECTION, DEPARTMENT OF\nNEW YORK STATE SUPREME COURT APPELLATE DIVISION - FIRST DEPARTMENT (NEW YORK AND BRONX COUNTY)\nDEPARTMENT OF MENTAL HEALTH\nBRONX COMMUNITY BOARD #3\nNYC EMPLOYEES' RETIREMENT SYSTEM\nOFFICE OF THE COMPTROLLER\nDEPARTMENT OF INVESTIGATIO\nHRA/DEPARTMENT OF SOCIAL SERVICES\nENVIRONMENTAL PROTECTION\nHUMAN RESOURCES ADMINISTRATION (HRA) DEPARTMENT OF SOCIAL SERVICES (DSS)\nINVESTIGATION FOR THE NYC SCHOOL DISTRICT, SPECIAL COMMISSIONER OF\nEQUAL EMPLOYMENT PRACTICES\nCOMMUNITY COLLEGE (HOSTOS)\nPUBLIC ADMINISTRATOR-KINGS COUNTY\nDEPARTMENT OF PARKS AND RECREATION\nHOMES & COMMUNITY RENEWAL, NYS\nLANDMARKS PRESERVATION COMMISSION\nOFFICE OF SPECIAL NARCOTICS\nHUMAN RIGHTS, NYS DIVISION OF\nLEASE ADJUSTMENT\nFAMILY COURT OF THE STATE OF NEW YORK - CITY OF NEW YORK\nOFFICE OF COLLECTIVE BARGA\nPAYROLL ADMINISTRATION, OFFICE OF\nPUBLIC ADMINISTRATOR-RICHMOND\nJUSTICE CENTER FOR THE PROTECTION OF PEOPLE WITH SPECIAL NEEDS, NYS\nCITY PLANNING COMMISSION\nMANAGEMENT & BUDGET, OFFICE OF\nJUDICIAL CONDUCT, NYS COMMISSION ON\nUNITED NATIONS DEVELOPMENT CORPORATION\nNYC TAXI AND LIMOUSINE COMM\nVETERANS' SERVICES, NYS DIVISION OF\nLANDMARKS PRESERVATION COMMISSON\nN.Y.C. HOUSING AUTHORITY\nNEW YORK PUBLIC LIBRARY\nBROOKLYN PUBLIC LIBRARY\nQUEENS COMMUNITY BOARD #9\nBROOKLYN COMMUNITY BOARD #10\nEDUCATION\nBOROUGH PRESIDENT STATEN ISLAND\nELECTIONS, BOARD OF, NYS\nBOROUGH PRESIDENT-QUEENS\nFIRE MUSEUM, NYC\nQUEENS COMMUNITY BOARD #3\nJAVITS CENTER/NY CONVENTION CENTER OPERATING CORPORATION\nCONFLICTS OF INTEREST BOARD\nDEPT OF ED PER DIEM TEACHERS\nDEPT. OF RECORDS AND INFORMATION SERVICES\nLABOR, DEPARTMENT OF\nCIVIL SERVICE, DEPARTMENT OF\nDEPARTMENT OF INFORMATION TECHNOLOGY & TELECOMMUNICATIONS\nNYS COURT OF CLAIMS\nBOARD OF CORRECTIONS\nTAX COMMISSION\nDEPARTMENT OF JUVENILE JUSTICE\nYOUTH AND COMMUNITY DEVELOPMENT\nBROOKLYN COMMUNITY BOARD #6\nMAYORS OFFICE OF CONTRACT SVCS\nCORRECTIONS & COMMUNITY SUPERVISION, DEPARTMENT OF\n42\nPOLICE DEPARTMENT\nOFFICE OF PAYROLL ADMINISTRATION\nTEMPORARY & DISABILITY ASSISTANCE OFFICE OF\nGOVERNOR, LIEUTENANT\nALCOHOLIC BEVERAGE CONTROL, DIVISION OF (STATE LIQUOR AUTHORITY)\nDEPARTMENT OF DESIGN AND CONSTRUCTION\nDISTRICTING COMMISSION\nQUEENS COMMUNITY BOARD #2\nBOARD OF CORRECTION\nCORRECTION, BOARD OF\nDISTRICT ATTORNEY - SPECIAL AGENT\nPOWER AUTHORITY, NEW YORK\nBOROUGH HISTORIANS\nMANHATTAN COMMUNITY BOARD #6\nFINANCE\nTRANSPORTATION\nCOMPTROLLER\nINDEPENDENT BUDGET OFFICE, NYC\nBRONX COMMUNITY BOARD #9\nDEPARTMENT OF INVESTIGATION\nNEW YORK STATE SURROGATE'S COURT - BRONX COUNTY\nNEW YORK STATE SUPREME COURT - FIRST JUDICIAL DISTRICT (NEW YORK COUNTY)\nBRONX DISTRICT ATTORNEY\nDEPARTMENT OF HOUSING PRESERVATION AND DEVELOPMENT\nDEPARTMENT OF EDUCATION\nDEPARTMENT OF YOUTH & COMMUNITY DEVELOPMENT\nDISTRICT ATTORNEY NEW YORK COUNTY\nMOTOR VEHICLES, DEPARTMENT OF\nPUBLIC SERVICE CORPS\nFIRE DEPARTMENT\nWATER FINANCE AUTHORITY, NYC MUNICIPAL\nPUBLIC ADVOCATE FOR THE CITY OF NEW YORK\nARTS, COUNCIL ON THE\nOFFICE OF ADMIN TRIALS & HEARINGS\nBROOKLYN COMMUNITY BOARD #7\nPUBLIC ADMINISTRATOR NEW YORK CITY\nADMIN TRIALS AND HEARINGS\nBRONX COMMUNITY BOARD #1\nEMPLOYEES RETIREMENT SYSTEM BOARD OF TRUSTEES, NYC\nHOUSING PRESERVATION AND DEVELOPMENT\nMANHATTAN COMMUNITY BOARD #3\nNEW YORK STATE SURROGATE'S COURT - KINGS COUNTY\nCULTURAL AFFAIRS\nDISTRICT ATTORNEY - SPECIAL NARCOTICS\nDEPARTMENT OF TRANSPORTATION\nDEPT OF YOUTH & COMM DEV SRVS\nPUBLIC ADMINISTRATOR- QUEENS COUNTY\nBROOKLYN COMMUNITY BOARD #1\nMUNICIPAL WATER FIN AUTHORITY\nCHILDREN & FAMILY SERVICES, NYS OFFICE OF\nUNIFORM STATE LAWS, COMMISSION ON\nDEPARTMENT OF PARKS & RECREATION\nNEW YORK STATE SUPREME COURT - SECOND JUDICIAL DISTRICT (KINGS COUNTY)\nPORT AUTHORITY OF NEW YORK & NEW JERSEY\nPUBLIC ADMINISTRATOR RICHM\nSMALL BUSINESS SERVICES\nDEPT OF PARKS & RECREATION\nDISABILITIES, OFFICE FOR PEOPLE WITH DEVELOPMENTAL\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639244079556_486963694",
      "id": "paragraph_1639244079556_486963694",
      "dateCreated": "2021-12-11T12:34:39-0500",
      "dateStarted": "2021-12-11T23:14:11-0500",
      "dateFinished": "2021-12-11T23:14:11-0500",
      "status": "FINISHED",
      "$$hashKey": "object:314"
    },
    {
      "text": "%spark.pyspark\nprint(df)",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T23:14:13-0500",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "                                                     0\n0                                                     \n1        DEPARTMENT OF YOUTH AND COMMUNITY DEVELOPMENT\n2                    CITY UNIVERSITY CONSTRUCTION FUND\n3                       OFFICE OF COLLECTIVE BARGAININ\n4                                           SANITATION\n..                                                 ...\n500            PORT AUTHORITY OF NEW YORK & NEW JERSEY\n501                         PUBLIC ADMINISTRATOR RICHM\n502                            SMALL BUSINESS SERVICES\n503                         DEPT OF PARKS & RECREATION\n504  DISABILITIES, OFFICE FOR PEOPLE WITH DEVELOPME...\n\n[505 rows x 1 columns]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639249325254_263323128",
      "id": "paragraph_1639249325254_263323128",
      "dateCreated": "2021-12-11T14:02:05-0500",
      "dateStarted": "2021-12-11T23:14:13-0500",
      "dateFinished": "2021-12-11T23:14:13-0500",
      "status": "FINISHED",
      "$$hashKey": "object:315"
    },
    {
      "text": "%spark.pyspark",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T22:56:59-0500",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "0\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639244230142_1277365152",
      "id": "paragraph_1639244230142_1277365152",
      "dateCreated": "2021-12-11T12:37:10-0500",
      "dateStarted": "2021-12-11T22:56:53-0500",
      "dateFinished": "2021-12-11T22:56:53-0500",
      "status": "FINISHED",
      "$$hashKey": "object:316"
    },
    {
      "text": "%spark.pyspark\n",
      "user": "nbuser",
      "dateUpdated": "2021-12-11T22:52:31-0500",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1639281151135_935197456",
      "id": "paragraph_1639281151135_935197456",
      "dateCreated": "2021-12-11T22:52:31-0500",
      "status": "READY",
      "$$hashKey": "object:317"
    }
  ],
  "name": "test",
  "id": "2GQZETURR",
  "defaultInterpreterGroup": "spark",
  "version": "0.9.0",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false,
    "looknfeel": "default",
    "personalizedMode": "false"
  },
  "info": {
    "isRunning": false
  },
  "path": "/test"
}